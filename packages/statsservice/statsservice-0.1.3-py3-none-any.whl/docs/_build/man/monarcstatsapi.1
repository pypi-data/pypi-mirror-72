.\" Man page generated from reStructuredText.
.
.TH "MONARCSTATSAPI" "1" "Apr 28, 2020" "" "MONARC Stats API"
.SH NAME
monarcstatsapi \- MONARC Stats API 0.1.0
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH API V1
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
# Get all organizations
$ curl http://127.0.0.1:5000/organization/
{"data": [], "has_more": false}

# Create an organization (let\(aqs say with only a token for the moment \- same token for the MONARC client/organization):
$ curl \-H "Content\-Type: application/json" \-X POST \-d \e
\(aq{"token": "UhdSAdTIoBT18r9Fa3W26iN9RRGlknkO62YkWY\-yyqn3c_6\-hEfIDX0DkF8JvupxfEw"}\(aq http://127.0.0.1:5000/api/v1/organization/

# List again the organizations:
$ curl http://127.0.0.1:5000/api/v1/organization/
# Result:
{"data": [{"token": "UhdSAdTIoBT18r9Fa3W26iN9RRGlknkO62YkWY\-yyqn3c_6\-hEfIDX0DkF8JvupxfEw", "id": "5ea3717b0cdd5b63ad17b6ce"}], "has_more": false}

# Get all stats
$ curl \-H "AUTHORIZATION: basic <TOKEN>" http://127.0.0.1:5000/api/v1/stats/
{"data": [], "has_more": false}

# Create a stat
# data is a DynamicField
# note that we are using the MongoDB id of the created org:
$ curl \-H "AUTHORIZATION: basic <TOKEN>" \-H "Content\-Type: application/json" \-X POST \-d \e
\(aq{"type": "risk", "organization": "5ea3717b0cdd5b63ad17b6ce", "data": {"what": "you want", "super": "cool"}, "day":1, "week":1, "month":1}\(aq http://127.0.0.1:5000/api/v1/stats/
# Result:
{"organization": "5ea3717b0cdd5b63ad17b6ce", "type": "risk", "day": 1, "week": 1, "month": 1, "data": {"what": "you want", "super": "cool"}, "created_at": "2020\-04\-24T23:38:26.326000", "updated_at": "2020\-04\-24T23:38:26.326000", "id": "5ea378728f826c539837436a"}


# Get the last stat with the id returned previously:
$ curl \-H "AUTHORIZATION: basic <TOKEN>" http://127.0.0.1:5000/api/v1/stats/5ea378728f826c539837436a/
# Result:
{"organization": "5ea3717b0cdd5b63ad17b6ce", "type": "risk", "day": 1, "week": 1, "month": 1, "data": {"what": "you want", "super": "cool"}, "created_at": "2020\-04\-24T23:38:26.326000", "updated_at": "2020\-04\-24T23:38:26.326000", "id": "5ea378728f826c539837436a"}

# Get stats for a specific organization:
$ curl \-H "AUTHORIZATION: basic UhdSAdTIoBT18r9Fa3W26iN9RRGlknkO62YkWY\-yyqn3c_6\-hEfIDX0DkF8JvupxfEw"  http://127.0.0.1:5000/api/v1/stats/?organization__exact=5ea3717b0cdd5b63ad17b6ce

# You can also use pagination:
$ curl http://127.0.0.1:5000/api/v1/stats/?_skip=0&_limit=10
.ft P
.fi
.UNINDENT
.UNINDENT
.SH COMMAND LINE INTERFACE
.SS Pushing data
.sp
Pushing data to another stats server.
.INDENT 0.0
.IP \(bu 2
genindex
.IP \(bu 2
modindex
.IP \(bu 2
search
.UNINDENT
.SH AUTHOR
Cédric Bonhomme <cedric@cedricbonhomme.org>
.SH COPYRIGHT
2020, Cédric Bonhomme <cedric@cedricbonhomme.org>
.\" Generated by docutils manpage writer.
.
