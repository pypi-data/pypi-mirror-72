{% extends 'material/frontend/views/detail.html' %}
{% load i18n material_frontend humanize corgy.commons %}

{% block breadcrumbs_items %}
<a href="{% url object.employee.employer|frontend_urlname:'detail' object.employee.employer.pk %}">{{ object.employee.employer }}</a>
<a href="{% url object.employee|frontend_urlname:'list' %}">{{ object.employee|verbose_name_plural|title }}</a>
<a href="{% url object.employee|frontend_urlname:'detail' object.employee.pk %}">{{ object.employee }}</a>
<a href="{% url object|frontend_urlname:'list' %}">{{ salary|verbose_name_plural|title }}</a>
<a href="{% url object|frontend_urlname:'detail' object.pk %}">{{ object.period_year }}</a>
<a class="active">{{ object.period_month }}</a>
{% endblock %}

{% block content %}
<div class="left-panel">
    <div class="card">
        <div class="card-content">
            {% block card %}
            <div class="form-title">{{ view.model|verbose_name|title }}: {{ object }}</div>
            <table class="table bordered">
                {% for field_name, value in object_data %}
                <tr>
                    <th>{{ field_name }}</th>
                    <td>{{ value }}</td>
                    {% endfor %}
                </tr>
                {% endblock %}
            </table>
        </div>
        <div class="card-action">
            <div class="right-align">
                <a href="#" class="btn">{% trans 'Bérjegyzék' %}</a>
                {% if delete_url %}<a class="waves-effect waves-light btn red white-text" href="{{ delete_url }}">{% trans 'Delete' %}</a>{% endif %}
                {% if change_url %}<a class="waves-effect waves-light btn white-text" href="{{ change_url }}">{% trans 'Change' %}</a>{% endif %}
            </div>
        </div>
    </div>

    {% if object.timesheet.items.count > 0 %}
    <div class="card">
        <div class="card-content">
            <div class="card-title">{% trans 'Jelenlét' %}</div>

            <table class="table bordered">
                <tr>
                    <th>{% trans 'Dátum' %}</th>
                    <th>{% trans 'Óraszám' %}</th>
                    <th>{% trans 'Állapot' %}</th>
                </tr>
                {% for item in object.timesheet.items.all %}
                <tr>
                    <td>{{ item.timestamp }}</td>
                    <td>{{ item.duration }}</td>
                    <td>{{ item.category }}</td>
                </tr>
                {% endfor %}
            </table>

            <div class="card-action">
                <ul class="right-align">
                    {% for stat in object.timesheet.statistics.all %}
                    <li>{{ stat.category }}: {{ stat.value }}</li>
                    {% endfor %}
                </ul>
            </div>

        </div>
    </div>
    {% endif %}

    <div class="card">
        <div class="card-content">
            <div class="card-title">{% trans 'Jövedelem' %}</div>
        </div>
    </div>
    <div class="card">
        <div class="card-content">
            <div class="card-title">{% trans 'Béren kívüli juttatások' %}</div>
        </div>
    </div>
    <div class="card">
        <div class="card-content">
            <div class="card-title">{% trans 'Levont járulékok' %}</div>
        </div>
    </div>
    <div class="card">
        <div class="card-content">
            <div class="card-title">{% trans 'Munkáltató járulékai' %}</div>
        </div>
    </div>
    <div class="card">
        <div class="card-content">
            <div class="card-title">{% trans 'Személyi jövedelemadó' %}</div>
        </div>
    </div>
    <div class="card">
        <div class="card-content">
            <div class="card-title">{% trans 'Külön adózó jövedelem' %}</div>
        </div>
    </div>

    {% if object.blocked.count > 0 %}
    <div class="card">
        <div class="card-content">
            <div class="card-title">{% trans 'Letiltás' %}</div>

            <table class="table bordered">
                <tr>
                    <th>{% trans 'Összeg' %}</th>
                    <th>{% trans 'Százalék' %}</th>
                    <th>{% trans 'Kedvezményezett' %}</th>
                    <th>{% trans 'Bankszámlaszám' %}</th>
                </tr>
                {% for item in object.blocked.all %}
                <tr>
                    <td>{{ item.summary }}</td>
                    <td>{{ item.in_percent|percentage }}</td>
                    <td>{{ item.account.beneficiary }}</td>
                    <td>{{ item.account.account_number }}</td>
                </tr>
                {% endfor %}
            </table>

            <div class="card-action">
                <div class="right-align">
                    <b>{% trans 'Összes levonás' %}: {{ object.subtraction|intcomma }}</b>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

<!--    <div class="card">-->
<!--        <div class="card-content">-->
<!--            <div class="card-title">graf</div>-->
<!--            <canvas id="salaryChart" ></canvas>-->

<!--            <script type="text/javascript">-->
<!--              new Chart($("#salaryChart"), {-->
<!--                type: 'line',-->
<!--                data: {{ salary_history|safe }},-->
<!--                options: {-->
<!--                  scales: {-->
<!--                    xAxes: [{-->
<!--                      type: 'time',-->
<!--                    }]-->
<!--                  }-->
<!--                }-->
<!--              });-->
<!--            </script>-->
<!--        </div>-->
<!--    </div>-->
</div>
<div class="right-panel">

    <div class="card">
        <div class="card-content">
            <div class="card-title">{% trans 'Kifizetett bér' %}</div>
        </div>
    </div>
</div>
{% endblock %}