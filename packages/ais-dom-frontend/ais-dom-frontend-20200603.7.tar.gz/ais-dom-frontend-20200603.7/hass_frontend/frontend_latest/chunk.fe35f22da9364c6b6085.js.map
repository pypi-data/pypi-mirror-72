{"version":3,"file":"chunk.fe35f22da9364c6b6085.js","sources":["webpack:///./src/components/ha-card.ts","webpack:///./src/panels/config/ha-config-section.ts","webpack:///./src/panels/aisgalery/ha-panel-aisgalery.js"],"sourcesContent":["import {\n  css,\n  CSSResult,\n  customElement,\n  html,\n  LitElement,\n  property,\n  TemplateResult,\n} from \"lit-element\";\n\n@customElement(\"ha-card\")\nclass HaCard extends LitElement {\n  @property() public header?: string;\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        background: var(\n          --ha-card-background,\n          var(--paper-card-background-color, white)\n        );\n        border-radius: var(--ha-card-border-radius, 2px);\n        box-shadow: var(\n          --ha-card-box-shadow,\n          0 2px 2px 0 rgba(0, 0, 0, 0.14),\n          0 1px 5px 0 rgba(0, 0, 0, 0.12),\n          0 3px 1px -2px rgba(0, 0, 0, 0.2)\n        );\n        color: var(--primary-text-color);\n        display: block;\n        transition: all 0.3s ease-out;\n        position: relative;\n      }\n\n      .card-header,\n      :host ::slotted(.card-header) {\n        color: var(--ha-card-header-color, --primary-text-color);\n        font-family: var(--ha-card-header-font-family, inherit);\n        font-size: var(--ha-card-header-font-size, 24px);\n        letter-spacing: -0.012em;\n        line-height: 32px;\n        padding: 24px 16px 16px;\n        display: block;\n      }\n\n      :host ::slotted(.card-content:not(:first-child)),\n      slot:not(:first-child)::slotted(.card-content) {\n        padding-top: 0px;\n        margin-top: -8px;\n      }\n\n      :host ::slotted(.card-content) {\n        padding: 16px;\n      }\n\n      :host ::slotted(.card-actions) {\n        border-top: 1px solid #e8e8e8;\n        padding: 5px 16px;\n      }\n    `;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      ${this.header\n        ? html` <div class=\"card-header\">${this.header}</div> `\n        : html``}\n      <slot></slot>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-card\": HaCard;\n  }\n}\n","import { css, customElement, html, LitElement, property } from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\n@customElement(\"ha-config-section\")\nexport class HaConfigSection extends LitElement {\n  @property() public isWide = false;\n\n  protected render() {\n    return html`\n      <div\n        class=\"content ${classMap({\n          narrow: !this.isWide,\n        })}\"\n      >\n        <div class=\"header\"><slot name=\"header\"></slot></div>\n        <div\n          class=\"together layout ${classMap({\n            narrow: !this.isWide,\n            vertical: !this.isWide,\n            horizontal: this.isWide,\n          })}\"\n        >\n          <div class=\"intro\"><slot name=\"introduction\"></slot></div>\n          <div class=\"panel flex-auto\"><slot></slot></div>\n        </div>\n      </div>\n    `;\n  }\n\n  static get styles() {\n    return css`\n      :host {\n        display: block;\n      }\n      .content {\n        padding: 28px 20px 0;\n        max-width: 1040px;\n        margin: 0 auto;\n      }\n\n      .layout {\n        display: flex;\n      }\n\n      .horizontal {\n        flex-direction: row;\n      }\n\n      .vertical {\n        flex-direction: column;\n      }\n\n      .flex-auto {\n        flex: 1 1 auto;\n      }\n\n      .header {\n        font-family: var(--paper-font-headline_-_font-family);\n        -webkit-font-smoothing: var(\n          --paper-font-headline_-_-webkit-font-smoothing\n        );\n        font-size: var(--paper-font-headline_-_font-size);\n        font-weight: var(--paper-font-headline_-_font-weight);\n        letter-spacing: var(--paper-font-headline_-_letter-spacing);\n        line-height: var(--paper-font-headline_-_line-height);\n        opacity: var(--dark-primary-opacity);\n      }\n\n      .together {\n        margin-top: 32px;\n      }\n\n      .intro {\n        font-family: var(--paper-font-subhead_-_font-family);\n        -webkit-font-smoothing: var(\n          --paper-font-subhead_-_-webkit-font-smoothing\n        );\n        font-weight: var(--paper-font-subhead_-_font-weight);\n        line-height: var(--paper-font-subhead_-_line-height);\n        width: 100%;\n        max-width: 400px;\n        margin-right: 40px;\n        opacity: var(--dark-primary-opacity);\n        font-size: 14px;\n        padding-bottom: 20px;\n      }\n\n      .panel {\n        margin-top: -24px;\n      }\n\n      .panel ::slotted(*) {\n        margin-top: 24px;\n        display: block;\n      }\n\n      .narrow.content {\n        max-width: 640px;\n      }\n      .narrow .together {\n        margin-top: 20px;\n      }\n      .narrow .intro {\n        padding-bottom: 20px;\n        margin-right: 0;\n        max-width: 500px;\n      }\n    `;\n  }\n}\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@material/mwc-fab\";\nimport { mdiPlus } from \"@mdi/js\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\nimport { showAisgaleryDialog } from \"./show-ha-aisgalery-dialog\";\nimport \"../../components/ha-card\";\nimport \"../../resources/ha-style\";\nimport \"../config/ha-config-section\";\n/* eslint-plugin-disable lit */\n\nclass HaPanelAisgalery extends PolymerElement {\n  static get template() {\n    return html`\n      <style include=\"ha-style\">\n        app-toolbar {\n          background-color: var(--primary-color);\n        }\n        div.content {\n          background-color: var(--primary-background-color);\n          width: 100%;\n          min-height: 100%;\n        }\n        .galery_content {\n          overflow: hidden;\n          width: 100%;\n          min-height: 80%;\n          position: absolute;\n        }\n        figcaption {\n          font-size: small;\n        }\n        img,\n        video {\n          width: 100%;\n          max-width: 600px;\n          object-fit: contain;\n        }\n        .image-viewer .btn {\n          position: absolute;\n          transform: translate(-50%, -50%);\n          -ms-transform: translate(-50%, -50%);\n          background-color: #555;\n          color: white;\n          font-size: 16px;\n          padding: 12px 12px;\n          border: none;\n          cursor: pointer;\n          border-radius: 5px;\n          opacity: 0;\n          transition: opacity 0.35s ease;\n        }\n        .image-viewer:hover .btn {\n          opacity: 1;\n        }\n        .image-viewer .btn-left {\n          left: 0%;\n          margin-left: 65px;\n        }\n        .image-viewer .btn-right {\n          right: 0%;\n          margin-right: 30px;\n        }\n        figure.selected {\n          opacity: 0.5;\n        }\n        figure:hover {\n          cursor: pointer;\n        }\n        .duration {\n          font-style: italic;\n        }\n        @media all and (max-width: 600px) {\n          .image-viewer {\n            width: 100%;\n            max-width: 400px;\n            margin: auto;\n          }\n          .image-viewer .btn {\n            top: 33%;\n          }\n          .image-menu {\n            width: 100%;\n            max-width: 300px;\n            overflow-y: hidden;\n            overflow-x: scroll;\n            display: flex;\n          }\n          .image-menu figure {\n            margin: 0px;\n            padding: 12px;\n          }\n        }\n\n        @media all and (min-width: 600px) {\n          .image-viewer {\n            width: 75%;\n            max-width: 500px;\n            position: relative;\n            margin: auto;\n          }\n          .image-viewer .btn {\n            top: 40%;\n          }\n\n          .image-menu {\n            width: 25%;\n            max-width: 300px;\n            height: calc(100vh - 120px);\n            overflow-y: scroll;\n            position: absolute;\n            top: 0px;\n            right: 0px;\n          }\n        }\n\n        @media all and (max-width: 800px) {\n          img,\n          video {\n            width: 100%;\n            max-width: 300px;\n          }\n          .image-viewer {\n            width: 75%;\n            max-width: 300px;\n          }\n          div.image-menu > img,\n          video {\n            width: 100%;\n            max-width: 150px;\n          }\n        }\n\n        mwc-fab {\n          position: fixed;\n          bottom: 16px;\n          right: 16px;\n          z-index: 1;\n        }\n\n        mwc-fab[is-wide] {\n          bottom: 24px;\n          right: 24px;\n        }\n        ha-icon-button {\n          vertical-align: middle;\n        }\n      </style>\n      <div class=\"content\">\n        <app-toolbar>\n          <ha-menu-button hass=\"[[hass]]\" narrow=\"[[narrow]]\"></ha-menu-button>\n          <div main-title>[[panel.title]]</div>\n          <ha-icon-button\n            aria-label=\"Instrukcja\"\n            icon=\"mdi:information-outline\"\n            on-click=\"_showHelp\"\n          ></ha-icon-button>\n        </app-toolbar>\n        <div class=\"galery_content\" id=\"content\">\n          <template is=\"dom-if\" if=\"[[showImages]]\">\n            <div class=\"image-viewer\">\n              <figure>\n                <img\n                  src=\"{{currentImage.path}}\"\n                  hidden$=\"[[isVideo(currentImage.extension)]]\"\n                />\n                <video\n                  controls\n                  src=\"{{currentImage.path}}#t=0.1\"\n                  hidden$=\"[[!isVideo(currentImage.extension)]]\"\n                  on-loadedmetadata=\"videoLoaded\"\n                  on-canplay=\"startVideo\"\n                ></video>\n                <figcaption>\n                  <span style=\"display: block; text-align: right;\">\n                    <ha-icon-button\n                      icon=\"mdi:image-edit-outline\"\n                      on-click=\"_editImage\"\n                      title=\"Edycja\"\n                    ></ha-icon-button>\n                    <ha-icon-button\n                      icon=\"hass:delete\"\n                      on-click=\"_deleteImage\"\n                    ></ha-icon-button\n                    ><br /> </span\n                  ><br />\n                  URLs:<br />\n                  <ha-icon-button icon=\"mdi:monitor-dashboard\"></ha-icon-button>\n                  {{currentImage.path}}<br />\n                  <ha-icon-button\n                    icon=\"mdi:home-import-outline\"\n                  ></ha-icon-button>\n                  http://{{aisLocalIP}}{{currentImage.path}}<br />\n                  <ha-icon-button\n                    icon=\"mdi:weather-cloudy-arrow-right\"\n                  ></ha-icon-button>\n                  {{remoteDomain}}{{currentImage.path}}\n                  <span\n                    class=\"duration\"\n                    hidden$=\"[[!isVideo(currentImage.extension)]]\"\n                  ></span>\n                </figcaption>\n              </figure>\n              <button class=\"btn btn-left\" on-click=\"previousImage\">\n                &lt;\n              </button>\n              <button class=\"btn btn-right\" on-click=\"nextImage\">\n                &gt;\n              </button>\n            </div>\n          </template>\n          <div class=\"image-menu\">\n            <template is=\"dom-repeat\" items=\"{{images}}\">\n              <figure\n                id=\"image[[item.index]]\"\n                data-imageIndex=\"{{item.index}}\"\n                on-click=\"imageMenuClick\"\n                class$=\"[[getImageMenuClass(item, currentImgIdx)]]\"\n              >\n                <img\n                  src=\"{{item.path}}\"\n                  hidden$=\"[[isVideo(item.extension)]]\"\n                />\n                <video\n                  src=\"{{item.path}}#t=0.1\"\n                  hidden$=\"[[!isVideo(item.extension)]]\"\n                  on-loadedmetadata=\"videoLoaded\"\n                ></video>\n                <figcaption>\n                  {{item.date}}\n                  <span\n                    class=\"duration\"\n                    hidden$=\"[[!isVideo(item.extension)]]\"\n                  ></span>\n                </figcaption>\n              </figure>\n            </template>\n          </div>\n        </div>\n        <mwc-fab\n          slot=\"fab\"\n          is-wide$=\"[[isWide]]\"\n          title=\"[[localize('ui.common.add')]]\"\n          on-click=\"addImage\"\n        >\n          <ha-svg-icon slot=\"icon\" path=\"[[addIcon()]]\"></ha-svg-icon>\n        </mwc-fab>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      narrow: Boolean,\n      showMenu: {\n        type: Boolean,\n        value: false,\n      },\n      aisLocalIP: {\n        type: String,\n        computed: \"_computeAisLocalIP(hass)\",\n      },\n      remoteDomain: {\n        type: String,\n        computed: \"_computeRemoteDomain(hass)\",\n      },\n      panel: Object,\n      images: {\n        type: Object,\n        computed: \"getImages(hass)\",\n      },\n      currentImage: Object,\n      currentImgIdx: {\n        type: Number,\n        computed: \"getcurrentImgIdx(hass)\",\n      },\n      autoPlayVideo: {\n        type: Boolean,\n        value: false,\n      },\n      showImages: Boolean,\n    };\n  }\n\n  async _deleteImage() {\n    const img = this.getImage(this.currentImgIdx);\n    await this.hass.callService(\"ais_files\", \"remove_file\", {\n      path: img.path,\n    });\n  }\n\n  async _editImage() {\n    const img = this.getImage(this.currentImgIdx);\n    var win = window.open(\n      \"/static/ais_dom/design_tool/index.html?img=\" + img.path,\n      \"_blank\"\n    );\n    win.focus();\n  }\n\n  async _showHelp() {\n    var win = window.open(\n      \"https://www.ai-speaker.com/docs/ais_app_integration_gallery/\",\n      \"_blank\"\n    );\n    win.focus();\n  }\n\n  _computeAisLocalIP(hass) {\n    return hass.states[\"sensor.internal_ip_address\"].state;\n  }\n\n  _computeRemoteDomain(hass) {\n    this.aisSecureAndroidId =\n      hass.states[\"sensor.ais_secure_android_id_dom\"].state;\n    return \"https://\" + this.aisSecureAndroidId + \".paczka.pro\";\n  }\n\n  addIcon() {\n    return mdiPlus;\n  }\n\n  addImage() {\n    showAisgaleryDialog(this);\n  }\n\n  getImage(idx) {\n    if (this.images !== undefined && idx !== undefined) {\n      return this.images[idx];\n    }\n    return 0;\n  }\n\n  isVideo(fileExt) {\n    const suportedVideos = [\"mp4\", \"webm\"];\n    if (fileExt) {\n      return suportedVideos.includes(fileExt);\n    }\n\n    return false;\n  }\n\n  imageMenuClick(e) {\n    this.autoPlayVideo = true;\n    this.setcurrentImgIdx(e.model.item.index);\n  }\n\n  previousImage() {\n    var idx = 0;\n    this.autoPlayVideo = true;\n    if (this.currentImgIdx === 0) {\n      idx = this.images.length - 1;\n    } else {\n      idx = Number(this.currentImgIdx) - 1;\n    }\n\n    this.setcurrentImgIdx(idx);\n  }\n\n  nextImage() {\n    var idx = 0;\n    this.autoPlayVideo = true;\n    if (this.currentImgIdx >= this.images.length - 1) {\n      idx = 0;\n    } else {\n      idx = Number(this.currentImgIdx) + 1;\n    }\n    this.setcurrentImgIdx(idx);\n  }\n\n  ready() {\n    super.ready();\n    this.autoPlayVideo = false;\n    this.setcurrentImgIdx(0);\n  }\n\n  setcurrentImgIdx(i) {\n    this.hass.callService(\"ais_files\", \"pick_file\", { idx: i });\n    this.getImages(this.hass);\n    this.currentImage = this.getImage(i);\n  }\n\n  getcurrentImgIdx(hass) {\n    try {\n      var idx = Number(hass.states[\"sensor.ais_gallery_img\"].state);\n      this.currentImage = this.getImage(idx);\n      return idx;\n    } catch (error) {\n      return 0;\n    }\n  }\n\n  getImages(hass) {\n    var paths = [];\n    try {\n      paths = hass.states[\"sensor.ais_gallery_img\"].attributes.fileList;\n    } catch (error) {\n      console.log(\"getImages error: \" + error);\n    }\n    var lastIndex = 0;\n    var lImages = [];\n    for (let i = paths.length - 1; i >= lastIndex; i--) {\n      var path = paths[i];\n      var arPath = path.split(\"/\");\n      var imageName = arPath[arPath.length - 1];\n      var arFileName = imageName.split(\".\");\n      var ext = arFileName[arFileName.length - 1].toLowerCase();\n      imageName = imageName.substring(0, imageName.length - ext.length - 1);\n\n      var image = {\n        path: path,\n        name: imageName,\n        extension: ext,\n        date: imageName,\n        index: lImages.length,\n      };\n      lImages.push(image);\n    }\n    if (lImages.length > 0) {\n      this.showImages = true;\n    } else {\n      this.showImages = false;\n    }\n    return lImages;\n  }\n\n  getImageMenuClass(image, idx) {\n    if (image.index === idx) return \"selected\";\n    return \"\";\n  }\n\n  videoLoaded(e) {\n    this.getVideoDuration(e);\n  }\n\n  getVideoDuration(e) {\n    var minutes = parseInt(e.target.duration / 60);\n    if (minutes < 10) minutes = \"0\" + minutes;\n\n    var seconds = parseInt(e.target.duration % 60);\n    seconds = \"0\" + seconds;\n    seconds = seconds.substring(seconds.length - 2);\n\n    e.target.parentNode.querySelector(\".duration\").innerHTML =\n      \"[\" + minutes + \":\" + seconds + \"]\";\n  }\n\n  startVideo(e) {\n    if (this.autoPlayVideo) e.target.play();\n  }\n}\n\ncustomElements.define(\"ha-panel-aisgalery\", HaPanelAisgalery);\n"],"mappings":"AAUA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AAEA;;AArDA;;ACDA;;;;AAMA;;;;;;AAZA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACwPA","sourceRoot":""}