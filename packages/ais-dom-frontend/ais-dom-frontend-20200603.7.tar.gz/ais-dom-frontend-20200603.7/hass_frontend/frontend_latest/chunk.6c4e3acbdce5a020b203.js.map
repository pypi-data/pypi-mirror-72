{"version":3,"file":"chunk.6c4e3acbdce5a020b203.js","sources":["webpack:///./src/common/entity/compute_state_name.ts","webpack:///./src/components/entity/state-badge.ts","webpack:///./src/components/entity/ha-entity-picker.ts","webpack:///./src/resources/codemirror.ondemand.ts","webpack:///./src/components/ha-combo-box.js","webpack:///./src/components/ha-service-picker.js","webpack:///./src/panels/developer-tools/service/developer-tools-service.js"],"sourcesContent":["import { HassEntity } from \"home-assistant-js-websocket\";\nimport { computeObjectId } from \"./compute_object_id\";\n\nexport const computeStateName = (stateObj: HassEntity): string => {\n  return stateObj.attributes.friendly_name === undefined\n    ? computeObjectId(stateObj.entity_id).replace(/_/g, \" \")\n    : stateObj.attributes.friendly_name || \"\";\n};\n","import type { HassEntity } from \"home-assistant-js-websocket\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport {\n  css,\n  CSSResult,\n  html,\n  LitElement,\n  property,\n  PropertyValues,\n  TemplateResult,\n} from \"lit-element\";\nimport { ifDefined } from \"lit-html/directives/if-defined\";\nimport { computeActiveState } from \"../../common/entity/compute_active_state\";\nimport { computeStateDomain } from \"../../common/entity/compute_state_domain\";\nimport { stateIcon } from \"../../common/entity/state_icon\";\nimport { iconColorCSS } from \"../../common/style/icon_color_css\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-icon\";\n\nexport class StateBadge extends LitElement {\n  public hass?: HomeAssistant;\n\n  @property() public stateObj?: HassEntity;\n\n  @property() public overrideIcon?: string;\n\n  @property() public overrideImage?: string;\n\n  @property({ type: Boolean }) public stateColor?: boolean;\n\n  @property({ type: Boolean, reflect: true, attribute: \"icon\" })\n  private _showIcon = true;\n\n  @property() private _iconStyle: { [name: string]: string } = {};\n\n  protected render(): TemplateResult {\n    const stateObj = this.stateObj;\n\n    if (!stateObj || !this._showIcon) {\n      return html``;\n    }\n\n    const domain = computeStateDomain(stateObj);\n\n    return html`\n      <ha-icon\n        style=${styleMap(this._iconStyle)}\n        data-domain=${ifDefined(\n          this.stateColor || (domain === \"light\" && this.stateColor !== false)\n            ? domain\n            : undefined\n        )}\n        data-state=${computeActiveState(stateObj)}\n        .icon=${this.overrideIcon || stateIcon(stateObj)}\n      ></ha-icon>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    if (!changedProps.has(\"stateObj\") || !this.stateObj) {\n      return;\n    }\n    const stateObj = this.stateObj;\n\n    const iconStyle: { [name: string]: string } = {};\n    const hostStyle: Partial<CSSStyleDeclaration> = {\n      backgroundImage: \"\",\n    };\n\n    this._showIcon = true;\n\n    if (stateObj) {\n      // hide icon if we have entity picture\n      if (\n        (stateObj.attributes.entity_picture && !this.overrideIcon) ||\n        this.overrideImage\n      ) {\n        let imageUrl = this.overrideImage || stateObj.attributes.entity_picture;\n        if (this.hass) {\n          imageUrl = this.hass.hassUrl(imageUrl);\n        }\n        hostStyle.backgroundImage = `url(${imageUrl})`;\n        this._showIcon = false;\n      } else if (stateObj.state === \"on\") {\n        if (stateObj.attributes.hs_color && this.stateColor !== false) {\n          const hue = stateObj.attributes.hs_color[0];\n          const sat = stateObj.attributes.hs_color[1];\n          if (sat > 10) {\n            iconStyle.color = `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n          }\n        }\n        if (stateObj.attributes.brightness && this.stateColor !== false) {\n          const brightness = stateObj.attributes.brightness;\n          if (typeof brightness !== \"number\") {\n            const errorMessage = `Type error: state-badge expected number, but type of ${\n              stateObj.entity_id\n            }.attributes.brightness is ${typeof brightness} (${brightness})`;\n            // eslint-disable-next-line\n            console.warn(errorMessage);\n          }\n          // lowest brighntess will be around 50% (that's pretty dark)\n          iconStyle.filter = `brightness(${(brightness + 245) / 5}%)`;\n        }\n      }\n    }\n    this._iconStyle = iconStyle;\n    Object.assign(this.style, hostStyle);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        position: relative;\n        display: inline-block;\n        width: 40px;\n        color: var(--paper-item-icon-color, #44739e);\n        border-radius: 50%;\n        height: 40px;\n        text-align: center;\n        background-size: cover;\n        line-height: 40px;\n        vertical-align: middle;\n        box-sizing: border-box;\n      }\n      :host(:focus) {\n        outline: none;\n      }\n      :host(:not([icon]):focus) {\n        border: 2px solid var(--divider-color);\n      }\n      :host([icon]:focus) {\n        background: var(--divider-color);\n      }\n      ha-icon {\n        transition: color 0.3s ease-in-out, filter 0.3s ease-in-out;\n      }\n\n      ${iconColorCSS}\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"state-badge\": StateBadge;\n  }\n}\n\ncustomElements.define(\"state-badge\", StateBadge);\n","import \"../ha-icon-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-item/paper-icon-item\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport \"@vaadin/vaadin-combo-box/theme/material/vaadin-combo-box-light\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport {\n  css,\n  CSSResult,\n  html,\n  LitElement,\n  property,\n  PropertyValues,\n  query,\n  TemplateResult,\n} from \"lit-element\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { computeDomain } from \"../../common/entity/compute_domain\";\nimport { computeStateName } from \"../../common/entity/compute_state_name\";\nimport { PolymerChangedEvent } from \"../../polymer-types\";\nimport { HomeAssistant } from \"../../types\";\nimport \"./state-badge\";\n\nexport type HaEntityPickerEntityFilterFunc = (entityId: HassEntity) => boolean;\n\nconst rowRenderer = (\n  root: HTMLElement,\n  _owner,\n  model: { item: HassEntity }\n) => {\n  if (!root.firstElementChild) {\n    root.innerHTML = `\n      <style>\n        paper-icon-item {\n          margin: -10px;\n          padding: 0;\n        }\n      </style>\n      <paper-icon-item>\n        <state-badge slot=\"item-icon\"></state-badge>\n        <paper-item-body two-line=\"\">\n          <div class='name'></div>\n          <div secondary></div>\n        </paper-item-body>\n      </paper-icon-item>\n    `;\n  }\n  root.querySelector(\"state-badge\")!.stateObj = model.item;\n  root.querySelector(\".name\")!.textContent = computeStateName(model.item);\n  root.querySelector(\"[secondary]\")!.textContent = model.item.entity_id;\n};\n\nclass HaEntityPicker extends LitElement {\n  @property({ type: Boolean }) public autofocus = false;\n\n  @property({ type: Boolean }) public disabled?: boolean;\n\n  @property({ type: Boolean, attribute: \"allow-custom-entity\" })\n  public allowCustomEntity;\n\n  @property() public hass?: HomeAssistant;\n\n  @property() public label?: string;\n\n  @property() public value?: string;\n\n  /**\n   * Show entities from specific domains.\n   * @type {Array}\n   * @attr include-domains\n   */\n  @property({ type: Array, attribute: \"include-domains\" })\n  public includeDomains?: string[];\n\n  /**\n   * Show no entities of these domains.\n   * @type {Array}\n   * @attr exclude-domains\n   */\n  @property({ type: Array, attribute: \"exclude-domains\" })\n  public excludeDomains?: string[];\n\n  /**\n   * Show only entities of these device classes.\n   * @type {Array}\n   * @attr include-device-classes\n   */\n  @property({ type: Array, attribute: \"include-device-classes\" })\n  public includeDeviceClasses?: string[];\n\n  @property() public entityFilter?: HaEntityPickerEntityFilterFunc;\n\n  @property({ type: Boolean }) private _opened = false;\n\n  @query(\"vaadin-combo-box-light\") private _comboBox!: HTMLElement;\n\n  private _getStates = memoizeOne(\n    (\n      _opened: boolean,\n      hass: this[\"hass\"],\n      includeDomains: this[\"includeDomains\"],\n      excludeDomains: this[\"excludeDomains\"],\n      entityFilter: this[\"entityFilter\"],\n      includeDeviceClasses: this[\"includeDeviceClasses\"]\n    ) => {\n      let states: HassEntity[] = [];\n\n      if (!hass) {\n        return [];\n      }\n      let entityIds = Object.keys(hass.states);\n\n      if (includeDomains) {\n        entityIds = entityIds.filter((eid) =>\n          includeDomains.includes(computeDomain(eid))\n        );\n      }\n\n      if (excludeDomains) {\n        entityIds = entityIds.filter(\n          (eid) => !excludeDomains.includes(computeDomain(eid))\n        );\n      }\n\n      states = entityIds.sort().map((key) => hass!.states[key]);\n\n      if (includeDeviceClasses) {\n        states = states.filter(\n          (stateObj) =>\n            // We always want to include the entity of the current value\n            stateObj.entity_id === this.value ||\n            (stateObj.attributes.device_class &&\n              includeDeviceClasses.includes(stateObj.attributes.device_class))\n        );\n      }\n\n      if (entityFilter) {\n        states = states.filter(\n          (stateObj) =>\n            // We always want to include the entity of the current value\n            stateObj.entity_id === this.value || entityFilter!(stateObj)\n        );\n      }\n\n      return states;\n    }\n  );\n\n  protected shouldUpdate(changedProps: PropertyValues) {\n    return !(!changedProps.has(\"_opened\") && this._opened);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    if (changedProps.has(\"_opened\") && this._opened) {\n      const states = this._getStates(\n        this._opened,\n        this.hass,\n        this.includeDomains,\n        this.excludeDomains,\n        this.entityFilter,\n        this.includeDeviceClasses\n      );\n      (this._comboBox as any).items = states;\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this.hass) {\n      return html``;\n    }\n\n    return html`\n      <vaadin-combo-box-light\n        item-value-path=\"entity_id\"\n        item-label-path=\"entity_id\"\n        .value=${this._value}\n        .allowCustomValue=${this.allowCustomEntity}\n        .renderer=${rowRenderer}\n        @opened-changed=${this._openedChanged}\n        @value-changed=${this._valueChanged}\n      >\n        <paper-input\n          .autofocus=${this.autofocus}\n          .label=${this.label === undefined\n            ? this.hass.localize(\"ui.components.entity.entity-picker.entity\")\n            : this.label}\n          .value=${this._value}\n          .disabled=${this.disabled}\n          class=\"input\"\n          autocapitalize=\"none\"\n          autocomplete=\"off\"\n          autocorrect=\"off\"\n          spellcheck=\"false\"\n        >\n          ${this.value\n            ? html`\n                <ha-icon-button\n                  aria-label=${this.hass.localize(\n                    \"ui.components.entity.entity-picker.clear\"\n                  )}\n                  slot=\"suffix\"\n                  class=\"clear-button\"\n                  icon=\"hass:close\"\n                  @click=${this._clearValue}\n                  no-ripple\n                >\n                  Clear\n                </ha-icon-button>\n              `\n            : \"\"}\n\n          <ha-icon-button\n            aria-label=${this.hass.localize(\n              \"ui.components.entity.entity-picker.show_entities\"\n            )}\n            slot=\"suffix\"\n            class=\"toggle-button\"\n            .icon=${this._opened ? \"hass:menu-up\" : \"hass:menu-down\"}\n          >\n            Toggle\n          </ha-icon-button>\n        </paper-input>\n      </vaadin-combo-box-light>\n    `;\n  }\n\n  private _clearValue(ev: Event) {\n    ev.stopPropagation();\n    this._setValue(\"\");\n  }\n\n  private get _value() {\n    return this.value || \"\";\n  }\n\n  private _openedChanged(ev: PolymerChangedEvent<boolean>) {\n    this._opened = ev.detail.value;\n  }\n\n  private _valueChanged(ev: PolymerChangedEvent<string>) {\n    const newValue = ev.detail.value;\n    if (newValue !== this._value) {\n      this._setValue(newValue);\n    }\n  }\n\n  private _setValue(value: string) {\n    this.value = value;\n    setTimeout(() => {\n      fireEvent(this, \"value-changed\", { value });\n      fireEvent(this, \"change\");\n    }, 0);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      paper-input > ha-icon-button {\n        --mdc-icon-button-size: 24px;\n        padding: 0px 2px;\n        color: var(--secondary-text-color);\n      }\n      [hidden] {\n        display: none;\n      }\n    `;\n  }\n}\n\ncustomElements.define(\"ha-entity-picker\", HaEntityPicker);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-entity-picker\": HaEntityPicker;\n  }\n}\n","interface LoadedCodeMirror {\n  codeMirror: any;\n  codeMirrorCss: any;\n}\n\nlet loaded: Promise<LoadedCodeMirror>;\n\nexport const loadCodeMirror = async (): Promise<LoadedCodeMirror> => {\n  if (!loaded) {\n    loaded = import(/* webpackChunkName: \"codemirror\" */ \"./codemirror\");\n  }\n  return loaded;\n};\n","import \"./ha-icon-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-item/paper-item\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\n/* eslint-plugin-disable lit */\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\nimport \"@vaadin/vaadin-combo-box/theme/material/vaadin-combo-box-light\";\nimport { EventsMixin } from \"../mixins/events-mixin\";\n\nclass HaComboBox extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style>\n        paper-input > ha-icon-button {\n          --mdc-icon-button-size: 24px;\n          padding: 2px;\n          color: var(--secondary-text-color);\n        }\n        [hidden] {\n          display: none;\n        }\n      </style>\n      <vaadin-combo-box-light\n        items=\"[[_items]]\"\n        item-value-path=\"[[itemValuePath]]\"\n        item-label-path=\"[[itemLabelPath]]\"\n        value=\"{{value}}\"\n        opened=\"{{opened}}\"\n        allow-custom-value=\"[[allowCustomValue]]\"\n        on-change=\"_fireChanged\"\n      >\n        <paper-input\n          autofocus=\"[[autofocus]]\"\n          label=\"[[label]]\"\n          class=\"input\"\n          value=\"[[value]]\"\n        >\n          <ha-icon-button\n            slot=\"suffix\"\n            class=\"clear-button\"\n            icon=\"hass:close\"\n            hidden$=\"[[!value]]\"\n            >Clear</ha-icon-button\n          >\n          <ha-icon-button\n            slot=\"suffix\"\n            class=\"toggle-button\"\n            icon=\"[[_computeToggleIcon(opened)]]\"\n            hidden$=\"[[!items.length]]\"\n            >Toggle</ha-icon-button\n          >\n        </paper-input>\n        <template>\n          <style>\n            paper-item {\n              margin: -5px -10px;\n              padding: 0;\n            }\n          </style>\n          <paper-item>[[_computeItemLabel(item, itemLabelPath)]]</paper-item>\n        </template>\n      </vaadin-combo-box-light>\n    `;\n  }\n\n  static get properties() {\n    return {\n      allowCustomValue: Boolean,\n      items: {\n        type: Object,\n        observer: \"_itemsChanged\",\n      },\n      _items: Object,\n      itemLabelPath: String,\n      itemValuePath: String,\n      autofocus: Boolean,\n      label: String,\n      opened: {\n        type: Boolean,\n        value: false,\n        observer: \"_openedChanged\",\n      },\n      value: {\n        type: String,\n        notify: true,\n      },\n    };\n  }\n\n  _openedChanged(newVal) {\n    if (!newVal) {\n      this._items = this.items;\n    }\n  }\n\n  _itemsChanged(newVal) {\n    if (!this.opened) {\n      this._items = newVal;\n    }\n  }\n\n  _computeToggleIcon(opened) {\n    return opened ? \"hass:menu-up\" : \"hass:menu-down\";\n  }\n\n  _computeItemLabel(item, itemLabelPath) {\n    return itemLabelPath ? item[itemLabelPath] : item;\n  }\n\n  _fireChanged(ev) {\n    ev.stopPropagation();\n    this.fire(\"change\");\n  }\n}\n\ncustomElements.define(\"ha-combo-box\", HaComboBox);\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\n/* eslint-plugin-disable lit */\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\nimport LocalizeMixin from \"../mixins/localize-mixin\";\nimport \"./ha-combo-box\";\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaServicePicker extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <ha-combo-box\n        label=\"[[localize('ui.components.service-picker.service')]]\"\n        items=\"[[_services]]\"\n        value=\"{{value}}\"\n        allow-custom-value=\"\"\n      ></ha-combo-box>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n        observer: \"_hassChanged\",\n      },\n      _services: Array,\n      value: {\n        type: String,\n        notify: true,\n      },\n    };\n  }\n\n  _hassChanged(hass, oldHass) {\n    if (!hass) {\n      this._services = [];\n      return;\n    }\n    if (oldHass && hass.services === oldHass.services) {\n      return;\n    }\n    const result = [];\n\n    Object.keys(hass.services)\n      .sort()\n      .forEach((domain) => {\n        const services = Object.keys(hass.services[domain]).sort();\n\n        for (let i = 0; i < services.length; i++) {\n          result.push(`${domain}.${services[i]}`);\n        }\n      });\n\n    this._services = result;\n  }\n}\n\ncustomElements.define(\"ha-service-picker\", HaServicePicker);\n","import \"@material/mwc-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\n/* eslint-plugin-disable lit */\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\nimport { safeDump, safeLoad } from \"js-yaml\";\nimport \"../../../components/entity/ha-entity-picker\";\nimport \"../../../components/ha-code-editor\";\nimport \"../../../components/ha-service-picker\";\nimport { ENTITY_COMPONENT_DOMAINS } from \"../../../data/entity\";\nimport { showAlertDialog } from \"../../../dialogs/generic/show-dialog-box\";\nimport LocalizeMixin from \"../../../mixins/localize-mixin\";\nimport \"../../../styles/polymer-ha-style\";\nimport \"../../../util/app-localstorage-document\";\n\nconst ERROR_SENTINEL = {};\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaPanelDevService extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style include=\"ha-style\">\n        :host {\n          -ms-user-select: initial;\n          -webkit-user-select: initial;\n          -moz-user-select: initial;\n          display: block;\n          padding: 16px;\n          direction: ltr;\n        }\n\n        .ha-form {\n          margin-right: 16px;\n          max-width: 400px;\n        }\n\n        mwc-button {\n          margin-top: 8px;\n        }\n\n        .description {\n          margin-top: 24px;\n          white-space: pre-wrap;\n        }\n\n        .header {\n          @apply --paper-font-title;\n        }\n\n        .attributes th {\n          text-align: left;\n        }\n\n        .attributes tr {\n          vertical-align: top;\n        }\n\n        .attributes tr:nth-child(odd) {\n          background-color: var(--table-row-background-color, #eee);\n        }\n\n        .attributes tr:nth-child(even) {\n          background-color: var(--table-row-alternative-background-color, #eee);\n        }\n\n        .attributes td:nth-child(3) {\n          white-space: pre-wrap;\n          word-break: break-word;\n        }\n\n        pre {\n          margin: 0;\n        }\n\n        h1 {\n          white-space: normal;\n        }\n\n        td {\n          padding: 4px;\n        }\n\n        .error {\n          color: var(--google-red-500);\n        }\n      </style>\n\n      <app-localstorage-document\n        key=\"panel-dev-service-state-domain-service\"\n        data=\"{{domainService}}\"\n      >\n      </app-localstorage-document>\n      <app-localstorage-document\n        key=\"[[_computeServicedataKey(domainService)]]\"\n        data=\"{{serviceData}}\"\n      >\n      </app-localstorage-document>\n\n      <div class=\"content\">\n        <p>\n          [[localize('ui.panel.developer-tools.tabs.services.description')]]\n        </p>\n\n        <div class=\"ha-form\">\n          <ha-service-picker\n            hass=\"[[hass]]\"\n            value=\"{{domainService}}\"\n          ></ha-service-picker>\n          <template is=\"dom-if\" if=\"[[_computeHasEntity(_attributes)]]\">\n            <ha-entity-picker\n              hass=\"[[hass]]\"\n              value=\"[[_computeEntityValue(parsedJSON)]]\"\n              on-change=\"_entityPicked\"\n              disabled=\"[[!validJSON]]\"\n              include-domains=\"[[_computeEntityDomainFilter(_domain)]]\"\n              allow-custom-entity\n            ></ha-entity-picker>\n          </template>\n          <p>[[localize('ui.panel.developer-tools.tabs.services.data')]]</p>\n          <ha-code-editor\n            mode=\"yaml\"\n            value=\"[[serviceData]]\"\n            error=\"[[!validJSON]]\"\n            on-value-changed=\"_yamlChanged\"\n          ></ha-code-editor>\n          <mwc-button on-click=\"_callService\" raised disabled=\"[[!validJSON]]\">\n            [[localize('ui.panel.developer-tools.tabs.services.call_service')]]\n          </mwc-button>\n        </div>\n\n        <template is=\"dom-if\" if=\"[[!domainService]]\">\n          <h1>\n            [[localize('ui.panel.developer-tools.tabs.services.select_service')]]\n          </h1>\n        </template>\n\n        <template is=\"dom-if\" if=\"[[domainService]]\">\n          <template is=\"dom-if\" if=\"[[!_description]]\">\n            <h1>\n              [[localize('ui.panel.developer-tools.tabs.services.no_description')]]\n            </h1>\n          </template>\n          <template is=\"dom-if\" if=\"[[_description]]\">\n            <h3>[[_description]]</h3>\n\n            <table class=\"attributes\">\n              <tr>\n                <th>\n                  [[localize('ui.panel.developer-tools.tabs.services.column_parameter')]]\n                </th>\n                <th>\n                  [[localize('ui.panel.developer-tools.tabs.services.column_description')]]\n                </th>\n                <th>\n                  [[localize('ui.panel.developer-tools.tabs.services.column_example')]]\n                </th>\n              </tr>\n              <template is=\"dom-if\" if=\"[[!_attributes.length]]\">\n                <tr>\n                  <td colspan=\"3\">\n                    [[localize('ui.panel.developer-tools.tabs.services.no_parameters')]]\n                  </td>\n                </tr>\n              </template>\n              <template is=\"dom-repeat\" items=\"[[_attributes]]\" as=\"attribute\">\n                <tr>\n                  <td><pre>[[attribute.key]]</pre></td>\n                  <td>[[attribute.description]]</td>\n                  <td>[[attribute.example]]</td>\n                </tr>\n              </template>\n            </table>\n\n            <template is=\"dom-if\" if=\"[[_attributes.length]]\">\n              <mwc-button on-click=\"_fillExampleData\">\n                [[localize('ui.panel.developer-tools.tabs.services.fill_example_data')]]\n              </mwc-button>\n            </template>\n          </template>\n        </template>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      domainService: {\n        type: String,\n        observer: \"_domainServiceChanged\",\n      },\n\n      _domain: {\n        type: String,\n        computed: \"_computeDomain(domainService)\",\n      },\n\n      _service: {\n        type: String,\n        computed: \"_computeService(domainService)\",\n      },\n\n      serviceData: {\n        type: String,\n        value: \"\",\n      },\n\n      parsedJSON: {\n        type: Object,\n        computed: \"_computeParsedServiceData(serviceData)\",\n      },\n\n      validJSON: {\n        type: Boolean,\n        computed: \"_computeValidJSON(parsedJSON)\",\n      },\n\n      _attributes: {\n        type: Array,\n        computed: \"_computeAttributesArray(hass, _domain, _service)\",\n      },\n\n      _description: {\n        type: String,\n        computed: \"_computeDescription(hass, _domain, _service)\",\n      },\n    };\n  }\n\n  _domainServiceChanged() {\n    this.serviceData = \"\";\n  }\n\n  _computeAttributesArray(hass, domain, service) {\n    const serviceDomains = hass.services;\n    if (!(domain in serviceDomains)) return [];\n    if (!(service in serviceDomains[domain])) return [];\n\n    const fields = serviceDomains[domain][service].fields;\n    return Object.keys(fields).map(function (field) {\n      return { key: field, ...fields[field] };\n    });\n  }\n\n  _computeDescription(hass, domain, service) {\n    const serviceDomains = hass.services;\n    if (!(domain in serviceDomains)) return undefined;\n    if (!(service in serviceDomains[domain])) return undefined;\n    return serviceDomains[domain][service].description;\n  }\n\n  _computeServicedataKey(domainService) {\n    return `panel-dev-service-state-servicedata.${domainService}`;\n  }\n\n  _computeDomain(domainService) {\n    return domainService.split(\".\", 1)[0];\n  }\n\n  _computeService(domainService) {\n    return domainService.split(\".\", 2)[1] || null;\n  }\n\n  _computeParsedServiceData(serviceData) {\n    try {\n      return serviceData.trim() ? safeLoad(serviceData) : {};\n    } catch (err) {\n      return ERROR_SENTINEL;\n    }\n  }\n\n  _computeValidJSON(parsedJSON) {\n    return parsedJSON !== ERROR_SENTINEL;\n  }\n\n  _computeHasEntity(attributes) {\n    return attributes.some((attr) => attr.key === \"entity_id\");\n  }\n\n  _computeEntityValue(parsedJSON) {\n    return parsedJSON === ERROR_SENTINEL ? \"\" : parsedJSON.entity_id;\n  }\n\n  _computeEntityDomainFilter(domain) {\n    return ENTITY_COMPONENT_DOMAINS.includes(domain) ? [domain] : null;\n  }\n\n  _callService() {\n    if (this.parsedJSON === ERROR_SENTINEL) {\n      showAlertDialog(this, {\n        text: this.hass.localize(\n          \"ui.panel.developer-tools.tabs.services.alert_parsing_yaml\",\n          \"data\",\n          this.serviceData\n        ),\n      });\n      return;\n    }\n\n    this.hass.callService(this._domain, this._service, this.parsedJSON);\n  }\n\n  _fillExampleData() {\n    const example = {};\n    this._attributes.forEach((attribute) => {\n      if (attribute.example) {\n        let value = \"\";\n        try {\n          value = safeLoad(attribute.example);\n        } catch (err) {\n          value = attribute.example;\n        }\n        example[attribute.key] = value;\n      }\n    });\n    this.serviceData = safeDump(example);\n  }\n\n  _entityPicked(ev) {\n    this.serviceData = safeDump({\n      ...this.parsedJSON,\n      entity_id: ev.target.value,\n    });\n  }\n\n  _yamlChanged(ev) {\n    this.serviceData = ev.detail.value;\n  }\n}\n\ncustomElements.define(\"developer-tools-service\", HaPanelDevService);\n"],"mappings":";AACA;;AC6CA;AACA;AAKA;AACA;;AAlCA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;AAtHA;;;;AC6JA;AACA;AAvJA;AAyJA;AACA;;;AAGA;AACA;AAGA;AACA;;;;;;;AAOA;;AAGA;;;;AAMA;;;;;AAMA;AACA;;AAEA;;;AAKA;;;;;;AAjDA;;;;;;;;;AApHA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChDA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC4DA;;;;;;;AC5CA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACmKA","sourceRoot":""}