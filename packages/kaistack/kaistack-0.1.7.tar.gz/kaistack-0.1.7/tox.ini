# content of: tox.ini , put in same dir as setup.py
[tox]
envlist = py37
isolated_build = True
distdir=dist

[testenv]
deps =
    pytest
    flake8
    auth0-python
commands =
    flake8 .
    pytest

[pytest]
testpaths = tests
python_files = **.py

[flake8]
exclude = .tox,*.egg,build,data,tests/*,kaistack/clients/grpcclient,kaistack/clients/openapi_clients
select = E,W,F
ignore = E226,E302,E41
max-line-length = 160
max-complexity = 10

[testenv:build]
skip_install = true
commands =
    # clean up build/ and dist/ folders
    python -c 'import shutil; shutil.rmtree("dist", ignore_errors=True)'
    python setup.py clean --all
    # build sdist
    python setup.py sdist --dist-dir {toxinidir}/dist
    # build wheel from sdist
    pip wheel -v --no-deps --no-index --no-build-isolation --wheel-dir {toxinidir}/dist --find-links {toxinidir}/dist kaistack
deps =
    setuptools
    wheel
