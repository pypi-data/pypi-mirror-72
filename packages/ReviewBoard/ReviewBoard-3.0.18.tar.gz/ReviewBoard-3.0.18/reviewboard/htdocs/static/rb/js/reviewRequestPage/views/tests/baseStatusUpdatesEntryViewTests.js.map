{"version":3,"sources":["baseStatusUpdatesEntryViewTests.es6.js"],"names":[],"mappings":"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","file":"baseStatusUpdatesEntryViewTests.js","sourcesContent":["suite('rb/reviewRequestPage/views/BaseStatusUpdatesEntryView', function() {\n    /* It's much easier to test against a stub than the full page. */\n    const TestPage = Backbone.View.extend({\n        stopWatchingEntryUpdates() {},\n        watchEntryUpdates() {},\n        queueLoadDiff() {},\n    });\n\n    let entryView;\n    let page;\n    let entry;\n\n    beforeEach(function() {\n        const reviewRequest = new RB.ReviewRequest();\n        const editor = new RB.ReviewRequestEditor({\n            reviewRequest: reviewRequest\n        });\n\n        entry = new RB.ReviewRequestPage.StatusUpdatesEntry({\n            reviews: [\n                reviewRequest.createReview(100, {\n                    loaded: true,\n                    links: {\n                        replies: {\n                            href: '/api/review/100/replies/'\n                        }\n                    }\n                }),\n                reviewRequest.createReview(101, {\n                    loaded: true,\n                    links: {\n                        replies: {\n                            href: '/api/review/101/replies/'\n                        }\n                    }\n                }),\n            ],\n            reviewRequest: reviewRequest,\n            reviewRequestEditor: editor,\n            id: '0',\n            typeID: 'initial_status_updates',\n            addedTimestamp: new Date(Date.UTC(2017, 7, 18, 13, 40, 25)),\n            updatedTimestamp: new Date(Date.UTC(2017, 7, 18, 16, 20, 0)),\n            pendingStatusUpdates: true,\n            diffCommentsData: [\n                ['1', '100'],\n                ['2', '100-101'],\n            ],\n        });\n\n        entryView = new RB.ReviewRequestPage.BaseStatusUpdatesEntryView({\n            model: entry,\n        });\n\n        page = new TestPage();\n        page.diffFragmentQueue = new RB.DiffFragmentQueueView({\n            containerPrefix: 'comment',\n        });\n        entry.set('page', page);\n        RB.PageManager.setPage(page);\n    });\n\n    afterEach(function() {\n        RB.PageManager.setPage(null);\n    });\n\n    describe('Dynamic Updating', function() {\n        describe('Update checking', function() {\n            it('Enabled when pendingStatusUpdates=true', function() {\n                spyOn(entry, 'watchUpdates');\n\n                entry.set('pendingStatusUpdates', true);\n                entryView.render();\n\n                expect(entry.watchUpdates).toHaveBeenCalled();\n            });\n\n            it('Disabled when pendingStatusUpdates=false', function() {\n                spyOn(entry, 'watchUpdates');\n\n                entry.set('pendingStatusUpdates', false);\n                entryView.render();\n\n                expect(entry.watchUpdates).not.toHaveBeenCalled();\n            });\n        });\n\n        it('Saves fragments on beforeApplyUpdate', function() {\n            spyOn(page.diffFragmentQueue, 'saveFragment');\n            spyOn(page, 'stopWatchingEntryUpdates');\n\n            entryView.beforeApplyUpdate();\n            expect(page.diffFragmentQueue.saveFragment.calls.count()).toBe(2);\n            expect(page.diffFragmentQueue.saveFragment.calls.argsFor(0))\n                .toEqual(['1']);\n            expect(page.diffFragmentQueue.saveFragment.calls.argsFor(1))\n                .toEqual(['2']);\n            expect(page.stopWatchingEntryUpdates).toHaveBeenCalled();\n        });\n    });\n\n    describe('render', function() {\n        it('Creates ReviewViews', function() {\n            entryView.render();\n\n            expect(entryView._reviewViews.length).toBe(2);\n        });\n    });\n});\n"]}