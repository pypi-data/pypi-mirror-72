(this.webpackJsonpmopidy_webui=this.webpackJsonpmopidy_webui||[]).push([[0],{112:function(e){e.exports=JSON.parse('{"a":"0.2.0"}')},130:function(e,t,n){e.exports=n(147)},139:function(e,t,n){},141:function(e,t,n){},147:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(10),c=n.n(i),o=n(18),l=n(34),s=(n(139),n(140),n(14)),u=function(e){if(void 0===e||null===e)return"??";var t=Math.ceil(e/1e3),n=t%60,a=n<10?"0"+n:""+n;return"".concat((t-n)/60,":").concat(a)},d=function(e,t){return e[t]},p={spotify:"Spotify",spotifytunigo:"Spotify browse",spotifyweb:"Spotify browse",local:"Local media",m3u:"Local playlists",podcast:"Podcasts","podcast+itunes":"iTunes Store: Podcasts",dirble:"Dirble",tunein:"TuneIn",soundcloud:"SoundCloud",gmusic:"Google Music",internetarchive:"Internet Archive",somafm:"Soma FM",youtube:"YouTube",audioaddict:"AudioAddict",subsonic:"Subsonic"},m=["file","http","https","mms","rtmp","rtmps","rtsp","yt"],f=r.a.createContext(null),y=function(e,t){return e.map((function(e,n){return[e,t[n]]})).every((function(e){var t=Object(s.a)(e,2);return t[0]===t[1]}))};n(141);var h=n(8),E=n(176),g=n(171),b=n(148),k=n(89),_=n.n(k),v=n(91),O=n.n(v),C=n(60),w=n.n(C),S=n(90),I=n.n(S),A=function(e){var t=e.state,n=r.a.useContext(f).mopidy;return r.a.createElement(g.a,null,r.a.createElement(b.a,{onClick:function(){return n.playback.previous()}},r.a.createElement(_.a,{fontSize:"large"})),"playing"===t?r.a.createElement(b.a,{onClick:function(){return n.playback.pause()}},r.a.createElement(I.a,{fontSize:"large"})):r.a.createElement(b.a,{onClick:function(){return n.playback.play()}},r.a.createElement(w.a,{fontSize:"large"})),r.a.createElement(b.a,{onClick:function(){return n.playback.next()}},r.a.createElement(O.a,{fontSize:"large"})))},x=n(194),L=n(175),R=function(e){var t=e.time_position,n=e.track_length,a=e.dispatch,i=r.a.useContext(f).mopidy,c=Math.ceil(t/n*300);return n?r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement("div",{style:{width:"40px"}},u(t)),r.a.createElement(x.a,{value:c,onChange:function(e,t){a({type:"PLAYBACK_INFO",target:"time_position",data:t*n/300})},onChangeCommitted:function(e,t){i.playback.seek({time_position:Math.ceil(t*n/300)})},max:300,valueLabelDisplay:"auto",valueLabelFormat:function(e){return u(e*n/300)},style:{flex:1,marginRight:"5%",marginLeft:"5%"}}),r.a.createElement("div",null,u(n))):r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement("div",null,u(t)),r.a.createElement(L.a,{style:{flex:1,marginRight:"5%",marginLeft:"5%"}}))},N=n(92),j=n.n(N),T=n(93),D=n.n(T),P=function(e){var t=e.volume,n=e.dispatch,a=e.style,i=r.a.useContext(f).mopidy;return r.a.createElement("div",{style:Object(h.a)({display:"flex",flexDirection:"row",alignItems:"center"},a)},r.a.createElement("div",{onClick:function(){return i.mixer.setVolume({volume:t-1})}},r.a.createElement(j.a,null)),r.a.createElement("div",{style:{flex:1,marginLeft:"5%",marginRight:"5%"}},r.a.createElement(x.a,{value:t,onChange:function(e,t){n({type:"PLAYBACK_INFO",target:"volume",data:t})},onChangeCommitted:function(e,t){i.mixer.setVolume({volume:t})},valueLabelDisplay:"auto"})),r.a.createElement("div",{onClick:function(){return i.mixer.setVolume({volume:t+1})}},r.a.createElement(D.a,null)))},Y=function(e){var t=e.track;if(!t)return"...";var n=t.name?r.a.createElement("div",null,t.name):null,a=t.album?r.a.createElement("div",null,t.album.name):null,i=t.artists?r.a.createElement("div",null,t.artists[0].name):null;return t.album,r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},n,a,i)},B=function(e){var t=e.tltrack,n=e.state,a=e.time_position,i=e.time_position_updater,c=(e.updating,e.volume),o=e.seek_update_interval,l=e.dispatch;return"playing"!==n||"number"!==typeof a||i.pending||(l({type:"INCR_PLAYBACK_START"}),setTimeout((function(){return l({type:"INCR_PLAYBACK"})}),o)),r.a.createElement(E.a,{elevation:3,style:{width:"80%",margin:"auto",display:"flex",flexDirection:"row",padding:"5px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement(A,{state:n}),r.a.createElement(P,{volume:c,dispatch:l,style:{marginTop:"auto",marginBottom:"auto"}})),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1,paddingLeft:"5%",paddingRight:"5%"}},r.a.createElement(Y,{track:t.track}),r.a.createElement(R,{time_position:a,track_length:t.track?t.track.length:null,dispatch:l}),r.a.createElement("div",null)))},M=B=Object(o.b)((function(e){return Object(h.a)({},e.playback_state,{seek_update_interval:e.settings.persistant.seek_update_interval})}))(B),K=n(94),U=n.n(K),F=n(95),z=n.n(F),q=n(96),H=n.n(q),W=n(97),J=n.n(W),V=n(189),G=n(190),X=n(182),$=n(179),Q=n(188),Z=function(e){var t=e.mopidy,n=e.searchUris,a=e.dispatch,i=e.closePopover,c=localStorage.getItem("searchSelectedURI")||"all",o=r.a.useState(c),l=Object(s.a)(o,2),u=l[0],d=l[1],p=r.a.useState(""),m=Object(s.a)(p,2),f=m[0],y=m[1],E=function(e){if("Enter"===e&&0!==f.length){var n="all"===u?{}:{uris:[u+":"]};t.library.search(Object(h.a)({query:{any:f}},n)).then((function(e){var t=e.map((function(e){return Object(h.a)({},e,{name:e.uri,children:e.tracks,type:"search_result",expanded:!0})}));a({type:"LIBRARY_SET_CHILDREN",fun:function(){return t},target:["search:"]}),a({type:"LIBRARY_SET_EXPANDED",target:["search:"],data:!0})})),i()}};return r.a.createElement("div",null,r.a.createElement(G.a,{id:"search-popover-textinput",variant:"outlined",value:f,onChange:function(e){return y(e.target.value)},onKeyPress:function(e){return E(e.key)},autoFocus:!0}),r.a.createElement($.a,{variant:"outlined"},r.a.createElement(Q.a,{native:!0,value:u,onChange:function(e){localStorage.setItem("searchSelectedURI",e.target.value),d(e.target.value)},onKeyPress:function(e){return E(e.key)}},r.a.createElement("option",{value:"all"},"All"),n.map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return r.a.createElement("option",{value:n,key:n},a)})))))},ee=function(e){var t=e.pendingRequestsNb;return e.connected?0===t?r.a.createElement("div",null,r.a.createElement(X.a,{size:30,thickness:5,style:{marginTop:"10px",marginBottom:"10px"},variant:"determinate",value:100})):r.a.createElement("div",null,r.a.createElement(X.a,{size:30,thickness:5,style:{marginTop:"10px",marginBottom:"10px"}})):r.a.createElement("div",null,r.a.createElement(X.a,{size:30,thickness:5,style:{marginTop:"10px",marginBottom:"10px"},color:"secondary"}))},te=Object(o.b)((function(e){return e.mopidy}))((function(e){var t=e.dispatch,n=e.mopidy,a=e.uri_schemes,i=e.pendingRequestsNb,c=e.connected,o=r.a.useRef(null),l=r.a.useState(!1),u=Object(s.a)(l,2),d=u[0],f=u[1],y=a.filter((function(e){return!m.includes(e)})).map((function(e){return[e,p[e]||e]}));return r.a.createElement(E.a,{elevation:3,style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},r.a.createElement(g.a,{orientation:"vertical"},r.a.createElement(ee,{pendingRequestsNb:i,connected:c}),r.a.createElement(b.a,{style:{height:"auto"},onClick:function(){return t({type:"ACTIVATE_PANEL",target:"control"})}},r.a.createElement(U.a,null)),r.a.createElement(b.a,{onClick:function(){return t({type:"ACTIVATE_PANEL",target:"library"})}},r.a.createElement(z.a,null)),r.a.createElement(b.a,{ref:o,id:"popover-search-button",onClick:function(){return f(!0)}},r.a.createElement(H.a,null)),r.a.createElement(V.a,{id:"search-popover",open:d,anchorEl:o.current,onClose:function(){return f(!1)},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"}},r.a.createElement(Z,{searchUris:y,mopidy:n,dispatch:t,closePopover:function(){return f(!1)}}))),r.a.createElement(g.a,null,r.a.createElement(b.a,{onClick:function(){return t({type:"ACTIVATE_PANEL",target:"help"})}},r.a.createElement(J.a,null))))})),ne=n(65),ae=n(99),re=n.n(ae),ie=n(102),ce=n.n(ie),oe=n(51),le=n.n(oe),se=n(100),ue=n.n(se),de=n(103),pe=n.n(de),me=n(104),fe=n.n(me),ye=n(193),he=n(192),Ee=n(181),ge=n(149),be=n(187),ke=n(186),_e=n(42),ve=n(185),Oe=n(50),Ce=n.n(Oe),we=n(183),Se=n(184),Ie=function(e){var t=e.label,n=e.action,a=e.icon,i=r.a.useState(""),c=Object(s.a)(i,2),o=c[0],l=c[1];return r.a.createElement(G.a,{label:t,value:o,onChange:function(e){return l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(n(o),l(""))},autoFocus:!0,InputProps:{endAdornment:r.a.createElement(we.a,{position:"end"},r.a.createElement(Se.a,{onClick:function(){n(o),l("")}},a))}})},Ae=function(e){var t=e.dispatch,n=e.bookmarks,a=e.tracklist,i=e.menuState,c=e.setMenuState,o=e.anchorElRef,l=e.current_tlid,s=function(e){var n=a.findIndex((function(e){return e.tlid===l}));t({type:"LIBRARY_SET_CHILDREN",target:["bookmark:"],fun:function(t){return t.find((function(t){return t.name==e}))?t.map((function(t){return t.name===e?Object(h.a)({},t,{current_track_index:n}):t})):[].concat(Object(_e.a)(t),[{name:e,uri:"bookmark:"+e,current_track_index:n,type:"bookmark"}])}}),t({type:"LIBRARY_SET_CHILDREN",target:["bookmark:","bookmark:"+e],fun:function(){return a.map((function(e){return e.track}))}}),t({type:"BOOKMARK_SAVE"})};return r.a.createElement(V.a,{anchorEl:o.current,keepMounted:!0,open:"bookmark"===i,onClose:function(){return c(!1)},onKeyPress:function(){}},r.a.createElement(ve.a,null,r.a.createElement(Ie,{label:"New Bookmark",icon:r.a.createElement(Ce.a,null),action:function(e){s(e),c(null)}})),n.children&&n.children.map((function(e){return r.a.createElement(ve.a,{key:e.uri,onClick:function(){s(e.name,a.map((function(e){return e.track}))),c(null)}},e.name)})))};Ae=Object(o.b)((function(e){return{bookmarks:e.library.bookmarks,current_tlid:e.playback_state.tltrack?e.playback_state.tltrack.tlid:null}}))(Ae);var xe=function(e,t,n){e.playlists.create({name:t,uri_scheme:"m3u"}).then((function(t){t.tracks=n,e.playlists.save({playlist:t}).then()}))},Le=function(e){var t=e.menuState,n=e.setMenuState,a=e.anchorElRef,i=e.playlists,c=e.tracklist,o=r.a.useContext(f).mopidy;return"menu"===t?r.a.createElement((function(){return r.a.createElement(V.a,{anchorEl:a.current,keepMounted:!0,open:"menu"===t,onClose:function(){return n(!1)}},r.a.createElement(ve.a,null,r.a.createElement(Ie,{icon:r.a.createElement(Ce.a,null),label:"New Playlist",action:function(e){var t;(t=e)&&0!==t.length&&(i.children.map((function(e){return e.name})).includes(t)?console.log("Playlist ",t,"already exists!"):xe(o,t,c.map((function(e){return e.track})))),n(null)}})),r.a.createElement(ve.a,{onClick:function(e){return n("submenu")}},"Overwrite Playlist"))}),null):r.a.createElement((function(){return r.a.createElement(V.a,{anchorEl:a.current,keepMounted:!0,open:"submenu"===t,onClose:function(){return n(!1)}},i.children&&i.children.map((function(e){return r.a.createElement(ve.a,{key:e.uri,onClick:function(){xe(o,e.name,c.map((function(e){return e.track}))),n(null)}},e.name)})))}),null)},Re=function(e){e.dispatch;var t=e.tracklist,n=e.current_tlid,a=r.a.useContext(f).mopidy;return r.a.createElement(ne.a,{list:t,setList:function(){},tag:Ee.a,style:{overflow:"auto",maxHeight:"100%",padding:0},group:{name:"tracklist",pull:!0,put:["library"]},onEnd:function(e){return function(e,t){t.tracklist.move({start:e.oldIndex,end:e.oldIndex,to_position:e.newIndex})}(e,a)},id:"tracklist"},t.map((function(e){return r.a.createElement(ge.a,{key:e.tlid,className:e.tlid===n?"tracklist_current":"",style:{padding:0}},e.tlid===n?r.a.createElement(re.a,{fontSize:"small"}):"",r.a.createElement(ke.a,null,function(e){try{return"".concat(e.track.album.name," / ").concat(e.track.track_no,". ").concat(e.track.name)}catch(t){return e.track.name||e.track.uri}}(e)),r.a.createElement(be.a,null,r.a.createElement(g.a,null,r.a.createElement(b.a,{onClick:function(){return a.playback.play({tlid:e.tlid})}},r.a.createElement(w.a,{fontSize:"small"})),r.a.createElement(b.a,{onClick:function(){return a.tracklist.remove({criteria:{tlid:[e.tlid]}})}},r.a.createElement(le.a,{fontSize:"small"})))))})))},Ne=function(e){var t=e.tracklist,n=e.playlists,a=(e.bookmarks,e.dispatch),i=r.a.useContext(f).mopidy,c=r.a.useRef(null),o=r.a.useState(null),l=Object(s.a)(o,2),u=l[0],d=l[1],p=r.a.useState(t),m=Object(s.a)(p,2),h=m[0],k=m[1];return r.a.useEffect((function(){y(t.map((function(e){return e.track.uri})),h.map((function(e){return e.track.uri})))||(n.synced&&(xe(i,n.synced.name,t.map((function(e){return e.track}))),i.playlists.getItems({uri:n.synced.uri}).then((function(e){return a({type:"LIBRARY_SET_CHILDREN",target:["playlist:",n.synced.uri],fun:function(){return e||[]}})}))),k(t))}),[t]),r.a.createElement(E.a,{style:{paddingLeft:"10px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},n.synced&&r.a.createElement(he.a,{icon:r.a.createElement(ue.a,null),color:"primary",onDelete:function(){return a({type:"PLAYLIST_UNSYNC"})},style:{float:"left"},label:n.synced.name,variant:"outlined",size:"small"}),r.a.createElement("div",null,t.length," tracks"),r.a.createElement(g.a,null,r.a.createElement(ye.a,{title:"Clear playlist"},r.a.createElement(b.a,{onClick:function(){a({type:"TRACKLIST_UNSYNC"}),i.tracklist.clear()}},r.a.createElement(ce.a,{fontSize:"small"}))),r.a.createElement(ye.a,{title:"Save as..."},r.a.createElement(b.a,{onClick:function(e){return d("menu")},ref:c},r.a.createElement(pe.a,null))),r.a.createElement(Le,{menuState:u,setMenuState:d,anchorElRef:c,playlists:n,tracklist:t}),r.a.createElement(ye.a,{title:"Bookmark current TL and position"},r.a.createElement(b.a,{onClick:function(e){return d("bookmark")}},r.a.createElement(fe.a,null))),r.a.createElement(Ae,{menuState:u,setMenuState:d,anchorElRef:c,tracklist:t})))};Ne=Object(o.b)((function(e){return{playlists:e.library.playlists}}))(Ne);var je=function(e){var t=e.tracklist,n=e.current_tlid,a=e.dispatch,i=e.mopidy;return r.a.createElement(E.a,{style:{display:"flex",flexDirection:"column",height:"100%",paddingLeft:"5px",marginLeft:"5px"}},r.a.createElement(Ne,{tracklist:t,mopidy:i}),r.a.createElement(Re,{tracklist:t,current_tlid:n,dispatch:a,mopidy:i,style:{overflow:"auto",height:"100%",maxHeight:"100%"}}))},Te=je=Object(o.b)((function(e){return{tracklist:e.tracklist,current_tlid:e.playback_state.tltrack?e.playback_state.tltrack.tlid:null}}))(je),De=n(105),Pe=n(53),Ye=n(111),Be=n.n(Ye),Me=n(110),Ke=n.n(Me),Ue=n(106),Fe=n(15),ze=n.n(Fe),qe=n(25),He=function(e){return"track"===e.type||"Track"===e.__model__},We=function(e,t,n){if(!He(e)&&(t({type:"LIBRARY_TOGGLE_EXPANDED",target:e.path}),!(e.children&&e.children.length>0)))switch(e.type){case"playlists_root":n.playlists.asList().then((function(n){return t({type:"LIBRARY_SET_CHILDREN",target:e.path,fun:function(){return n}})}));break;case"playlist":n.playlists.getItems({uri:e.uri}).then((function(n){return t({type:"LIBRARY_SET_CHILDREN",target:e.path,fun:function(){return n||[]}})}));break;case"search_results_root":case"search_result":break;default:n.library.browse({uri:e.uri}).then((function(n){return t({type:"LIBRARY_UPDATE_CHILDREN",target:e.path,fun:function(){return n},data:n})}))}},Je=function(){var e=Object(qe.a)(ze.a.mark((function e(t,n){var a;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Promise.all(t.map(function(){var e=Object(qe.a)(ze.a.mark((function e(t){var a,r;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!He(t)){e.next=4;break}return e.abrupt("return",t.uri);case 4:e.t0=t.type,e.next="playlist"===e.t0?7:"search_result"===e.t0?15:16;break;case 7:if(t.children){e.next=14;break}return e.next=10,n.playlists.getItems({uri:t.uri});case 10:return a=e.sent,e.abrupt("return",a.map((function(e){return e.uri})));case 14:case 15:return e.abrupt("return",t.children.map((function(e){return e.uri})));case 16:return e.next=18,n.library.browse({uri:t.uri});case 18:return 0===(r=e.sent).length&&t.children&&(r=t.children),e.next=22,Je(r,n);case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return a=e.sent,e.abrupt("return",a.flat());case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ve=function(){var e=Object(qe.a)(ze.a.mark((function e(t,n){var a,r;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!He(t)){e.next=2;break}return e.abrupt("return",[t.uri]);case 2:return e.next=4,Je([t],n);case 4:return a=e.sent,r=a.filter((function(e){return null!==e})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ge=function(){var e=Object(qe.a)(ze.a.mark((function e(t,n,a){var r,i;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve(t,a);case 2:return r=e.sent,e.next=5,a.tracklist.add({uris:r,at_position:n});case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),Xe=n(32),$e=n(73),Qe=n.n($e),Ze=n(52),et=n.n(Ze),tt=n(75),nt=n.n(tt),at=n(66),rt=n.n(at),it=function(e){var t=e.node,n=Object(Xe.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy,c=a.dispatch;return r.a.createElement(ye.a,{title:"Play now !"},r.a.createElement(b.a,Object.assign({},n,{onClick:function(){c({type:"TRACKLIST_UNSYNC"}),i.tracklist.clear(),Ge(t,0,i).then((function(e){if(t.current_track_index){var n=e[t.current_track_index].tlid;console.log("CURRENT",e,t.current_track_index,n),i.playback.play({tlid:n})}else i.playback.play()}))}}),r.a.createElement(et.a,null)))},ct=function(e){var t=e.node,n=Object(Xe.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy;a.dispatch;return r.a.createElement(ye.a,{title:"Add to tracklist"},r.a.createElement(b.a,Object.assign({},n,{onClick:Object(qe.a)(ze.a.mark((function e(){var n;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve(t,i);case 2:n=e.sent,console.log("Add",n),i.tracklist.add({uris:n});case 5:case"end":return e.stop()}}),e)})))}),r.a.createElement(Qe.a,null)))},ot=function(e){var t=e.node,n=Object(Xe.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy,c=a.dispatch;return r.a.createElement(ye.a,{title:"Play synced"},r.a.createElement(b.a,Object.assign({},n,{onClick:function(){i.tracklist.clear(),c({type:"TRACKLIST_SYNC",data:t.uri}),Ge(t,0,i).then((function(){return i.playback.play()}))}}),r.a.createElement(et.a,null)))},lt=function(e){var t=e.node,n=Object(Xe.a)(e,["node"]),a=r.a.useContext(f),i=(a.mopidy,a.dispatch);return r.a.createElement(ye.a,{title:"Delete tracklist "+t.name},r.a.createElement(b.a,Object.assign({onClick:function(){i({type:"TRACKLIST_DELETE",data:t.uri})}},n),r.a.createElement(rt.a,null)))},st=function(e){var t=e.node,n=Object(Xe.a)(e,["node"]),a=r.a.useContext(f),i=(a.mopidy,a.dispatch);return r.a.createElement(ye.a,{title:"Delete bookmark "+t.name},r.a.createElement(b.a,Object.assign({onClick:function(){i({type:"BOOKMARK_DELETE",target:t.uri})}},n),r.a.createElement(rt.a,null)))},ut=function(e){var t=e.node,n=Object(Xe.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy,c=a.dispatch;return r.a.createElement(ye.a,{title:"Delete playlist "+t.name},r.a.createElement(b.a,Object.assign({onClick:function(){i.playlists.delete({uri:t.uri}),i.playlists.asList().then((function(e){return c({type:"LIBRARY_UPDATE_CHILDREN",target:["playlist:"],data:e})}))}},n),r.a.createElement(rt.a,null)))},dt=function(e){var t=e.node;return r.a.createElement(be.a,null,r.a.createElement(g.a,{size:"small"},r.a.createElement(it,{node:t}),r.a.createElement(ct,{node:t})))},pt=function(e){var t=e.node;return r.a.createElement(be.a,null,r.a.createElement(g.a,{size:"small"},r.a.createElement(ot,{node:t}),r.a.createElement(ct,{node:t}),r.a.createElement(lt,{node:t})))},mt=function(e){var t=e.node;return r.a.createElement(be.a,null,r.a.createElement(g.a,{size:"small"},r.a.createElement(it,{node:t}),r.a.createElement(ct,{node:t}),r.a.createElement(st,{node:t})))},ft=function(e){var t=e.node;return r.a.createElement(be.a,null,r.a.createElement(g.a,{size:"small"},r.a.createElement(it,{node:t}),r.a.createElement(ct,{node:t}),r.a.createElement(ut,{node:t})))},yt=function(){var e=r.a.useContext(f),t=e.mopidy,n=e.dispatch,a=r.a.useState(!1),i=Object(s.a)(a,2),c=i[0],o=i[1],l=r.a.useState(""),u=Object(s.a)(l,2),d=u[0],p=u[1],m=r.a.useRef(null);return r.a.createElement(be.a,null,r.a.createElement(g.a,{size:"small"},r.a.createElement(ye.a,{title:"Create new Playlist"},r.a.createElement(b.a,{onClick:function(){o(!c)}},c?r.a.createElement(le.a,null):r.a.createElement(nt.a,null))),c&&r.a.createElement(G.a,{label:"Playlist name",variant:"outlined",size:"small",onChange:function(e){return p(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(e.key,0!==d.length&&t.playlists.create({name:d,uri_scheme:"m3u"}).then((function(){t.playlists.asList().then((function(e){return n({type:"LIBRARY_UPDATE_CHILDREN",target:["playlist:"],data:e})}))})),o(!1))},autoFocus:!0,ref:m})))};function ht(){var e=Object(De.a)(["\n   width: 8px;\n   flex-shrink: 0;\n   opacity: 0.25;\n\n   &:hover {\n      opacity: 0.5;\n   }\n"]);return ht=function(){return e},e}var Et=Ue.a.div(ht()),gt=function(e){var t=e.callback;return r.a.createElement(Et,{onClick:t},r.a.createElement("div",{style:{width:0,height:0,borderBottom:"8px solid rgba(63, 81, 181, 0.5)",borderLeft:"8px solid transparent"}}),r.a.createElement("div",{style:{backgroundColor:"rgba(63, 81, 181, 0.5)",height:"calc(100% - 16px)"}}),r.a.createElement("div",{style:{width:0,height:0,borderTop:"8px solid rgba(63, 81, 181, 0.5)",borderLeft:"8px solid transparent"}}))},bt=function e(t){var n=t.node,a=t.dispatch,i=t.depth,c=t.typography;c=c||"body1";var o=r.a.useContext(f).mopidy;if(!n)return null;return r.a.createElement("li",{style:{paddingTop:0,paddingBottom:0,display:"flex",flexDirection:"column",paddingLeft:"10px",marginLeft:0,marginRight:"auto",textAlign:"left"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},r.a.createElement(ke.a,{onClick:function(){return We(n,a,o)}},r.a.createElement(Pe.a,{variant:c},n.name,function(e){return He(e)?"":void 0===e.children?"(?)":"(".concat(e.children.length,")")}(n),function(e){return He(e)?"":e.expanded?r.a.createElement(Ke.a,{style:{verticalAlign:"text-bottom"}}):r.a.createElement(Be.a,{style:{verticalAlign:"text-bottom"}})}(n))),function(e,t){return"playlists_root"===e.type?r.a.createElement(yt,null):e.path&&1==e.path.length?null:"tracklist"===e.type?r.a.createElement(pt,{node:e}):"bookmark"===e.type?r.a.createElement(mt,{node:e}):"playlist"===e.type&&e.uri.endsWith("m3u8")?r.a.createElement(ft,{node:e}):r.a.createElement(dt,{node:e})}(n)),r.a.createElement("div",null,n.expanded&&n.children&&r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(gt,{callback:function(){return We(n,a,o)}}),r.a.createElement((function(){return r.a.createElement(ne.a,{group:{name:"library",put:!1,pull:"clone"},list:n.children,setList:function(){},tag:Ee.a,onEnd:function(e){!function(e,t,n,a){"tracklist"===n.id&&Ge(e,t,a)}(n.children[e.oldIndex],e.newIndex,e.to,o)},style:{width:"100%"}},n.children.map((function(t){return r.a.createElement(e,{key:t.uri,node:t,dispatch:a,depth:i+1})})))}),null))))},kt=Object(o.b)((function(e){return{library:e.library}}))((function(e){var t=e.library,n=e.dispatch,a=[].concat(Object(_e.a)(t.mopidyLibrary),[t.playlists,t.search_results]);return t.bookmarks.children.length>0&&a.push(t.bookmarks),console.log("Library:",t,n),r.a.createElement(Ee.a,{style:{paddingLeft:"10px"}},a.map((function(e){return r.a.createElement(bt,{node:e,dispatch:n,depth:0,key:e.uri,typography:"button"})})))})),_t=Object(o.b)((function(e){return e.settings}))((function(e){var t=e.persistant,n=e.dispatch,i=Object(a.useState)(t.mopidy_ws),c=Object(s.a)(i,2),o=c[0],l=c[1],u=Object(a.useState)(t.seek_update_interval),d=Object(s.a)(u,2),p=d[0],m=d[1];return r.a.createElement("div",null,r.a.createElement("form",{noValidate:!0,autoComplete:"off"},r.a.createElement(G.a,{label:"Mopidy websocket URL",variant:"outlined",style:{margin:8,width:"80%"},InputLabelProps:{shrink:!0},value:o,onChange:function(e){return l(e.target.value)}}),r.a.createElement(G.a,{label:"Seek update interval",variant:"outlined",style:{margin:8},InputLabelProps:{shrink:!0},value:p,onChange:function(e){return m(e.target.value)}})),r.a.createElement(b.a,{onClick:function(){n({type:"COMMIT_PERSISTANT",data:{mopidy_ws:o,seek_update_interval:p}}),n({type:"CONNECT",mopidy_ws:o,dispatch:n})}},"Commit"))})),vt=n(113),Ot=n.n(vt),Ct=n(112),wt=function(){return r.a.createElement(E.a,{style:{margin:"20px 20px auto 20px"}},r.a.createElement(Pe.a,{variant:"h4",style:{marginBottom:"10px"}},"Mowecl ",Ct.a),r.a.createElement(Pe.a,null,"Made with \u2665 by Mathias Millet."),r.a.createElement("a",{href:"https://github.com/sapristi/mowecl"},r.a.createElement(Ot.a,null)),r.a.createElement("br",null),r.a.createElement(Pe.a,{variant:"caption"},"Remarks, suggestions and bug reports are welcome."))},St=function(e){var t=e.children;return r.a.createElement("div",{className:"App",style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",minHeight:"0",flex:1}},r.a.createElement(te,null),t),r.a.createElement(M,{style:{display:"flex",flex:1}}))},It=Object(o.b)((function(e){return{settings:e.settings,mopidy:e.mopidy}}))((function(e){var t=e.settings,n=e.mopidy,a=(e.dispatch,null);switch(t.active_panel){case"control":a=r.a.createElement(_t,null);break;case"help":a=r.a.createElement(wt,null);break;default:a=r.a.createElement(kt,null)}return n.connected?r.a.createElement(St,null,r.a.createElement("div",{style:{height:"100%",width:"100%",flexDirection:"row",display:"flex"}},r.a.createElement("div",{style:{width:"50%",height:"100%",overflow:"auto"}},a),r.a.createElement("div",{style:{height:"100%",width:"50%"}},r.a.createElement(Te,null)))):r.a.createElement(St,null,r.a.createElement("div",{style:{width:"50%",height:"100%",overflow:"auto"}},r.a.createElement(_t,null)),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{flex:1}}),r.a.createElement("div",{style:{flex:1}},r.a.createElement(X.a,{color:"inherit",style:{margin:"auto"}})),r.a.createElement("div",{style:{flex:1}},r.a.createElement("div",null,"Trying to reach mopidy at ",t.persistant.mopidy_ws),r.a.createElement("div",null,n.error)),r.a.createElement("div",{style:{flex:1}})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var At=n(76),xt=n(67),Lt=n(114),Rt=n(69),Nt=n(47),jt=n(68),Tt=n(145),Dt=n(146);function Pt(e){return e.replace(/(_[a-z])/g,(function(e){return e.toUpperCase().replace("_","")}))}var Yt=function(e){function t(e){var n;return Object(xt.a)(this,t),(n=Object(Rt.a)(this,Object(Nt.a)(t).call(this)))._console=n._getConsole(e||{}),n._settings=n._configure(e||{}),n._backoffDelay=n._settings.backoffDelayMin,n._pendingRequests={},n._webSocket=null,n._delegateEvents(),n._settings.autoConnect&&n.connect(),n}return Object(jt.a)(t,e),Object(Lt.a)(t,[{key:"_getConsole",value:function(e){if("undefined"!==typeof e.console)return e.console;var t="undefined"!==typeof console&&console||{};return t.log=t.log||function(){},t.warn=t.warn||function(){},t.error=t.error||function(){},t}},{key:"_configure",value:function(e){var t=Object(h.a)({},e),n="undefined"!==typeof document&&"https:"===document.location.protocol?"wss://":"ws://",a="undefined"!==typeof document&&document.location.host||"localhost";return t.webSocketUrl=e.webSocketUrl||"".concat(n).concat(a,"/mopidy/ws"),!1!==e.autoConnect&&(t.autoConnect=!0),t.backoffDelayMin=e.backoffDelayMin||1e3,t.backoffDelayMax=e.backoffDelayMax||64e3,t}},{key:"_delegateEvents",value:function(){this.removeAllListeners("websocket:close"),this.removeAllListeners("websocket:error"),this.removeAllListeners("websocket:incomingMessage"),this.removeAllListeners("websocket:open"),this.removeAllListeners("state:offline"),this.on("websocket:close",this._cleanup),this.on("websocket:error",this._handleWebSocketError),this.on("websocket:incomingMessage",this._handleMessage),this.on("websocket:open",this._resetBackoffDelay),this.on("websocket:open",this._getApiSpec),this.on("state:offline",this._reconnect)}},{key:"off",value:function(){if(0===arguments.length)this.removeAllListeners();else if(1===arguments.length){var e=arguments.length<=0?void 0:arguments[0];if("string"!==typeof e)throw Error("Expected no arguments, a string, or a string and a listener.");this.removeAllListeners(e)}else this.removeListener.apply(this,arguments)}},{key:"connect",value:function(){var e=this;if(this._webSocket){if(this._webSocket.readyState===t.WebSocket.OPEN)return;this._webSocket.close()}this._webSocket=this._settings.webSocket||new t.WebSocket(this._settings.webSocketUrl),this._webSocket.onclose=function(t){e.emit("websocket:close",t)},this._webSocket.onerror=function(t){e.emit("websocket:error",t)},this._webSocket.onopen=function(){e.emit("websocket:open")},this._webSocket.onmessage=function(t){e.emit("websocket:incomingMessage",t),e.emit("requests:count",Object.keys(e._pendingRequests).length)}}},{key:"_cleanup",value:function(e){var n=this;Object.keys(this._pendingRequests).forEach((function(a){var r=n._pendingRequests[a].reject;delete n._pendingRequests[a];var i=new t.ConnectionError("WebSocket closed");i.closeEvent=e,r(i)})),this.emit("state","state:offline"),this.emit("state:offline")}},{key:"_reconnect",value:function(){var e=this;this.emit("state","reconnectionPending",{timeToAttempt:this._backoffDelay}),this.emit("reconnectionPending",{timeToAttempt:this._backoffDelay}),setTimeout((function(){e.emit("state","reconnecting"),e.emit("reconnecting"),e.connect()}),this._backoffDelay),this._backoffDelay=2*this._backoffDelay,this._backoffDelay>this._settings.backoffDelayMax&&(this._backoffDelay=this._settings.backoffDelayMax)}},{key:"_resetBackoffDelay",value:function(){this._backoffDelay=this._settings.backoffDelayMin}},{key:"close",value:function(){this.off("state:offline",this._reconnect),this._webSocket&&this._webSocket.close()}},{key:"_handleWebSocketError",value:function(e){this._console.warn("WebSocket error:",e.stack||e)}},{key:"_send",value:function(e){var n=this;switch(this._webSocket.readyState){case t.WebSocket.CONNECTING:return Promise.reject(new t.ConnectionError("WebSocket is still connecting"));case t.WebSocket.CLOSING:return Promise.reject(new t.ConnectionError("WebSocket is closing"));case t.WebSocket.CLOSED:return Promise.reject(new t.ConnectionError("WebSocket is closed"));default:return new Promise((function(t,a){var r=Object(h.a)({},e,{jsonrpc:"2.0",id:n._nextRequestId()});n._pendingRequests[r.id]={resolve:t,reject:a},n._webSocket.send(JSON.stringify(r)),n.emit("websocket:outgoingMessage",r),n.emit("requests:count",Object.keys(n._pendingRequests).length)}))}}},{key:"_handleMessage",value:function(e){try{var t=JSON.parse(e.data);Object.hasOwnProperty.call(t,"id")?this._handleResponse(t):Object.hasOwnProperty.call(t,"event")?this._handleEvent(t):this._console.warn("Unknown message type received. Message was: ".concat(e.data))}catch(n){if(!(n instanceof SyntaxError))throw n;this._console.warn("WebSocket message parsing failed. Message was: ".concat(e.data))}}},{key:"_handleResponse",value:function(e){if(Object.hasOwnProperty.call(this._pendingRequests,e.id)){var n=this._pendingRequests[e.id],a=n.resolve,r=n.reject;if(delete this._pendingRequests[e.id],Object.hasOwnProperty.call(e,"result"))a(e.result);else if(Object.hasOwnProperty.call(e,"error")){var i=new t.ServerError(e.error.message);i.code=e.error.code,i.data=e.error.data,r(i),this._console.warn("Server returned error:",e.error)}else{var c=new Error("Response without 'result' or 'error' received");c.data={response:e},r(c),this._console.warn("Response without 'result' or 'error' received. Message was:",e)}}else this._console.warn("Unexpected response received. Message was:",e)}},{key:"_handleEvent",value:function(e){var t=Object(h.a)({},e);delete t.event;var n="event:".concat(Pt(e.event));this.emit("event",n,t),this.emit(n,t)}},{key:"_getApiSpec",value:function(){return this._send({method:"core.describe"}).then(this._createApi.bind(this)).catch(this._handleWebSocketError.bind(this))}},{key:"_createApi",value:function(e){var t=this;Object.keys(e).forEach((function(n){var a,r=function(e){var t=e.split(".");return t.length>=1&&"core"===t[0]&&(t=t.slice(1)),t}(n),i=Pt(r.slice(-1)[0]),c=function(e){var n=t;return e.forEach((function(e){var t=Pt(e);n[t]=n[t]||{},n=n[t]})),n}(r.slice(0,-1));c[i]=(a=n,function(){for(var e={method:a},n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return 0===r.length?t._send(e):r.length>1?Promise.reject(new Error("Expected zero arguments, a single array, or a single object.")):Array.isArray(r[0])||r[0]===Object(r[0])?(e.params=r[0],t._send(e)):Promise.reject(new TypeError("Expected an array or an object."))}),c[i].description=e[n].description,c[i].params=e[n].params})),this.emit("state","state:online"),this.emit("state:online")}}]),t}(Tt),Bt=function(e){function t(e){var n;return Object(xt.a)(this,t),(n=Object(Rt.a)(this,Object(Nt.a)(t).call(this,e))).name="ConnectionError",n}return Object(jt.a)(t,e),t}(Object(At.a)(Error));Yt.ConnectionError=Bt;var Mt=function(e){function t(e){var n;return Object(xt.a)(this,t),(n=Object(Rt.a)(this,Object(Nt.a)(t).call(this,e))).name="ServerError",n}return Object(jt.a)(t,e),t}(Object(At.a)(Error));Yt.ServerError=Mt,Yt.WebSocket=Dt,Yt.prototype._nextRequestId=function(){var e=-1;return function(){return e+=1}}();var Kt=Yt,Ut=(n(87),function(){var e=Object(qe.a)(ze.a.mark((function e(t,n){var a;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[{fun_path:["playback","getCurrentTlTrack"],base:{type:"PLAYBACK_INFO",target:"tltrack"}},{fun_path:["playback","getState"],base:{type:"PLAYBACK_INFO",target:"state"}},{fun_path:["playback","getTimePosition"],base:{type:"PLAYBACK_INFO",target:"time_position"}}],e.next=3,Promise.all(a.map(function(){var e=Object(qe.a)(ze.a.mark((function e(a){var r,i,c,o;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.fun_path,i=a.base,r.reduce((function(e,t){return e[t]}),n),c=r.reduce(d,n),e.next=5,c();case 5:o=e.sent,t(Object.assign({},i,{data:o}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Ft=function(e,t,n){t.on("requests:count",(function(e){n({type:"MOPIDY_PENDING_REQUESTS_COUNT",data:e})})),t.on("state:online",Object(qe.a)(ze.a.mark((function e(){return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"MOPIDY_CLIENT_CONNECTED"}),t.tracklist.getTlTracks().then(function(){var e=Object(qe.a)(ze.a.mark((function e(a){var r,i,c,o,l;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"TRACKLIST_INITIALISE",data:a}),e.next=3,t.playlists.asList();case 3:if(r=e.sent,n({type:"LIBRARY_SET_CHILDREN",target:["playlist:"],fun:function(){return r}}),i=JSON.parse(localStorage.getItem("bookmarks")),console.log("BOOKMARKS",i),i&&n({type:"LIBRARY_SET_CHILDREN",target:["bookmark:"],fun:function(){return i.children}}),c=JSON.parse(localStorage.getItem("synced"))){e.next=11;break}return e.abrupt("return");case 11:if(o=r.find((function(e){return e.uri===c.uri}))){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,t.playlists.getItems({uri:o.uri});case 16:l=e.sent,y(c.children,a.map((function(e){return e.track.uri})))&&y(c.children,l.map((function(e){return e.uri})))&&n({type:"PLAYLIST_SYNC",data:c});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.mixer.getVolume().then((function(e){return n({type:"PLAYBACK_INFO",target:"volume",data:e})})),t.library.browse({uri:null}).then((function(e){return n({type:"MOPIDY_LIBRARY_INITIALISE",data:e})})),t.getUriSchemes().then((function(e){return n({type:"URI_SCHEMES",data:e})})),Ut(n,t);case 6:case"end":return e.stop()}}),e)})))),t.on("state:offline",(function(){return n({type:"MOPIDY_CLIENT_DISCONNECTED"})})),t.on("event:trackPlaybackResumed",(function(e){n({type:"PLAYBACK_INFO",target:"state",data:"playing"}),n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position})})),t.on("event:trackPlaybackPaused",(function(e){n({type:"PLAYBACK_INFO",target:"state",data:"paused"}),n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position}),n({type:"INCR_PLAYBACK_RESET"})})),t.on("event:seeked",(function(e){n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position})})),t.on("event:trackPlaybackStarted",(function(e){n({type:"PLAYBACK_INFO",target:"track",data:e.track})})),t.on("event:trackPlaybackEnded",(function(e){n({type:"PLAYBACK_INFO",target:"state",data:"stopped"}),n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position})})),t.on("event:trackPlaybackStarted",(function(e){n({type:"INCR_PLAYBACK_RESET"}),n({type:"PLAYBACK_INFO",target:"state",data:"playing"}),n({type:"PLAYBACK_INFO",target:"time_position",data:0}),n({type:"PLAYBACK_INFO",target:"tltrack",data:e.tl_track})})),t.on("event:tracklistChanged",(function(){t.tracklist.getTlTracks().then((function(e){return n({type:"TRACKLIST_INITIALISE",data:e})})),Ut(n,t)})),t.on("event:volumeChanged",(function(e){n({type:"PLAYBACK_INFO",target:"volume",data:e.volume})}))},zt=function(e,t,n){return function e(t,n,a,r){if(n[0]===t.uri){if(1===n.length){var i=t.children||[],c=r(i).map((function(e){return Object(h.a)({},e,{path:[].concat(Object(_e.a)(a),[e.uri])})}));return Object(h.a)({},t,{children:c})}return Object(h.a)({},t,{children:t.children.map((function(t){return e(t,n.slice(1),a,r)}))})}return t}(e,t,t,n)},qt=function e(t,n,a){return n[0]===t.uri?1===n.length?Object(h.a)({},t,{expanded:a(t.expanded)}):void 0===t.children?t:Object(h.a)({},t,{children:t.children.map((function(t){return e(t,n.slice(1),a)}))}):t},Ht=function(e,t,n){return zt(e,t,(function(e){return e?n.map((function(t){var n=e.find((function(e){return e.uri===t.uri}));return n?Object(h.a)({},t,{children:n.children}):t})):n}))},Wt=function(e,t){switch(t.type){case"LIBRARY_SET_CHILDREN":return zt(e,t.target,t.fun);case"LIBRARY_UPDATE_CHILDREN":return Ht(e,t.target,t.data);case"LIBRARY_TOGGLE_EXPANDED":return qt(e,t.target,(function(e){return!e}));case"LIBRARY_SET_EXPANDED":return qt(e,t.target,(function(){return t.data}));default:return e}},Jt=Object(l.b)({mopidyLibrary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOPIDY_LIBRARY_INITIALISE":return t.data.map((function(e){return Object(h.a)({},e,{path:[e.uri]})}));case"LIBRARY_SET_CHILDREN":return e.map((function(e){return zt(e,t.target,t.fun)}));case"LIBRARY_UPDATE_CHILDREN":return e.map((function(e){return Ht(e,t.target,t.data)}));case"LIBRARY_TOGGLE_EXPANDED":return e.map((function(e){return qt(e,t.target,(function(e){return!e}))}));case"LIBRARY_SET_EXPANDED":return e.map((function(e){return qt(e,t.target,(function(){return t.data}))}));default:return e}},playlists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Playlists",uri:"playlist:",type:"playlists_root",path:["playlist:"],synced:null},t=arguments.length>1?arguments[1]:void 0;switch(e=Wt(e,t),t.type){case"PLAYLIST_UNSYNC":return e=Object(h.a)({},e,{synced:null}),localStorage.setItem("synced",JSON.stringify(null)),e;case"PLAYLIST_SYNC":return e=Object(h.a)({},e,{synced:t.data}),localStorage.setItem("synced",JSON.stringify(t.data)),e;case"PLAYLIST_SYNCED_UPDATE":if(!e.synced)return e;default:return e}},search_results:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Search results",uri:"search:",type:"search_results_root",path:["search:"],children:[]},t=arguments.length>1?arguments[1]:void 0;return Wt(e,t)},bookmarks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Bookmarks",uri:"bookmark:",type:"bookmarks_root",path:["bookmark:"],children:[]},t=arguments.length>1?arguments[1]:void 0;switch(e=Wt(e,t),t.type){case"BOOKMARK_SAVE":return localStorage.setItem("bookmarks",JSON.stringify(e)),e;case"BOOKMARK_DELETE":return e=Object(h.a)({},e,{children:e.children.filter((function(e){return e.uri!==t.target}))}),console.log("DEL",e.children,t.target),localStorage.setItem("bookmarks",JSON.stringify(e)),e;default:return e}}}),Vt={tltrack:{track:null,tlid:null},state:null,time_position:null,updating:!1,time_position_updater:{pending:!1,last_update:null},volume:null},Gt={active_panel:"library",persistant:JSON.parse(localStorage.getItem("settings"))||{mopidy_ws:function(){var e="https:"===window.location.protocol?"wss":"ws",t=window.location.hostname;return"".concat(e,"://").concat(t,":").concat(6680,"/mopidy/ws")}(),seek_update_interval:1e3}},Xt=function(e){var t=e.mopidy,n=e.settings,a=e.dispatch;return t.connected||t.connecting||t.error||a({type:"CONNECT",mopidy_ws:n.persistant.mopidy_ws,dispatch:a}),r.a.createElement(f.Provider,{value:{mopidy:t.mopidy,dispatch:a}},r.a.createElement(It,null))};Xt=Object(o.b)((function(e){return{mopidy:e.mopidy,settings:e.settings}}))(Xt);var $t=Object(l.c)(Object(l.b)({playback_state:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PLAYBACK_INFO":var n={};n[t.target]=t.data,"tltrack"!==t.target||t.data||(n[t.target]={track:null,tlid:null});var a=Object.assign({},e,n);return"time_position"===t.target&&(a.time_position_updater.last_update=(new Date).valueOf()),a;case"INCR_PLAYBACK_START":var r=Object.assign({},e.time_position_updater,{pending:!0});return Object.assign({},e,{time_position_updater:r});case"INCR_PLAYBACK":var i=(new Date).valueOf(),c=i-e.time_position_updater.last_update;return"playing"!==e.state?e:Object(h.a)({},e,{time_position:e.time_position+c,time_position_updater:{pending:!1,last_update:i}});case"INCR_PLAYBACK_RESET":return Object(h.a)({},e,{time_position_updater:{pending:!1,last_update:null}});case"PLAYBACK_UPDATING":return Object(h.a)({},e,{updating:t.data});default:return e}},tracklist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TRACKLIST_INITIALISE":return t.data;default:return e}},library:Jt,settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ACTIVATE_PANEL":return Object(h.a)({},e,{active_panel:t.target});case"COMMIT_PERSISTANT":return localStorage.setItem("settings",JSON.stringify(t.data)),Object(h.a)({},e,{persistant:t.data});default:return e}},mopidy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{connected:!1,connecting:!1,mopidy:null,uri_schemes:[],pendingRequestsNb:0,error:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOPIDY_CLIENT_CONNECTED":return Object(h.a)({},e,{connected:!0,connecting:!1});case"MOPIDY_CLIENT_DISCONNECTED":return Object(h.a)({},e,{connected:!1,connecting:!0});case"MOPIDY_PENDING_REQUESTS_COUNT":return Object(h.a)({},e,{pendingRequestsNb:t.data});case"CONNECT":if(!t.dispatch||!t.mopidy_ws){var n="dispatch and mopidy_host must be passed at CONNECT";return console.log("ERROR: "+n),Object(h.a)({},e,{error:n,connecting:!0})}var a=t.mopidy_ws;console.log("webSocketUrl:",a),e.mopidy&&(e.mopidy.removeAllListeners(),e.mopidy.close(),e.mopidy.off());var r=new Kt({webSocketUrl:a,autoConnect:!1});try{r.connect()}catch(n){return console.log("Error when initializing mopidy",n),r.removeAllListeners(),r.close(),r.off(),Ft(0,r,t.dispatch),Object(h.a)({},e,{error:n.toString(),mopidy:r,connecting:!1})}return r.on("event",console.log),window.$mopidy=r,Ft(0,r,t.dispatch),Object(h.a)({},e,{connecting:!0,mopidy:r,connected:!1,error:null});case"URI_SCHEMES":return Object(h.a)({},e,{uri_schemes:t.data});default:return e}}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());window.$store=$t,c.a.render(r.a.createElement(o.a,{store:$t,style:{height:"100%"}},r.a.createElement(Xt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[130,1,2]]]);
//# sourceMappingURL=main.c6a85c7d.chunk.js.map