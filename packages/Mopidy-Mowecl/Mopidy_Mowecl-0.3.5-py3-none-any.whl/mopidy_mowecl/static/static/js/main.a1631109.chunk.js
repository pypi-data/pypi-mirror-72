(this.webpackJsonpmopidy_webui=this.webpackJsonpmopidy_webui||[]).push([[0],{135:function(e,t,n){e.exports=n(152)},144:function(e,t,n){},146:function(e,t,n){},152:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(11),c=n.n(i),o=n(16),l=n(34),s=(n(144),n(145),n(12)),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"??";if(void 0===e||null===e)return t;var n=Math.ceil(e/1e3),a=n%60,r=(n-a)/60,i=a<10?"0"+a:""+a;return"".concat(r,":").concat(i)},d=function(e,t){return e[t]},p={spotify:"Spotify",spotifytunigo:"Spotify browse",spotifyweb:"Spotify browse",local:"Local media",m3u:"Local playlists",podcast:"Podcasts","podcast+itunes":"iTunes Store: Podcasts",dirble:"Dirble",tunein:"TuneIn",soundcloud:"SoundCloud",gmusic:"Google Music",internetarchive:"Internet Archive",somafm:"Soma FM",youtube:"YouTube",audioaddict:"AudioAddict",subsonic:"Subsonic"},m=["file","http","https","mms","rtmp","rtmps","rtsp","yt"],f=r.a.createContext(null),h=function(e,t){return e.map((function(e,n){return[e,t[n]]})).every((function(e){var t=Object(s.a)(e,2);return t[0]===t[1]}))};n(146);var y=n(182),E=n(177),b=n(153),g=n(94),_=n.n(g),v=n(96),k=n.n(v),O=n(62),w=n.n(O),C=n(95),S=n.n(C),I=n(120),A=function(e){var t=e.state,n=r.a.useContext(f).mopidy;return Object(I.a)("space",(function(){"playing"===t?n&&n.playback.pause():n&&n.playback.play()}),{},[t,n]),r.a.createElement(E.a,null,r.a.createElement(b.a,{onClick:function(){return n.playback.previous()}},r.a.createElement(_.a,{fontSize:"large"})),"playing"===t?r.a.createElement(b.a,{onClick:function(){return n.playback.pause()}},r.a.createElement(S.a,{fontSize:"large"})):r.a.createElement(b.a,{onClick:function(){return n.playback.play()}},r.a.createElement(w.a,{fontSize:"large"})),r.a.createElement(b.a,{onClick:function(){return n.playback.next()}},r.a.createElement(k.a,{fontSize:"large"})))},x=n(6),j=n(201),L=n(181),R=function(e){var t=e.state,n=e.time_position,a=e.time_position_updater,i=e.seek_update_interval,c=e.dispatch;return r.a.useEffect((function(){"playing"!==t||"number"!==typeof n||a.pending||(c({type:"INCR_PLAYBACK_START"}),setTimeout((function(){return c({type:"INCR_PLAYBACK"})}),parseInt(i)))})),null};R=Object(o.b)((function(e){return Object(x.a)({},e.playback_state,{seek_update_interval:e.settings.persistant.seek_update_interval.current})}))(R);var N=function(e){var t=e.time_position,n=e.track_length,a=e.dispatch,i=r.a.useContext(f).mopidy,c=Math.ceil(t/n*300);return n?r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement(R,null),r.a.createElement("div",{style:{width:"40px"}},u(t)),r.a.createElement(j.a,{value:c,onChange:function(e,t){a({type:"PLAYBACK_INFO",target:"time_position",data:t*n/300})},onChangeCommitted:function(e,t){i.playback.seek({time_position:Math.ceil(t*n/300)})},max:300,valueLabelDisplay:"auto",valueLabelFormat:function(e){return u(e*n/300)},style:{flex:1,marginRight:"5%",marginLeft:"5%"}}),r.a.createElement("div",null,u(n))):r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement("div",null,u(t)),r.a.createElement(L.a,{style:{flex:1,marginRight:"5%",marginLeft:"5%"}}))},T=N=Object(o.b)((function(e){return{time_position:e.playback_state.time_position}}))(N),D=n(97),P=n.n(D),Y=n(98),B=n.n(Y),M=function(e){var t=e.volume,n=e.dispatch,a=e.style,i=r.a.useContext(f).mopidy;return r.a.createElement("div",{style:Object(x.a)({display:"flex",flexDirection:"row",alignItems:"center"},a)},r.a.createElement("div",{onClick:function(){return i.mixer.setVolume({volume:t-1})}},r.a.createElement(P.a,null)),r.a.createElement("div",{style:{flex:1,marginLeft:"5%",marginRight:"5%"}},r.a.createElement(j.a,{value:t,onChange:function(e,t){n({type:"PLAYBACK_INFO",target:"volume",data:t})},onChangeCommitted:function(e,t){i.mixer.setVolume({volume:t})},valueLabelDisplay:"auto"})),r.a.createElement("div",{onClick:function(){return i.mixer.setVolume({volume:t+1})}},r.a.createElement(B.a,null)))},K=function(e){var t=e.track;if(!t)return"...";var n=t.name?r.a.createElement("div",null,t.name):null,a=t.album?r.a.createElement("div",null,t.album.name):null,i=t.artists?r.a.createElement("div",null,t.artists[0].name):null;return t.album,r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},n,a,i)},U=function(e){var t=e.tltrack,n=e.state,a=e.volume,i=e.dispatch;return r.a.createElement(y.a,{elevation:3,style:{width:"80%",margin:"auto",display:"flex",flexDirection:"row",padding:"5px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement(A,{state:n}),r.a.createElement(M,{volume:a,dispatch:i,style:{marginTop:"auto",marginBottom:"auto"}})),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1,paddingLeft:"5%",paddingRight:"5%"}},"stopped"!==n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(K,{track:t.track}),r.a.createElement(T,{track_length:t.track?t.track.length:null})),r.a.createElement("div",null)))},F=U=Object(o.b)((function(e){return{tltrack:e.playback_state.tltrack,state:e.playback_state.state,volume:e.playback_state.volume}}))(U),H=n(15),z=n.n(H),W=n(21),q=n(30),G=n(103),J=n.n(G),V=n(102),X=n.n(V),Q=n(100),$=n.n(Q),Z=n(68),ee=n.n(Z),te=n(104),ne=n.n(te),ae=n(101),re=n.n(ae),ie=n(196),ce=n(197),oe=n(199),le=n(188),se=n(185),ue=n(195),de=n(64),pe=function(e){var t=e.mopidy,n=e.searchUris,a=e.dispatch,i=e.closePopover,c=e.search_history_length,o=localStorage.getItem("searchSelectedURI")||"all",l=r.a.useState(o),u=Object(s.a)(l,2),d=u[0],p=u[1],m=r.a.useState((function(){return""})),f=Object(s.a)(m,2),h=f[0],y=f[1],E=function(e){if("Enter"===e&&0!==h.length){var n="all"===d?{}:{uris:[d+":"]};t.library.search(Object(x.a)({query:{any:[h]}},n)).then((function(e){var t=e.map((function(e){return Object(x.a)({},e,{name:e.uri,children:e.tracks,type:"search_result",expanded:!0})}));if(a({type:"LIBRARY_SET_CHILDREN",fun:function(){return t},target:["search:"]}),a({type:"LIBRARY_SET_EXPANDED",target:["search:"],data:!0}),!(c<=0)){var n=h+"/"+d;a({type:"LIBRARY_SET_CHILDREN",fun:function(e){return[{name:n,uri:n}].concat(Object(q.a)(e)).slice(0,c)},target:["search_history:"]}),a({type:"LIBRARY_SET_CHILDREN",fun:function(){return t},target:["search_history:",n]})}})),i()}};return r.a.createElement("div",null,r.a.createElement(ce.a,{id:"search-popover-textinput",variant:"outlined",value:h,onChange:function(e){return y(e.target.value)},onKeyPress:function(e){return E(e.key)},autoFocus:!0}),r.a.createElement(se.a,{variant:"outlined"},r.a.createElement(ue.a,{native:!0,value:d,onChange:function(e){localStorage.setItem("searchSelectedURI",e.target.value),p(e.target.value)},onKeyPress:function(e){return E(e.key)}},r.a.createElement("option",{value:"all"},"All"),n.map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return r.a.createElement("option",{value:n,key:n},a)})))))},me=function(e){var t=e.pendingRequestsNb,n={marginTop:"15px",marginBottom:"10px"};return e.connected?0===t?r.a.createElement("div",null,r.a.createElement(le.a,{size:30,thickness:5,style:n,variant:"determinate",value:100})):r.a.createElement("div",null,r.a.createElement(le.a,{size:30,thickness:5,style:n})):r.a.createElement("div",null,r.a.createElement(le.a,{size:30,thickness:5,style:n,color:"secondary"}))},fe=Object(o.b)((function(e){return Object(x.a)({},e.mopidy,{search_history_length:e.settings.persistant.search_history_length.current})}))((function(e){var t=e.dispatch,n=e.mopidy,a=e.uri_schemes,i=e.pendingRequestsNb,c=e.connected,o=e.search_history_length,l=r.a.useRef(null),u=r.a.useState(!1),d=Object(s.a)(u,2),f=d[0],h=d[1],g=r.a.useState((function(){return null})),_=Object(s.a)(g,2),v=_[0],k=_[1];v||fetch("https://pypi.org/pypi/Mopidy-Mowecl/json").then((function(e){return e.json().then((function(e){return k(e.info.version)}))}));var O=a.filter((function(e){return!m.includes(e)})).map((function(e){return[e,p[e]||e]})),w=function(e){return function(){return t({type:"ACTIVATE_PANEL",target:e})}},C=function(){var e=Object(W.a)(z.a.mark((function e(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.library.refresh(),n.playlists.refresh()]);case 2:n.library.browse({uri:null}).then((function(e){return t({type:"MOPIDY_LIBRARY_INITIALISE",data:e})})),n.playlists.asList().then((function(e){return t({type:"LIBRARY_SET_CHILDREN",target:["playlist:"],fun:function(){return e}})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(y.a,{elevation:3,style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},r.a.createElement(E.a,{orientation:"vertical"},r.a.createElement(me,{pendingRequestsNb:i,connected:c}),r.a.createElement(oe.a,{title:"Quick search"},r.a.createElement(b.a,{ref:l,id:"popover-search-button",onClick:function(){return h(!0)}},r.a.createElement($.a,null))),r.a.createElement((function(){return r.a.createElement(ie.a,{open:f,anchorEl:l.current,onClose:function(){return h(!1)},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"}},r.a.createElement(pe,{searchUris:O,mopidy:n,dispatch:t,closePopover:function(){return h(!1)},search_history_length:o}))}),null),r.a.createElement(oe.a,{title:"Refresh lib and playlists"},r.a.createElement(b.a,{onClick:C},r.a.createElement(re.a,null)))),r.a.createElement(E.a,{orientation:"vertical"},r.a.createElement(oe.a,{title:"Library panel"},r.a.createElement(b.a,{onClick:w("library")},r.a.createElement(X.a,null))),r.a.createElement(oe.a,{title:"Settings panel"},r.a.createElement(b.a,{style:{height:"auto"},onClick:w("control")},r.a.createElement(J.a,null)))),r.a.createElement(E.a,{orientation:"vertical"},de.a!=v&&r.a.createElement(oe.a,{title:"Version ".concat(v," available on Pypi.")},r.a.createElement(b.a,null,r.a.createElement(ne.a,null))),r.a.createElement(b.a,{onClick:w("help")},r.a.createElement(ee.a,null))))})),he=n(51),ye=n(70),Ee=n(109),be=n.n(Ee),ge=n(111),_e=n.n(ge),ve=n(53),ke=n.n(ve),Oe=n(110),we=n.n(Oe),Ce=n(112),Se=n.n(Ce),Ie=n(113),Ae=n.n(Ie),xe=n(200),je=n(187),Le=n(154),Re=n(193),Ne=n(192),Te=n(189),De=n(190),Pe=function(e){var t=e.label,n=e.action,a=e.icon,i=r.a.useState(""),c=Object(s.a)(i,2),o=c[0],l=c[1];return r.a.createElement(ce.a,{label:t,value:o,onChange:function(e){return l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(n(o),l(""))},autoFocus:!0,InputProps:{endAdornment:r.a.createElement(Te.a,{position:"end"},r.a.createElement(De.a,{onClick:function(){n(o),l("")}},a))}})},Ye=function(e){var t=e.text,n=e.duration;return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},r.a.createElement("div",null,t),r.a.createElement("div",{style:{textAlign:"right",paddingRight:"4px"}},n))},Be=n(191),Me=n(69),Ke=n.n(Me),Ue=function(e){var t=e.dispatch,n=e.bookmarks,a=e.tracklist,i=e.menuState,c=e.setMenuState,o=e.anchorElRef,l=e.current_tlid,s=function(e){var n=a.findIndex((function(e){return e.tlid===l}));t({type:"LIBRARY_SET_CHILDREN",target:["bookmark:"],fun:function(t){return t.find((function(t){return t.name===e}))?t.map((function(t){return t.name===e?Object(x.a)({},t,{current_track_index:n}):t})):[].concat(Object(q.a)(t),[{name:e,uri:"bookmark:"+e,current_track_index:n,type:"bookmark"}])}}),t({type:"LIBRARY_SET_CHILDREN",target:["bookmark:","bookmark:"+e],fun:function(){return a.map((function(e){return e.track}))}}),t({type:"BOOKMARK_SAVE"})};return r.a.createElement(ie.a,{anchorEl:o.current,keepMounted:!0,open:"bookmark"===i,onClose:function(){return c(!1)},onKeyPress:function(){}},r.a.createElement(Be.a,null,r.a.createElement(Pe,{label:"New Bookmark",icon:r.a.createElement(Ke.a,null),action:function(e){s(e),c(null)}})),n.children&&n.children.map((function(e){return r.a.createElement(Be.a,{key:e.uri,onClick:function(){s(e.name,a.map((function(e){return e.track}))),c(null)}},e.name)})))};Ue=Object(o.b)((function(e){return{bookmarks:e.library.bookmarks,current_tlid:e.playback_state.tltrack?e.playback_state.tltrack.tlid:null}}))(Ue);var Fe=function(e,t,n){e.playlists.create({name:t,uri_scheme:"m3u"}).then((function(t){t.tracks=n,e.playlists.save({playlist:t}).then()}))},He=function(e){var t=e.menuState,n=e.setMenuState,a=e.anchorElRef,i=e.playlists,c=e.tracklist,o=r.a.useContext(f).mopidy;return"menu"===t?r.a.createElement((function(){return r.a.createElement(ie.a,{anchorEl:a.current,keepMounted:!0,open:"menu"===t,onClose:function(){return n(!1)}},r.a.createElement(Be.a,null,r.a.createElement(Pe,{icon:r.a.createElement(Ke.a,null),label:"New Playlist",action:function(e){var t;(t=e)&&0!==t.length&&(i.children.map((function(e){return e.name})).includes(t)?console.log("Playlist ",t,"already exists!"):Fe(o,t,c.map((function(e){return e.track})))),n(null)}})),r.a.createElement(Be.a,{onClick:function(e){return n("submenu")}},"Overwrite Playlist"))}),null):r.a.createElement((function(){return r.a.createElement(ie.a,{anchorEl:a.current,keepMounted:!0,open:"submenu"===t,onClose:function(){return n(!1)}},i.children&&i.children.map((function(e){return r.a.createElement(Be.a,{key:e.uri,onClick:function(){Fe(o,e.name,c.map((function(e){return e.track}))),n(null)}},e.name)})))}),null)},ze=n(52);function We(){var e=Object(he.a)(["\npadding: 0;\n:hover {\n    background-color: rgba(63, 81, 181, 0.125);\n    border-radius: 5px;\n}\n"]);return We=function(){return e},e}var qe=function(e){try{return"".concat(e.track.album.name," / ").concat(e.track.track_no,". ").concat(e.track.name)}catch(t){return e.track.name||e.track.uri}},Ge=Object(ze.a)(Le.a)(We()),Je=function(e){e.dispatch;var t=e.tracklist,n=e.current_tlid,a=r.a.useContext(f).mopidy;return r.a.createElement(ye.a,{list:t,setList:function(){},tag:je.a,style:{overflow:"auto",maxHeight:"100%",padding:0},group:{name:"tracklist",pull:!0,put:["library"]},onEnd:function(e){return function(e,t){t.tracklist.move({start:e.oldIndex,end:e.oldIndex,to_position:e.newIndex})}(e,a)},id:"tracklist"},t.map((function(e){return r.a.createElement(Ge,{key:e.tlid,className:e.tlid===n?"tracklist_current":""},e.tlid===n?r.a.createElement(be.a,{fontSize:"small"}):"",r.a.createElement(Ne.a,null,r.a.createElement(Ye,{text:qe(e),duration:u(e.track.length,"\u221e")})),r.a.createElement(Re.a,null,r.a.createElement(E.a,null,r.a.createElement(b.a,{onClick:function(){return a.playback.play({tlid:e.tlid})}},r.a.createElement(w.a,{fontSize:"small"})),r.a.createElement(b.a,{onClick:function(){return a.tracklist.remove({criteria:{tlid:[e.tlid]}})}},r.a.createElement(ke.a,{fontSize:"small"})))))})))},Ve=function(e){var t=e.tracklist,n=e.playlists,a=(e.bookmarks,e.dispatch),i=r.a.useContext(f).mopidy,c=r.a.useRef(null),o=r.a.useState(null),l=Object(s.a)(o,2),u=l[0],d=l[1],p=r.a.useState(t),m=Object(s.a)(p,2),g=m[0],_=m[1];return r.a.useEffect((function(){h(t.map((function(e){return e.track.uri})),g.map((function(e){return e.track.uri})))||(n.synced&&(Fe(i,n.synced.name,t.map((function(e){return e.track}))),i.playlists.getItems({uri:n.synced.uri}).then((function(e){return a({type:"LIBRARY_SET_CHILDREN",target:["playlist:",n.synced.uri],fun:function(){return e||[]}})}))),_(t))})),r.a.createElement(y.a,{style:{paddingLeft:"10px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},n.synced&&r.a.createElement(xe.a,{icon:r.a.createElement(we.a,null),color:"primary",onDelete:function(){return a({type:"PLAYLIST_UNSYNC"})},style:{float:"left"},label:n.synced.name,variant:"outlined",size:"small"}),r.a.createElement("div",null,t.length," tracks"),r.a.createElement(E.a,null,r.a.createElement(oe.a,{title:"Clear playlist"},r.a.createElement(b.a,{onClick:function(){a({type:"TRACKLIST_UNSYNC"}),i.tracklist.clear()}},r.a.createElement(_e.a,{fontSize:"small"}))),r.a.createElement(oe.a,{title:"Save as..."},r.a.createElement(b.a,{onClick:function(e){return d("menu")},ref:c},r.a.createElement(Se.a,null))),r.a.createElement(He,{menuState:u,setMenuState:d,anchorElRef:c,playlists:n,tracklist:t}),r.a.createElement(oe.a,{title:"Bookmark current TL and position"},r.a.createElement(b.a,{onClick:function(e){return d("bookmark")}},r.a.createElement(Ae.a,null))),r.a.createElement(Ue,{menuState:u,setMenuState:d,anchorElRef:c,tracklist:t})))};Ve=Object(o.b)((function(e){return{playlists:e.library.playlists}}))(Ve);var Xe=function(e){var t=e.tracklist,n=e.current_tlid,a=e.dispatch,i=e.mopidy;return r.a.createElement(y.a,{style:{display:"flex",flexDirection:"column",height:"100%",paddingLeft:"5px",marginLeft:"5px"}},r.a.createElement(Ve,{tracklist:t,mopidy:i}),r.a.createElement(Je,{tracklist:t,current_tlid:n,dispatch:a,mopidy:i,style:{overflow:"auto",height:"100%",maxHeight:"100%"}}))},Qe=Xe=Object(o.b)((function(e){return{tracklist:e.tracklist,current_tlid:e.playback_state.tltrack?e.playback_state.tltrack.tlid:null}}))(Xe),$e=n(54),Ze=n(116),et=n.n(Ze),tt=n(115),nt=n.n(tt),at=function(e){return"track"===e.type||"Track"===e.__model__},rt=function(e,t,n){if(!at(e)&&(t({type:"LIBRARY_TOGGLE_EXPANDED",target:e.path}),!(e.children&&e.children.length>0)))switch(e.type){case"playlists_root":n.playlists.asList().then((function(n){return t({type:"LIBRARY_SET_CHILDREN",target:e.path,fun:function(){return n}})}));break;case"playlist":n.playlists.getItems({uri:e.uri}).then((function(n){return t({type:"LIBRARY_SET_CHILDREN",target:e.path,fun:function(){return n||[]}})}));break;case"search_results_root":case"search_result":break;default:n.library.browse({uri:e.uri}).then((function(n){return t({type:"LIBRARY_UPDATE_CHILDREN",target:e.path,fun:function(){return n},data:n})}))}},it=function(){var e=Object(W.a)(z.a.mark((function e(t,n){var a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Promise.all(t.map(function(){var e=Object(W.a)(z.a.mark((function e(t){var a,r;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!at(t)){e.next=4;break}return e.abrupt("return",t.uri);case 4:e.t0=t.type,e.next="playlist"===e.t0?7:"search_result"===e.t0?15:16;break;case 7:if(t.children){e.next=14;break}return e.next=10,n.playlists.getItems({uri:t.uri});case 10:return a=e.sent,e.abrupt("return",a.map((function(e){return e.uri})));case 14:case 15:return e.abrupt("return",t.children.map((function(e){return e.uri})));case 16:return e.next=18,n.library.browse({uri:t.uri});case 18:return 0===(r=e.sent).length&&t.children&&(r=t.children),e.next=22,it(r,n);case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return a=e.sent,e.abrupt("return",a.flat());case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ct=function(){var e=Object(W.a)(z.a.mark((function e(t,n){var a,r;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!at(t)){e.next=2;break}return e.abrupt("return",[t.uri]);case 2:return e.next=4,it([t],n);case 4:return a=e.sent,r=a.filter((function(e){return null!==e})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ot=function(){var e=Object(W.a)(z.a.mark((function e(t,n,a){var r,i;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ct(t,a);case 2:return r=e.sent,e.next=5,a.tracklist.add({uris:r,at_position:n});case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),lt=n(33),st=n(114),ut=n.n(st),dt=n(71),pt=n.n(dt),mt=(n(83),n(72)),ft=n.n(mt),ht=function(e){var t=e.node,n=Object(lt.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy,c=a.dispatch;return r.a.createElement(oe.a,{title:"Play now !"},r.a.createElement(b.a,Object.assign({},n,{onClick:function(){c({type:"TRACKLIST_UNSYNC"}),i.tracklist.clear(),ot(t,0,i).then((function(e){if(t.current_track_index){var n=e[t.current_track_index].tlid;console.log("CURRENT",e,t.current_track_index,n),i.playback.play({tlid:n})}else i.playback.play()}))}}),r.a.createElement(pt.a,null)))},yt=function(e){var t=e.node,n=Object(lt.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy;a.dispatch;return r.a.createElement(oe.a,{title:"Add to tracklist"},r.a.createElement(b.a,Object.assign({},n,{onClick:Object(W.a)(z.a.mark((function e(){var n;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ct(t,i);case 2:n=e.sent,console.log("Add",n),i.tracklist.add({uris:n});case 5:case"end":return e.stop()}}),e)})))}),r.a.createElement(ut.a,null)))},Et=function(e){var t=e.node,n=Object(lt.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy,c=a.dispatch;return r.a.createElement(oe.a,{title:"Play synced"},r.a.createElement(b.a,Object.assign({},n,{onClick:function(){i.tracklist.clear(),c({type:"TRACKLIST_SYNC",data:t.uri}),ot(t,0,i).then((function(){return i.playback.play()}))}}),r.a.createElement(pt.a,null)))},bt=function(e){var t=e.node,n=Object(lt.a)(e,["node"]),a=r.a.useContext(f),i=(a.mopidy,a.dispatch);return r.a.createElement(oe.a,{title:"Delete tracklist "+t.name},r.a.createElement(b.a,Object.assign({onClick:function(){i({type:"TRACKLIST_DELETE",data:t.uri})}},n),r.a.createElement(ft.a,null)))},gt=function(e){var t=e.node,n=Object(lt.a)(e,["node"]),a=r.a.useContext(f),i=(a.mopidy,a.dispatch);return r.a.createElement(oe.a,{title:"Delete bookmark "+t.name},r.a.createElement(b.a,Object.assign({onClick:function(){i({type:"BOOKMARK_DELETE",target:t.uri})}},n),r.a.createElement(ft.a,null)))},_t=function(e){var t=e.node,n=Object(lt.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy,c=a.dispatch;return r.a.createElement(oe.a,{title:"Delete playlist "+t.name},r.a.createElement(b.a,Object.assign({onClick:function(){i.playlists.delete({uri:t.uri}),i.playlists.asList().then((function(e){return c({type:"LIBRARY_UPDATE_CHILDREN",target:["playlist:"],data:e})}))}},n),r.a.createElement(ft.a,null)))},vt=function(e){var t=e.node;return r.a.createElement(Re.a,null,r.a.createElement(E.a,{size:"small"},r.a.createElement(ht,{node:t}),r.a.createElement(yt,{node:t})))},kt=function(e){var t=e.node;return r.a.createElement(Re.a,null,r.a.createElement(E.a,{size:"small"},r.a.createElement(Et,{node:t}),r.a.createElement(yt,{node:t}),r.a.createElement(bt,{node:t})))},Ot=function(e){var t=e.node;return r.a.createElement(Re.a,null,r.a.createElement(E.a,{size:"small"},r.a.createElement(ht,{node:t}),r.a.createElement(yt,{node:t}),r.a.createElement(gt,{node:t})))},wt=function(e){var t=e.node;return r.a.createElement(Re.a,null,r.a.createElement(E.a,{size:"small"},r.a.createElement(ht,{node:t}),r.a.createElement(yt,{node:t}),r.a.createElement(_t,{node:t})))};function Ct(){var e=Object(he.a)(["\ndisplay: flex;\nflex-direction: row;\njustify-content: space-between;\npadding-left: 3px;\n :hover {\nbackground-color: rgba(63, 81, 181, 0.125);\nborder-radius: 5px;\n}\n"]);return Ct=function(){return e},e}function St(){var e=Object(he.a)(["\n   width: 8px;\n   flex-shrink: 0;\n   opacity: 0.25;\n\n   &:hover {\n      opacity: 0.5;\n   }\n"]);return St=function(){return e},e}var It=ze.a.div(St()),At=ze.a.div(Ct()),xt=function(e){var t=e.callback;return r.a.createElement(It,{onClick:t},r.a.createElement("div",{style:{width:0,height:0,borderBottom:"8px solid rgba(63, 81, 181, 0.5)",borderLeft:"8px solid transparent"}}),r.a.createElement("div",{style:{backgroundColor:"rgba(63, 81, 181, 0.5)",height:"calc(100% - 16px)"}}),r.a.createElement("div",{style:{width:0,height:0,borderTop:"8px solid rgba(63, 81, 181, 0.5)",borderLeft:"8px solid transparent"}}))},jt=function e(t){var n=t.node,a=t.dispatch,i=t.depth,c=t.rootElem,o=r.a.useContext(f).mopidy;if(!n)return null;return r.a.createElement("li",{style:{paddingTop:0,paddingBottom:0,display:"flex",flexDirection:"column",paddingLeft:"10px",marginLeft:0,marginRight:"auto",textAlign:"left"}},r.a.createElement(At,null,r.a.createElement(Ne.a,{onClick:function(){return rt(n,a,o)}},r.a.createElement($e.a,{style:c?{fontWeight:500}:{}},function(e){return at(e)?e.length?r.a.createElement(Ye,{text:e.name,duration:u(e.length)}):e.name:"".concat(e.name," ").concat(function(e){return at(e)?"":Array.isArray(e.children)?"(".concat(e.children.length,")"):"(?)"}(e))}(n),function(e){return at(e)?"":e.expanded?r.a.createElement(nt.a,{style:{verticalAlign:"text-bottom"}}):r.a.createElement(et.a,{style:{verticalAlign:"text-bottom"}})}(n))),function(e,t){return e.path&&1===e.path.length?null:"tracklist"===e.type?r.a.createElement(kt,{node:e}):"bookmark"===e.type?r.a.createElement(Ot,{node:e}):"playlist"===e.type&&e.uri.startsWith("m3u:")?r.a.createElement(wt,{node:e}):r.a.createElement(vt,{node:e})}(n)),r.a.createElement("div",null,n.expanded&&n.children&&r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(xt,{callback:function(){return rt(n,a,o)}}),r.a.createElement((function(){return r.a.createElement(ye.a,{group:{name:"library",put:!1,pull:"clone"},list:n.children,setList:function(){},tag:je.a,onEnd:function(e){!function(e,t,n,a){"tracklist"===n.id&&ot(e,t,a)}(n.children[e.oldIndex],e.newIndex,e.to,o)},style:{width:"100%"}},n.children.map((function(t){return r.a.createElement(e,{key:t.uri,node:t,dispatch:a,depth:i+1})})))}),null))))},Lt=Object(o.b)((function(e){return{library:e.library}}))((function(e){var t=e.library,n=e.dispatch,a=[].concat(Object(q.a)(t.mopidyLibrary),[t.playlists,t.search_results]);return t.search_history.children.length>0&&a.push(t.search_history),t.bookmarks.children.length>0&&a.push(t.bookmarks),console.log("Library:",t,n),r.a.createElement(je.a,{style:{paddingLeft:"10px"}},a.map((function(e){return r.a.createElement(jt,{node:e,dispatch:n,depth:0,key:e.uri,rootElem:!0})})))})),Rt=n(63),Nt=Object(o.b)((function(e){return{persistant:e.settings.persistant}}))((function(e){var t=e.persistant,n=e.dispatch,i=Object(a.useState)(t),c=Object(s.a)(i,2),o=c[0],l=c[1];return r.a.createElement("div",null,r.a.createElement(je.a,null,Object.entries(o).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return r.a.createElement(Le.a,{key:a.name},r.a.createElement(ce.a,{label:a.name,variant:"outlined",style:{margin:8},value:a.current,fullWidth:!0,onChange:function(e){var t=e.target.value;l((function(e){return Object(x.a)({},e,Object(Rt.a)({},n,Object(x.a)({},e[n],{current:t})))}))}}),r.a.createElement(Re.a,null,r.a.createElement(oe.a,{title:r.a.createElement(y.a,{style:{padding:"10px",fontSize:"small"}},r.a.createElement($e.a,null,a.help),r.a.createElement($e.a,null,"Default: ",r.a.createElement("em",null,a.default)))},r.a.createElement(ee.a,null))))}))),r.a.createElement(E.a,null,r.a.createElement(b.a,{onClick:function(){n({type:"COMMIT_SETTINGS",data:Object(x.a)({},o)}),n({type:"CONNECT",mopidy_ws:o.mopidy_ws.current,dispatch:n})}},"Commit"),r.a.createElement(b.a,{onClick:function(){n({type:"CLEAR_SETTINGS"}),n({type:"CONNECT",mopidy_ws:o.mopidy_ws.current,dispatch:n})}},"Restore defaults")))})),Tt=n(117),Dt=n.n(Tt),Pt=function(){return r.a.createElement(y.a,{style:{margin:"20px 20px auto 20px"}},r.a.createElement($e.a,{variant:"h4",style:{marginBottom:"10px"}},"Mowecl ",de.a),r.a.createElement($e.a,null,"Made with \u2665 by Mathias Millet."),r.a.createElement("a",{href:"https://github.com/sapristi/mopidy-mowecl"},r.a.createElement(Dt.a,null)),r.a.createElement("br",null),r.a.createElement($e.a,{variant:"caption"},"Remarks, suggestions and bug reports are welcome."))},Yt=n(119),Bt=n(194),Mt=function(e){var t=e.theme,n=e.children,a=Object(Yt.a)({palette:{type:t}});return r.a.createElement(Bt.a,{theme:a},r.a.createElement(y.a,{className:"App",style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",minHeight:"0",flex:1}},r.a.createElement(fe,null),n),r.a.createElement(F,{style:{display:"flex",flex:1}})))},Kt=Object(o.b)((function(e){return{settings:e.settings,mopidy:e.mopidy}}))((function(e){var t=e.settings,n=e.mopidy,a=(e.dispatch,null);switch(t.active_panel){case"control":a=r.a.createElement(Nt,null);break;case"help":a=r.a.createElement(Pt,null);break;default:a=r.a.createElement(Lt,null)}return n.connected?r.a.createElement(Mt,{theme:t.persistant.theme.current},r.a.createElement("div",{style:{height:"100%",width:"100%",flexDirection:"row",display:"flex"}},r.a.createElement("div",{style:{width:"50%",height:"100%",overflow:"auto"}},a),r.a.createElement("div",{style:{height:"100%",width:"50%"}},r.a.createElement(Qe,null)))):r.a.createElement(Mt,{theme:t.persistant.theme.current},r.a.createElement("div",{style:{width:"50%",height:"100%",overflow:"auto"}},r.a.createElement(Nt,null)),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{flex:1}}),r.a.createElement("div",{style:{flex:1}},r.a.createElement(le.a,{color:"inherit",style:{margin:"auto"}})),r.a.createElement("div",{style:{flex:1}},r.a.createElement("div",null,"Trying to reach mopidy at ",t.persistant.mopidy_ws.current),r.a.createElement("div",null,n.error)),r.a.createElement("div",{style:{flex:1}})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ut=n(84),Ft=n(73),Ht=n(118),zt=n(75),Wt=n(48),qt=n(74),Gt=n(150),Jt=n(151);function Vt(e){return e.replace(/(_[a-z])/g,(function(e){return e.toUpperCase().replace("_","")}))}var Xt=function(e){function t(e){var n;return Object(Ft.a)(this,t),(n=Object(zt.a)(this,Object(Wt.a)(t).call(this)))._console=n._getConsole(e||{}),n._settings=n._configure(e||{}),n._backoffDelay=n._settings.backoffDelayMin,n._pendingRequests={},n._webSocket=null,n._delegateEvents(),n._settings.autoConnect&&n.connect(),n}return Object(qt.a)(t,e),Object(Ht.a)(t,[{key:"_getConsole",value:function(e){if("undefined"!==typeof e.console)return e.console;var t="undefined"!==typeof console&&console||{};return t.log=t.log||function(){},t.warn=t.warn||function(){},t.error=t.error||function(){},t}},{key:"_configure",value:function(e){var t=Object(x.a)({},e),n="undefined"!==typeof document&&"https:"===document.location.protocol?"wss://":"ws://",a="undefined"!==typeof document&&document.location.host||"localhost";return t.webSocketUrl=e.webSocketUrl||"".concat(n).concat(a,"/mopidy/ws"),!1!==e.autoConnect&&(t.autoConnect=!0),t.backoffDelayMin=e.backoffDelayMin||1e3,t.backoffDelayMax=e.backoffDelayMax||64e3,t}},{key:"_delegateEvents",value:function(){this.removeAllListeners("websocket:close"),this.removeAllListeners("websocket:error"),this.removeAllListeners("websocket:incomingMessage"),this.removeAllListeners("websocket:open"),this.removeAllListeners("state:offline"),this.on("websocket:close",this._cleanup),this.on("websocket:error",this._handleWebSocketError),this.on("websocket:incomingMessage",this._handleMessage),this.on("websocket:open",this._resetBackoffDelay),this.on("websocket:open",this._getApiSpec),this.on("state:offline",this._reconnect)}},{key:"off",value:function(){if(0===arguments.length)this.removeAllListeners();else if(1===arguments.length){var e=arguments.length<=0?void 0:arguments[0];if("string"!==typeof e)throw Error("Expected no arguments, a string, or a string and a listener.");this.removeAllListeners(e)}else this.removeListener.apply(this,arguments)}},{key:"connect",value:function(){var e=this;if(this._webSocket){if(this._webSocket.readyState===t.WebSocket.OPEN)return;this._webSocket.close()}this._webSocket=this._settings.webSocket||new t.WebSocket(this._settings.webSocketUrl),this._webSocket.onclose=function(t){e.emit("websocket:close",t)},this._webSocket.onerror=function(t){e.emit("websocket:error",t)},this._webSocket.onopen=function(){e.emit("websocket:open")},this._webSocket.onmessage=function(t){e.emit("websocket:incomingMessage",t),e.emit("requests:count",Object.keys(e._pendingRequests).length)}}},{key:"_cleanup",value:function(e){var n=this;Object.keys(this._pendingRequests).forEach((function(a){var r=n._pendingRequests[a].reject;delete n._pendingRequests[a];var i=new t.ConnectionError("WebSocket closed");i.closeEvent=e,r(i)})),this.emit("state","state:offline"),this.emit("state:offline")}},{key:"_reconnect",value:function(){var e=this;this.emit("state","reconnectionPending",{timeToAttempt:this._backoffDelay}),this.emit("reconnectionPending",{timeToAttempt:this._backoffDelay}),setTimeout((function(){e.emit("state","reconnecting"),e.emit("reconnecting"),e.connect()}),this._backoffDelay),this._backoffDelay=2*this._backoffDelay,this._backoffDelay>this._settings.backoffDelayMax&&(this._backoffDelay=this._settings.backoffDelayMax)}},{key:"_resetBackoffDelay",value:function(){this._backoffDelay=this._settings.backoffDelayMin}},{key:"close",value:function(){this.off("state:offline",this._reconnect),this._webSocket&&this._webSocket.close()}},{key:"_handleWebSocketError",value:function(e){this._console.warn("WebSocket error:",e.stack||e)}},{key:"_send",value:function(e){var n=this;switch(this._webSocket.readyState){case t.WebSocket.CONNECTING:return Promise.reject(new t.ConnectionError("WebSocket is still connecting"));case t.WebSocket.CLOSING:return Promise.reject(new t.ConnectionError("WebSocket is closing"));case t.WebSocket.CLOSED:return Promise.reject(new t.ConnectionError("WebSocket is closed"));default:return new Promise((function(t,a){var r=Object(x.a)({},e,{jsonrpc:"2.0",id:n._nextRequestId()});n._pendingRequests[r.id]={resolve:t,reject:a},n._webSocket.send(JSON.stringify(r)),n.emit("websocket:outgoingMessage",r),n.emit("requests:count",Object.keys(n._pendingRequests).length)}))}}},{key:"_handleMessage",value:function(e){try{var t=JSON.parse(e.data);Object.hasOwnProperty.call(t,"id")?this._handleResponse(t):Object.hasOwnProperty.call(t,"event")?this._handleEvent(t):this._console.warn("Unknown message type received. Message was: ".concat(e.data))}catch(n){if(!(n instanceof SyntaxError))throw n;this._console.warn("WebSocket message parsing failed. Message was: ".concat(e.data))}}},{key:"_handleResponse",value:function(e){if(Object.hasOwnProperty.call(this._pendingRequests,e.id)){var n=this._pendingRequests[e.id],a=n.resolve,r=n.reject;if(delete this._pendingRequests[e.id],Object.hasOwnProperty.call(e,"result"))a(e.result);else if(Object.hasOwnProperty.call(e,"error")){var i=new t.ServerError(e.error.message);i.code=e.error.code,i.data=e.error.data,r(i),this._console.warn("Server returned error:",e.error)}else{var c=new Error("Response without 'result' or 'error' received");c.data={response:e},r(c),this._console.warn("Response without 'result' or 'error' received. Message was:",e)}}else this._console.warn("Unexpected response received. Message was:",e)}},{key:"_handleEvent",value:function(e){var t=Object(x.a)({},e);delete t.event;var n="event:".concat(Vt(e.event));this.emit("event",n,t),this.emit(n,t)}},{key:"_getApiSpec",value:function(){return this._send({method:"core.describe"}).then(this._createApi.bind(this)).catch(this._handleWebSocketError.bind(this))}},{key:"_createApi",value:function(e){var t=this;Object.keys(e).forEach((function(n){var a,r=function(e){var t=e.split(".");return t.length>=1&&"core"===t[0]&&(t=t.slice(1)),t}(n),i=Vt(r.slice(-1)[0]),c=function(e){var n=t;return e.forEach((function(e){var t=Vt(e);n[t]=n[t]||{},n=n[t]})),n}(r.slice(0,-1));c[i]=(a=n,function(){for(var e={method:a},n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return 0===r.length?t._send(e):r.length>1?Promise.reject(new Error("Expected zero arguments, a single array, or a single object.")):Array.isArray(r[0])||r[0]===Object(r[0])?(e.params=r[0],t._send(e)):Promise.reject(new TypeError("Expected an array or an object."))}),c[i].description=e[n].description,c[i].params=e[n].params})),this.emit("state","state:online"),this.emit("state:online")}}]),t}(Gt),Qt=function(e){function t(e){var n;return Object(Ft.a)(this,t),(n=Object(zt.a)(this,Object(Wt.a)(t).call(this,e))).name="ConnectionError",n}return Object(qt.a)(t,e),t}(Object(Ut.a)(Error));Xt.ConnectionError=Qt;var $t=function(e){function t(e){var n;return Object(Ft.a)(this,t),(n=Object(zt.a)(this,Object(Wt.a)(t).call(this,e))).name="ServerError",n}return Object(qt.a)(t,e),t}(Object(Ut.a)(Error));Xt.ServerError=$t,Xt.WebSocket=Jt,Xt.prototype._nextRequestId=function(){var e=-1;return function(){return e+=1}}();var Zt=Xt,en=function(){var e=Object(W.a)(z.a.mark((function e(t,n){var a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[{fun_path:["playback","getCurrentTlTrack"],base:{type:"PLAYBACK_INFO",target:"tltrack"}},{fun_path:["playback","getState"],base:{type:"PLAYBACK_INFO",target:"state"}},{fun_path:["playback","getTimePosition"],base:{type:"PLAYBACK_INFO",target:"time_position"}}],e.next=3,Promise.all(a.map(function(){var e=Object(W.a)(z.a.mark((function e(a){var r,i,c,o;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.fun_path,i=a.base,r.reduce((function(e,t){return e[t]}),n),c=r.reduce(d,n),e.next=5,c();case 5:o=e.sent,t(Object.assign({},i,{data:o}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),tn=function(e,t,n){t.on("requests:count",(function(e){n({type:"MOPIDY_PENDING_REQUESTS_COUNT",data:e})})),t.on("state:online",Object(W.a)(z.a.mark((function e(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"MOPIDY_CLIENT_CONNECTED"}),t.tracklist.getTlTracks().then(function(){var e=Object(W.a)(z.a.mark((function e(a){var r,i,c,o,l;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"TRACKLIST_INITIALISE",data:a}),e.next=3,t.playlists.asList();case 3:if(r=e.sent,n({type:"LIBRARY_SET_CHILDREN",target:["playlist:"],fun:function(){return r}}),i=JSON.parse(localStorage.getItem("bookmarks")),console.log("BOOKMARKS",i),i&&n({type:"LIBRARY_SET_CHILDREN",target:["bookmark:"],fun:function(){return i.children}}),c=JSON.parse(localStorage.getItem("synced"))){e.next=11;break}return e.abrupt("return");case 11:if(o=r.find((function(e){return e.uri===c.uri}))){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,t.playlists.getItems({uri:o.uri});case 16:l=e.sent,h(c.children,a.map((function(e){return e.track.uri})))&&h(c.children,l.map((function(e){return e.uri})))&&n({type:"PLAYLIST_SYNC",data:c});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.mixer.getVolume().then((function(e){return n({type:"PLAYBACK_INFO",target:"volume",data:e})})),t.library.browse({uri:null}).then((function(e){return n({type:"MOPIDY_LIBRARY_INITIALISE",data:e})})),t.getUriSchemes().then((function(e){return n({type:"URI_SCHEMES",data:e})})),en(n,t);case 6:case"end":return e.stop()}}),e)})))),t.on("state:offline",(function(){return n({type:"MOPIDY_CLIENT_DISCONNECTED"})})),t.on("event:trackPlaybackResumed",(function(e){n({type:"PLAYBACK_INFO",target:"state",data:"playing"}),n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position})})),t.on("event:trackPlaybackPaused",(function(e){n({type:"PLAYBACK_INFO",target:"state",data:"paused"}),n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position}),n({type:"INCR_PLAYBACK_RESET"})})),t.on("event:seeked",(function(e){n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position})})),t.on("event:trackPlaybackStarted",(function(e){n({type:"PLAYBACK_INFO",target:"track",data:e.track})})),t.on("event:trackPlaybackEnded",(function(e){n({type:"CLEAR_PLAYBACK_INFO"}),n({type:"PLAYBACK_INFO",target:"state",data:"stopped"})})),t.on("event:trackPlaybackStarted",(function(e){n({type:"INCR_PLAYBACK_RESET"}),n({type:"PLAYBACK_INFO",target:"state",data:"playing"}),n({type:"PLAYBACK_INFO",target:"time_position",data:0}),n({type:"PLAYBACK_INFO",target:"tltrack",data:e.tl_track})})),t.on("event:tracklistChanged",(function(){t.tracklist.getTlTracks().then((function(e){return n({type:"TRACKLIST_INITIALISE",data:e})})),en(n,t)})),t.on("event:volumeChanged",(function(e){n({type:"PLAYBACK_INFO",target:"volume",data:e.volume})}))},nn=function(e,t,n){return function e(t,n,a,r){if(n[0]===t.uri){if(1===n.length){var i=t.children||[],c=r(i);return Array.isArray(c)&&(c=c.map((function(e){return Object(x.a)({},e,{path:[].concat(Object(q.a)(a),[e.uri])})}))),Object(x.a)({},t,{children:c})}return Object(x.a)({},t,{children:t.children.map((function(t){return e(t,n.slice(1),a,r)}))})}return t}(e,t,t,n)},an=function e(t,n,a){return n[0]===t.uri?1===n.length?Object(x.a)({},t,{expanded:a(t.expanded)}):void 0===t.children?t:Object(x.a)({},t,{children:t.children.map((function(t){return e(t,n.slice(1),a)}))}):t},rn=function(e,t,n){return nn(e,t,(function(e){return e?n.map((function(t){var n=e.find((function(e){return e.uri===t.uri}));return n?Object(x.a)({},t,{children:n.children}):t})):n}))},cn=function(e,t){switch(t.type){case"LIBRARY_SET_CHILDREN":return nn(e,t.target,t.fun);case"LIBRARY_UPDATE_CHILDREN":return rn(e,t.target,t.data);case"LIBRARY_TOGGLE_EXPANDED":return an(e,t.target,(function(e){return!e}));case"LIBRARY_SET_EXPANDED":return an(e,t.target,(function(){return t.data}));default:return e}},on=Object(l.b)({mopidyLibrary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOPIDY_LIBRARY_INITIALISE":return t.data.map((function(e){return Object(x.a)({},e,{path:[e.uri]})}));case"LIBRARY_SET_CHILDREN":return e.map((function(e){return nn(e,t.target,t.fun)}));case"LIBRARY_UPDATE_CHILDREN":return e.map((function(e){return rn(e,t.target,t.data)}));case"LIBRARY_TOGGLE_EXPANDED":return e.map((function(e){return an(e,t.target,(function(e){return!e}))}));case"LIBRARY_SET_EXPANDED":return e.map((function(e){return an(e,t.target,(function(){return t.data}))}));default:return e}},playlists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Playlists",uri:"playlist:",type:"playlists_root",path:["playlist:"],synced:null},t=arguments.length>1?arguments[1]:void 0;switch(e=cn(e,t),t.type){case"PLAYLIST_UNSYNC":return e=Object(x.a)({},e,{synced:null}),localStorage.setItem("synced",JSON.stringify(null)),e;case"PLAYLIST_SYNC":return e=Object(x.a)({},e,{synced:t.data}),localStorage.setItem("synced",JSON.stringify(t.data)),e;case"PLAYLIST_SYNCED_UPDATE":if(!e.synced)return e;default:return e}},search_results:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Search results",uri:"search:",type:"search_results_root",path:["search:"],children:[]},t=arguments.length>1?arguments[1]:void 0;return cn(e,t)},search_history:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Search history",uri:"search_history:",type:"search_history_root",path:["search_history:"],children:[]},t=arguments.length>1?arguments[1]:void 0;return cn(e,t)},bookmarks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Bookmarks",uri:"bookmark:",type:"bookmarks_root",path:["bookmark:"],children:[]},t=arguments.length>1?arguments[1]:void 0;switch(e=cn(e,t),t.type){case"BOOKMARK_SAVE":return localStorage.setItem("bookmarks",JSON.stringify(e)),e;case"BOOKMARK_DELETE":return e=Object(x.a)({},e,{children:e.children.filter((function(e){return e.uri!==t.target}))}),console.log("DEL",e.children,t.target),localStorage.setItem("bookmarks",JSON.stringify(e)),e;default:return e}}}),ln={tltrack:{track:null,tlid:null},state:null,time_position:null,updating:!1,time_position_updater:{pending:!1,last_update:null},volume:null},sn=JSON.parse(localStorage.getItem("settings"))||{},un={mopidy_ws:{name:"Modidy WebSocker URL",default:function(){var e="https:"===window.location.protocol?"wss":"ws",t=window.location.hostname;return"".concat(e,"://").concat(t,":").concat(6680,"/mopidy/ws")}(),help:"Modidy WebSocker URL. Do not modify unless you know what you are doing.",validate:function(e){return e}},seek_update_interval:{name:"Seek update interval",default:500,help:"Time interval (ms) at which the song progress bar will update.",validate:function(e){return parseInt(e)||500}},search_history_length:{name:"Search history length",default:10,help:"Number of items in search history. Set 0 to disable.",validate:function(e){return parseInt(e)||10}},theme:{name:"Theme",default:"light",help:"light or dark",validate:function(e){var t=e.toLowerCase();return["light","dark"].includes(t)?t:"light"}}},dn={active_panel:"library",persistant:Object.fromEntries(Object.entries(un).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1],r=sn[n]||a.default;return[n,Object(x.a)({},a,{current:r})]})))},pn=function(e){var t=e.mopidy,n=e.settings,a=e.dispatch;return t.connected||t.connecting||t.error||a({type:"CONNECT",mopidy_ws:n.persistant.mopidy_ws.current,dispatch:a}),r.a.createElement(f.Provider,{value:{mopidy:t.mopidy,dispatch:a}},r.a.createElement(Kt,null))};pn=Object(o.b)((function(e){return{mopidy:e.mopidy,settings:e.settings}}))(pn);var mn=Object(l.c)(Object(l.b)({playback_state:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLEAR_PLAYBACK_INFO":return Object(x.a)({},ln,{volume:e.volume});case"PLAYBACK_INFO":var n={};n[t.target]=t.data,"tltrack"!==t.target||t.data||(n[t.target]={track:null,tlid:null});var a=Object.assign({},e,n);return"time_position"===t.target&&(a.time_position_updater.last_update=(new Date).valueOf()),a;case"INCR_PLAYBACK_START":return Object(x.a)({},e,{time_position_updater:Object(x.a)({},e.time_position_updater,{pending:!0})});case"INCR_PLAYBACK":var r=(new Date).valueOf(),i=r-e.time_position_updater.last_update;return"playing"!==e.state?e:Object(x.a)({},e,{time_position:e.time_position+i,time_position_updater:{pending:!1,last_update:r}});case"INCR_PLAYBACK_RESET":return Object(x.a)({},e,{time_position_updater:{pending:!1,last_update:null}});case"PLAYBACK_UPDATING":return Object(x.a)({},e,{updating:t.data});default:return e}},tracklist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TRACKLIST_INITIALISE":return t.data;default:return e}},library:on,settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ACTIVATE_PANEL":return Object(x.a)({},e,{active_panel:t.target});case"CLEAR_SETTINGS":return localStorage.removeItem("settings"),Object(x.a)({},e,{persistant:Object.fromEntries(Object.entries(un).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1],r=a.default;return[n,Object(x.a)({},a,{current:r})]})))});case"COMMIT_SETTINGS":return localStorage.setItem("settings",JSON.stringify(Object.fromEntries(Object.entries(t.data).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return[n,a.validate(a.current)]}))))),Object(x.a)({},e,{persistant:Object.fromEntries(Object.entries(t.data).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return[n,Object(x.a)({},a,{current:a.validate(a.current)})]})))});case"SET_THEME":return Object(x.a)({},e,{theme:t.data});default:return e}},mopidy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{connected:!1,connecting:!1,mopidy:null,uri_schemes:[],pendingRequestsNb:0,error:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOPIDY_CLIENT_CONNECTED":return Object(x.a)({},e,{connected:!0,connecting:!1});case"MOPIDY_CLIENT_DISCONNECTED":return Object(x.a)({},e,{connected:!1,connecting:!0});case"MOPIDY_PENDING_REQUESTS_COUNT":return Object(x.a)({},e,{pendingRequestsNb:t.data});case"CONNECT":if(!t.dispatch||!t.mopidy_ws){var n="dispatch and mopidy_host must be passed at CONNECT";return console.log("ERROR: "+n),Object(x.a)({},e,{error:n,connecting:!0})}var a=t.mopidy_ws;console.log("webSocketUrl:",a),e.mopidy&&(e.mopidy.removeAllListeners(),e.mopidy.close(),e.mopidy.off());var r=new Zt({webSocketUrl:a,autoConnect:!1});try{r.connect()}catch(n){return console.log("Error when initializing mopidy",n),r.removeAllListeners(),r.close(),r.off(),tn(0,r,t.dispatch),Object(x.a)({},e,{error:n.toString(),mopidy:r,connecting:!1})}return r.on("event",console.log),window.$mopidy=r,tn(0,r,t.dispatch),Object(x.a)({},e,{connecting:!0,mopidy:r,connected:!1,error:null});case"URI_SCHEMES":return Object(x.a)({},e,{uri_schemes:t.data});default:return e}}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());window.$store=mn,c.a.render(r.a.createElement(o.a,{store:mn,style:{height:"100%"}},r.a.createElement(pn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},64:function(e){e.exports=JSON.parse('{"a":"0.3.2"}')}},[[135,1,2]]]);
//# sourceMappingURL=main.a1631109.chunk.js.map