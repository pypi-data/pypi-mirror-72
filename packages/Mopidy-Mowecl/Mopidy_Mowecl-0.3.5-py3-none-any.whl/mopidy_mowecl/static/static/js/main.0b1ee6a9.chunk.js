(this.webpackJsonpmopidy_webui=this.webpackJsonpmopidy_webui||[]).push([[0],{135:function(e,t,n){e.exports=n(158)},144:function(e,t,n){},146:function(e,t,n){},158:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),i=n.n(c),o=n(16),l=n(34),s=(n(144),n(145),n(13)),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"??";if(void 0===e||null===e)return t;var n=Math.ceil(e/1e3),a=n%60,r=(n-a)/60,c=a<10?"0"+a:""+a;return"".concat(r,":").concat(c)},p=function(e,t){return e[t]},d={spotify:"Spotify",spotifytunigo:"Spotify browse",spotifyweb:"Spotify browse",local:"Local media",m3u:"Local playlists",podcast:"Podcasts","podcast+itunes":"iTunes Store: Podcasts",dirble:"Dirble",tunein:"TuneIn",soundcloud:"SoundCloud",gmusic:"Google Music",internetarchive:"Internet Archive",somafm:"Soma FM",youtube:"YouTube",audioaddict:"AudioAddict",subsonic:"Subsonic"},m=["file","http","https","mms","rtmp","rtmps","rtsp","yt"],f=r.a.createContext(null),h=function(e,t){return e.map((function(e,n){return[e,t[n]]})).every((function(e){var t=Object(s.a)(e,2);return t[0]===t[1]}))};n(146);var y=n(188),E=n(183),b=n(159),g=n(96),_=n.n(g),v=n(98),k=n.n(v),O=n(64),w=n.n(O),S=n(97),C=n.n(S),x=n(121),I=function(e){var t=e.state,n=r.a.useContext(f).mopidy;return Object(x.a)("space",(function(){"playing"===t?n&&n.playback.pause():n&&n.playback.play()}),{},[t,n]),r.a.createElement(E.a,null,r.a.createElement(b.a,{onClick:function(){return n.playback.previous()}},r.a.createElement(_.a,{fontSize:"large"})),"playing"===t?r.a.createElement(b.a,{onClick:function(){return n.playback.pause()}},r.a.createElement(C.a,{fontSize:"large"})):r.a.createElement(b.a,{onClick:function(){return n.playback.play()}},r.a.createElement(w.a,{fontSize:"large"})),r.a.createElement(b.a,{onClick:function(){return n.playback.next()}},r.a.createElement(k.a,{fontSize:"large"})))},A=n(6),j=n(207),L=n(187),R=function(e){var t=e.state,n=e.time_position,a=e.time_position_updater,c=e.seek_update_interval,i=e.dispatch;return r.a.useEffect((function(){"playing"!==t||"number"!==typeof n||a.pending||(i({type:"INCR_PLAYBACK_START"}),setTimeout((function(){return i({type:"INCR_PLAYBACK"})}),parseInt(c)))})),null};R=Object(o.b)((function(e){return Object(A.a)({},e.playback_state,{seek_update_interval:e.settings.persistant.seek_update_interval.current})}))(R);var N=function(e){var t=e.time_position,n=e.track_length,a=e.dispatch,c=r.a.useContext(f).mopidy,i=Math.ceil(t/n*300);return n?r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement(R,null),r.a.createElement("div",{style:{width:"40px"}},u(t)),r.a.createElement(j.a,{value:i,onChange:function(e,t){a({type:"PLAYBACK_INFO",target:"time_position",data:t*n/300})},onChangeCommitted:function(e,t){c.playback.seek({time_position:Math.ceil(t*n/300)})},max:300,valueLabelDisplay:"auto",valueLabelFormat:function(e){return u(e*n/300)},style:{flex:1,marginRight:"5%",marginLeft:"5%"}}),r.a.createElement("div",null,u(n))):r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement("div",null,u(t)),r.a.createElement(L.a,{style:{flex:1,marginRight:"5%",marginLeft:"5%"}}))},T=N=Object(o.b)((function(e){return{time_position:e.playback_state.time_position}}))(N),D=n(99),P=n.n(D),Y=n(100),B=n.n(Y),M=function(e){var t=e.volume,n=e.dispatch,a=e.style,c=r.a.useContext(f).mopidy;return r.a.createElement("div",{style:Object(A.a)({display:"flex",flexDirection:"row",alignItems:"center"},a)},r.a.createElement("div",{onClick:function(){return c.mixer.setVolume({volume:t-1})}},r.a.createElement(P.a,null)),r.a.createElement("div",{style:{flex:1,marginLeft:"5%",marginRight:"5%"}},r.a.createElement(j.a,{value:t,onChange:function(e,t){n({type:"PLAYBACK_INFO",target:"volume",data:t})},onChangeCommitted:function(e,t){c.mixer.setVolume({volume:t})},valueLabelDisplay:"auto"})),r.a.createElement("div",{onClick:function(){return c.mixer.setVolume({volume:t+1})}},r.a.createElement(B.a,null)))},K=function(e){var t=e.track;if(!t)return"...";var n=t.name?r.a.createElement("div",null,t.name):null,a=t.album?r.a.createElement("div",null,t.album.name):null,c=t.artists?r.a.createElement("div",null,t.artists[0].name):null;return t.album,r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},n,a,c)},F=function(e){var t=e.tltrack,n=e.state,a=e.volume,c=e.dispatch;return r.a.createElement(y.a,{elevation:3,style:{width:"80%",margin:"auto",display:"flex",flexDirection:"row",padding:"5px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement(I,{state:n}),r.a.createElement(M,{volume:a,dispatch:c,style:{marginTop:"auto",marginBottom:"auto"}})),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1,paddingLeft:"5%",paddingRight:"5%"}},"stopped"!==n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(K,{track:t.track}),r.a.createElement(T,{track_length:t.track?t.track.length:null})),r.a.createElement("div",null)))},U=F=Object(o.b)((function(e){return{tltrack:e.playback_state.tltrack,state:e.playback_state.state,volume:e.playback_state.volume}}))(F),W=n(15),z=n.n(W),H=n(21),q=n(27),G=n(105),J=n.n(G),V=n(104),X=n.n(V),Q=n(102),$=n.n(Q),Z=n(69),ee=n.n(Z),te=n(106),ne=n.n(te),ae=n(103),re=n.n(ae),ce=n(202),ie=n(203),oe=n(205),le=n(194),se=n(191),ue=n(201),pe=n(65),de=function(e){var t=e.mopidy,n=e.searchUris,a=e.dispatch,c=e.closePopover,i=e.search_history_length,o=localStorage.getItem("searchSelectedURI")||"all",l=r.a.useState(o),u=Object(s.a)(l,2),p=u[0],d=u[1],m=r.a.useState((function(){return""})),f=Object(s.a)(m,2),h=f[0],y=f[1],E=function(e){if("Enter"===e&&0!==h.length){var n="all"===p?{}:{uris:[p+":"]};t.library.search(Object(A.a)({query:{any:[h]}},n)).then((function(e){var t=e.map((function(e){return Object(A.a)({},e,{name:e.uri,children:e.tracks,type:"search_result",expanded:!0})}));if(a({type:"LIBRARY_SET_CHILDREN",fun:function(){return t},target:["search:"]}),a({type:"LIBRARY_SET_EXPANDED",target:["search:"],data:!0}),!(i<=0)){var n=h+"/"+p;a({type:"LIBRARY_SET_CHILDREN",fun:function(e){return[{name:n,uri:n}].concat(Object(q.a)(e)).slice(0,i)},target:["search_history:"]}),a({type:"LIBRARY_SET_CHILDREN",fun:function(){return t},target:["search_history:",n]})}})),c()}};return r.a.createElement("div",null,r.a.createElement(ie.a,{id:"search-popover-textinput",variant:"outlined",value:h,onChange:function(e){return y(e.target.value)},onKeyPress:function(e){return E(e.key)},autoFocus:!0}),r.a.createElement(se.a,{variant:"outlined"},r.a.createElement(ue.a,{native:!0,value:p,onChange:function(e){localStorage.setItem("searchSelectedURI",e.target.value),d(e.target.value)},onKeyPress:function(e){return E(e.key)}},r.a.createElement("option",{value:"all"},"All"),n.map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return r.a.createElement("option",{value:n,key:n},a)})))))},me=function(e){var t=e.pendingRequestsNb,n={marginTop:"15px",marginBottom:"10px"};return e.connected?0===t?r.a.createElement("div",null,r.a.createElement(le.a,{size:30,thickness:5,style:n,variant:"determinate",value:100})):r.a.createElement("div",null,r.a.createElement(le.a,{size:30,thickness:5,style:n})):r.a.createElement("div",null,r.a.createElement(le.a,{size:30,thickness:5,style:n,color:"secondary"}))},fe=Object(o.b)((function(e){return Object(A.a)({},e.mopidy,{search_history_length:e.settings.persistant.search_history_length.current})}))((function(e){var t=e.dispatch,n=e.mopidy,a=e.uri_schemes,c=e.pendingRequestsNb,i=e.connected,o=e.search_history_length,l=r.a.useRef(null),u=r.a.useState(!1),p=Object(s.a)(u,2),f=p[0],h=p[1],g=r.a.useState((function(){return null})),_=Object(s.a)(g,2),v=_[0],k=_[1];v||fetch("https://pypi.org/pypi/Mopidy-Mowecl/json").then((function(e){return e.json().then((function(e){return k(e.info.version)}))}));var O=a.filter((function(e){return!m.includes(e)})).map((function(e){return[e,d[e]||e]})),w=function(e){return function(){return t({type:"ACTIVATE_PANEL",target:e})}},S=function(){var e=Object(H.a)(z.a.mark((function e(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.library.refresh(),n.playlists.refresh()]);case 2:n.library.browse({uri:null}).then((function(e){return t({type:"MOPIDY_LIBRARY_INITIALISE",data:e})})),n.playlists.asList().then((function(e){return t({type:"LIBRARY_SET_CHILDREN",target:["playlist:"],fun:function(){return e}})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(y.a,{elevation:5,style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},r.a.createElement(E.a,{orientation:"vertical"},r.a.createElement(me,{pendingRequestsNb:c,connected:i}),r.a.createElement(oe.a,{title:"Quick search"},r.a.createElement(b.a,{ref:l,id:"popover-search-button",onClick:function(){return h(!0)}},r.a.createElement($.a,null))),r.a.createElement((function(){return r.a.createElement(ce.a,{open:f,anchorEl:l.current,onClose:function(){return h(!1)},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"}},r.a.createElement(de,{searchUris:O,mopidy:n,dispatch:t,closePopover:function(){return h(!1)},search_history_length:o}))}),null),r.a.createElement(oe.a,{title:"Refresh lib and playlists"},r.a.createElement(b.a,{onClick:S},r.a.createElement(re.a,null)))),r.a.createElement(E.a,{orientation:"vertical"},r.a.createElement(oe.a,{title:"Library panel"},r.a.createElement(b.a,{onClick:w("library")},r.a.createElement(X.a,null))),r.a.createElement(oe.a,{title:"Settings panel"},r.a.createElement(b.a,{style:{height:"auto"},onClick:w("control")},r.a.createElement(J.a,null)))),r.a.createElement(E.a,{orientation:"vertical"},pe.a!=v&&r.a.createElement(oe.a,{title:"Version ".concat(v," available on Pypi.")},r.a.createElement(b.a,null,r.a.createElement(ne.a,null))),r.a.createElement(b.a,{onClick:w("help")},r.a.createElement(ee.a,null))))})),he=n(53),ye=n(71),Ee=n(110),be=n.n(Ee),ge=n(112),_e=n.n(ge),ve=n(54),ke=n.n(ve),Oe=n(111),we=n.n(Oe),Se=n(113),Ce=n.n(Se),xe=n(114),Ie=n.n(xe),Ae=n(206),je=n(193),Le=n(160),Re=n(199),Ne=n(198),Te=n(195),De=n(196),Pe=function(e){var t=e.label,n=e.action,a=e.icon,c=r.a.useState(""),i=Object(s.a)(c,2),o=i[0],l=i[1];return r.a.createElement(ie.a,{label:t,value:o,onChange:function(e){return l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(n(o),l(""))},autoFocus:!0,InputProps:{endAdornment:r.a.createElement(Te.a,{position:"end"},r.a.createElement(De.a,{onClick:function(){n(o),l("")}},a))}})},Ye=function(e){var t=e.text,n=e.duration;return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},r.a.createElement("div",null,t),r.a.createElement("div",{style:{textAlign:"right",paddingRight:"4px"}},n))},Be=n(197),Me=n(70),Ke=n.n(Me),Fe=function(e){var t=e.dispatch,n=e.bookmarks,a=e.tracklist,c=e.menuState,i=e.setMenuState,o=e.anchorElRef,l=e.current_tlid,s=function(e){var n=a.findIndex((function(e){return e.tlid===l}));t({type:"LIBRARY_SET_CHILDREN",target:["bookmark:"],fun:function(t){return t.find((function(t){return t.name===e}))?t.map((function(t){return t.name===e?Object(A.a)({},t,{current_track_index:n}):t})):[].concat(Object(q.a)(t),[{name:e,uri:"bookmark:"+e,current_track_index:n,type:"bookmark"}])}}),t({type:"LIBRARY_SET_CHILDREN",target:["bookmark:","bookmark:"+e],fun:function(){return a.map((function(e){return e.track}))}}),t({type:"BOOKMARK_SAVE"})};return r.a.createElement(ce.a,{anchorEl:o.current,keepMounted:!0,open:"bookmark"===c,onClose:function(){return i(!1)},onKeyPress:function(){}},r.a.createElement(Be.a,null,r.a.createElement(Pe,{label:"New Bookmark",icon:r.a.createElement(Ke.a,null),action:function(e){s(e),i(null)}})),n.children&&n.children.map((function(e){return r.a.createElement(Be.a,{key:e.uri,onClick:function(){s(e.name,a.map((function(e){return e.track}))),i(null)}},e.name)})))};Fe=Object(o.b)((function(e){return{bookmarks:e.library.bookmarks,current_tlid:e.playback_state.tltrack?e.playback_state.tltrack.tlid:null}}))(Fe);var Ue=function(e,t,n){e.playlists.create({name:t,uri_scheme:"m3u"}).then((function(t){t.tracks=n,e.playlists.save({playlist:t}).then()}))},We=function(e){var t=e.menuState,n=e.setMenuState,a=e.anchorElRef,c=e.playlists,i=e.tracklist,o=r.a.useContext(f).mopidy;return"menu"===t?r.a.createElement((function(){return r.a.createElement(ce.a,{anchorEl:a.current,keepMounted:!0,open:"menu"===t,onClose:function(){return n(!1)}},r.a.createElement(Be.a,null,r.a.createElement(Pe,{icon:r.a.createElement(Ke.a,null),label:"New Playlist",action:function(e){var t;(t=e)&&0!==t.length&&(c.children.map((function(e){return e.name})).includes(t)?console.log("Playlist ",t,"already exists!"):Ue(o,t,i.map((function(e){return e.track})))),n(null)}})),r.a.createElement(Be.a,{onClick:function(e){return n("submenu")}},"Overwrite Playlist"))}),null):r.a.createElement((function(){return r.a.createElement(ce.a,{anchorEl:a.current,keepMounted:!0,open:"submenu"===t,onClose:function(){return n(!1)}},c.children&&c.children.map((function(e){return r.a.createElement(Be.a,{key:e.uri,onClick:function(){Ue(o,e.name,i.map((function(e){return e.track}))),n(null)}},e.name)})))}),null)},ze=n(42),He=n.n(ze),qe=n(55);function Ge(){var e=Object(he.a)(["\npadding: 0;\nbox-sizing: border-box;\nborder: 2px solid rgba(0,0,0,0);\nborder-radius: 5px;\n&:hover {\n    border: 2px solid ",";\n}\n"]);return Ge=function(){return e},e}var Je=function(e){try{return"".concat(e.track.album.name," / ").concat(e.track.track_no,". ").concat(e.track.name)}catch(t){return e.track.name||e.track.uri}},Ve=Object(qe.a)(Le.a)(Ge(),(function(e){return He()(e.color).alpha(.5).string()})),Xe=function(e){e.dispatch;var t=e.tracklist,n=e.current_tlid,a=r.a.useContext(f),c=a.mopidy,i=a.colors;return r.a.createElement(ye.a,{list:t,setList:function(){},tag:je.a,style:{overflow:"auto",maxHeight:"100%",padding:0},group:{name:"tracklist",pull:!0,put:["library"]},onEnd:function(e){return function(e,t){t.tracklist.move({start:e.oldIndex,end:e.oldIndex,to_position:e.newIndex})}(e,c)},id:"tracklist"},t.map((function(e){return r.a.createElement(Ve,{color:i.primary.current,key:e.tlid,className:e.tlid===n?"tracklist_current":""},e.tlid===n?r.a.createElement(be.a,{fontSize:"small"}):"",r.a.createElement(Ne.a,null,r.a.createElement(Ye,{text:Je(e),duration:u(e.track.length,"\u221e")})),r.a.createElement(Re.a,null,r.a.createElement(E.a,null,r.a.createElement(b.a,{onClick:function(){return c.playback.play({tlid:e.tlid})}},r.a.createElement(w.a,{fontSize:"small"})),r.a.createElement(b.a,{onClick:function(){return c.tracklist.remove({criteria:{tlid:[e.tlid]}})}},r.a.createElement(ke.a,{fontSize:"small"})))))})))},Qe=function(e){var t=e.tracklist,n=e.playlists,a=(e.bookmarks,e.dispatch),c=r.a.useContext(f).mopidy,i=r.a.useRef(null),o=r.a.useState(null),l=Object(s.a)(o,2),u=l[0],p=l[1],d=r.a.useState(t),m=Object(s.a)(d,2),g=m[0],_=m[1];return r.a.useEffect((function(){h(t.map((function(e){return e.track.uri})),g.map((function(e){return e.track.uri})))||(n.synced&&(Ue(c,n.synced.name,t.map((function(e){return e.track}))),c.playlists.getItems({uri:n.synced.uri}).then((function(e){return a({type:"LIBRARY_SET_CHILDREN",target:["playlist:",n.synced.uri],fun:function(){return e||[]}})}))),_(t))})),r.a.createElement(y.a,{style:{paddingLeft:"10px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},n.synced&&r.a.createElement(Ae.a,{icon:r.a.createElement(we.a,null),color:"primary",onDelete:function(){return a({type:"PLAYLIST_UNSYNC"})},style:{float:"left"},label:n.synced.name,variant:"outlined",size:"small"}),r.a.createElement("div",null,t.length," tracks"),r.a.createElement(E.a,null,r.a.createElement(oe.a,{title:"Clear playlist"},r.a.createElement(b.a,{onClick:function(){a({type:"TRACKLIST_UNSYNC"}),c.tracklist.clear()}},r.a.createElement(_e.a,{fontSize:"small"}))),r.a.createElement(oe.a,{title:"Save as..."},r.a.createElement(b.a,{onClick:function(e){return p("menu")},ref:i},r.a.createElement(Ce.a,null))),r.a.createElement(We,{menuState:u,setMenuState:p,anchorElRef:i,playlists:n,tracklist:t}),r.a.createElement(oe.a,{title:"Bookmark current TL and position"},r.a.createElement(b.a,{onClick:function(e){return p("bookmark")}},r.a.createElement(Ie.a,null))),r.a.createElement(Fe,{menuState:u,setMenuState:p,anchorElRef:i,tracklist:t})))};Qe=Object(o.b)((function(e){return{playlists:e.library.playlists}}))(Qe);var $e=function(e){var t=e.tracklist,n=e.current_tlid,a=e.dispatch;return r.a.createElement(y.a,{style:{display:"flex",flexDirection:"column",height:"100%",paddingLeft:"5px",marginLeft:"5px"}},r.a.createElement(Qe,{tracklist:t}),r.a.createElement(Xe,{tracklist:t,current_tlid:n,dispatch:a,style:{overflow:"auto",height:"100%",maxHeight:"100%"}}))},Ze=$e=Object(o.b)((function(e){return{tracklist:e.tracklist,current_tlid:e.playback_state.tltrack?e.playback_state.tltrack.tlid:null}}))($e),et=n(56),tt=n(117),nt=n.n(tt),at=n(116),rt=n.n(at),ct=function(e){return"track"===e.type||"Track"===e.__model__},it=function(e,t,n){if(!ct(e)&&(t({type:"LIBRARY_TOGGLE_EXPANDED",target:e.path}),!(e.children&&e.children.length>0)))switch(e.type){case"playlists_root":n.playlists.asList().then((function(n){return t({type:"LIBRARY_SET_CHILDREN",target:e.path,fun:function(){return n}})}));break;case"playlist":n.playlists.getItems({uri:e.uri}).then((function(n){return t({type:"LIBRARY_SET_CHILDREN",target:e.path,fun:function(){return n||[]}})}));break;case"search_results_root":case"search_result":break;default:n.library.browse({uri:e.uri}).then((function(n){return t({type:"LIBRARY_UPDATE_CHILDREN",target:e.path,fun:function(){return n},data:n})}))}},ot=function(){var e=Object(H.a)(z.a.mark((function e(t,n){var a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Promise.all(t.map(function(){var e=Object(H.a)(z.a.mark((function e(t){var a,r;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ct(t)){e.next=4;break}return e.abrupt("return",t.uri);case 4:e.t0=t.type,e.next="playlist"===e.t0?7:"search_result"===e.t0?15:16;break;case 7:if(t.children){e.next=14;break}return e.next=10,n.playlists.getItems({uri:t.uri});case 10:return a=e.sent,e.abrupt("return",a.map((function(e){return e.uri})));case 14:case 15:return e.abrupt("return",t.children.map((function(e){return e.uri})));case 16:return e.next=18,n.library.browse({uri:t.uri});case 18:return 0===(r=e.sent).length&&t.children&&(r=t.children),e.next=22,ot(r,n);case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return a=e.sent,e.abrupt("return",a.flat());case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),lt=function(){var e=Object(H.a)(z.a.mark((function e(t,n){var a,r;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ct(t)){e.next=2;break}return e.abrupt("return",[t.uri]);case 2:return e.next=4,ot([t],n);case 4:return a=e.sent,r=a.filter((function(e){return null!==e})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),st=function(){var e=Object(H.a)(z.a.mark((function e(t,n,a){var r,c;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lt(t,a);case 2:return r=e.sent,e.next=5,a.tracklist.add({uris:r,at_position:n});case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ut=n(31),pt=n(115),dt=n.n(pt),mt=n(72),ft=n.n(mt),ht=(n(84),n(73)),yt=n.n(ht),Et=function(e){var t=e.node,n=Object(ut.a)(e,["node"]),a=r.a.useContext(f),c=a.mopidy,i=a.dispatch;return r.a.createElement(oe.a,{title:"Play now !"},r.a.createElement(b.a,Object.assign({},n,{onClick:function(){i({type:"TRACKLIST_UNSYNC"}),c.tracklist.clear(),st(t,0,c).then((function(e){if(t.current_track_index){var n=e[t.current_track_index].tlid;console.log("CURRENT",e,t.current_track_index,n),c.playback.play({tlid:n})}else c.playback.play()}))}}),r.a.createElement(ft.a,null)))},bt=function(e){var t=e.node,n=Object(ut.a)(e,["node"]),a=r.a.useContext(f),c=a.mopidy;a.dispatch;return r.a.createElement(oe.a,{title:"Add to tracklist"},r.a.createElement(b.a,Object.assign({},n,{onClick:Object(H.a)(z.a.mark((function e(){var n;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lt(t,c);case 2:n=e.sent,console.log("Add",n),c.tracklist.add({uris:n});case 5:case"end":return e.stop()}}),e)})))}),r.a.createElement(dt.a,null)))},gt=function(e){var t=e.node,n=Object(ut.a)(e,["node"]),a=r.a.useContext(f),c=a.mopidy,i=a.dispatch;return r.a.createElement(oe.a,{title:"Play synced"},r.a.createElement(b.a,Object.assign({},n,{onClick:function(){c.tracklist.clear(),i({type:"TRACKLIST_SYNC",data:t.uri}),st(t,0,c).then((function(){return c.playback.play()}))}}),r.a.createElement(ft.a,null)))},_t=function(e){var t=e.node,n=Object(ut.a)(e,["node"]),a=r.a.useContext(f),c=(a.mopidy,a.dispatch);return r.a.createElement(oe.a,{title:"Delete tracklist "+t.name},r.a.createElement(b.a,Object.assign({onClick:function(){c({type:"TRACKLIST_DELETE",data:t.uri})}},n),r.a.createElement(yt.a,null)))},vt=function(e){var t=e.node,n=Object(ut.a)(e,["node"]),a=r.a.useContext(f),c=(a.mopidy,a.dispatch);return r.a.createElement(oe.a,{title:"Delete bookmark "+t.name},r.a.createElement(b.a,Object.assign({onClick:function(){c({type:"BOOKMARK_DELETE",target:t.uri})}},n),r.a.createElement(yt.a,null)))},kt=function(e){var t=e.node,n=Object(ut.a)(e,["node"]),a=r.a.useContext(f),c=a.mopidy,i=a.dispatch;return r.a.createElement(oe.a,{title:"Delete playlist "+t.name},r.a.createElement(b.a,Object.assign({onClick:function(){c.playlists.delete({uri:t.uri}),c.playlists.asList().then((function(e){return i({type:"LIBRARY_UPDATE_CHILDREN",target:["playlist:"],data:e})}))}},n),r.a.createElement(yt.a,null)))},Ot=function(e){var t=e.node;return r.a.createElement(Re.a,null,r.a.createElement(E.a,{size:"small"},r.a.createElement(Et,{node:t}),r.a.createElement(bt,{node:t})))},wt=function(e){var t=e.node;return r.a.createElement(Re.a,null,r.a.createElement(E.a,{size:"small"},r.a.createElement(gt,{node:t}),r.a.createElement(bt,{node:t}),r.a.createElement(_t,{node:t})))},St=function(e){var t=e.node;return r.a.createElement(Re.a,null,r.a.createElement(E.a,{size:"small"},r.a.createElement(Et,{node:t}),r.a.createElement(bt,{node:t}),r.a.createElement(vt,{node:t})))},Ct=function(e){var t=e.node;return r.a.createElement(Re.a,null,r.a.createElement(E.a,{size:"small"},r.a.createElement(Et,{node:t}),r.a.createElement(bt,{node:t}),r.a.createElement(kt,{node:t})))};function xt(){var e=Object(he.a)(["\ndisplay: flex;\nflex-direction: row;\njustify-content: space-between;\npadding-left: 3px;\nbox-sizing: border-box;\nborder: 2px solid rgba(0,0,0,0);\nborder-radius: 5px;\n&:hover {\n    border: 2px solid ",";\n}"]);return xt=function(){return e},e}function It(){var e=Object(he.a)(["\n   width: 6px;\n   flex-shrink: 0;\n   opacity: 0.5;\n\n   &:hover {\n      opacity: 1;\n   }\n"]);return It=function(){return e},e}var At=qe.a.div(It()),jt=qe.a.div(xt(),(function(e){return He()(e.color).alpha(.5).string()})),Lt=function(e){var t=e.callback,n=e.color;return r.a.createElement(At,{onClick:t},r.a.createElement("div",{style:{width:0,height:0,borderBottom:"6px solid "+n,borderLeft:"6px solid transparent"}}),r.a.createElement("div",{style:{backgroundColor:n,height:"calc(100% - 16px)"}}),r.a.createElement("div",{style:{width:0,height:0,borderTop:"6px solid "+n,borderLeft:"6px solid transparent"}}))},Rt=function e(t){var n=t.node,a=t.dispatch,c=t.depth,i=t.rootElem,o=t.colors,l=r.a.useContext(f).mopidy;if(!n)return null;return r.a.createElement("li",{style:{paddingTop:0,paddingBottom:0,display:"flex",flexDirection:"column",paddingLeft:"10px",marginLeft:0,marginRight:"auto",textAlign:"left"}},r.a.createElement(jt,{color:o.primary.current},r.a.createElement(Ne.a,{onClick:function(){return it(n,a,l)}},r.a.createElement(et.a,{style:i?{fontWeight:500}:{}},function(e){return ct(e)?e.length?r.a.createElement(Ye,{text:e.name,duration:u(e.length)}):e.name:"".concat(e.name," ").concat(function(e){return ct(e)?"":Array.isArray(e.children)?"(".concat(e.children.length,")"):"(?)"}(e))}(n),function(e){return ct(e)?"":e.expanded?r.a.createElement(rt.a,{style:{verticalAlign:"text-bottom"}}):r.a.createElement(nt.a,{style:{verticalAlign:"text-bottom"}})}(n))),function(e,t){return e.path&&1===e.path.length?null:"tracklist"===e.type?r.a.createElement(wt,{node:e}):"bookmark"===e.type?r.a.createElement(St,{node:e}):"playlist"===e.type&&e.uri.startsWith("m3u:")?r.a.createElement(Ct,{node:e}):r.a.createElement(Ot,{node:e})}(n)),r.a.createElement("div",null,n.expanded&&n.children&&r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(Lt,{callback:function(){return it(n,a,l)},color:o.primary.current}),r.a.createElement((function(){return r.a.createElement(ye.a,{group:{name:"library",put:!1,pull:"clone"},list:n.children,setList:function(){},tag:je.a,onEnd:function(e){!function(e,t,n,a){"tracklist"===n.id&&st(e,t,a)}(n.children[e.oldIndex],e.newIndex,e.to,l)},style:{width:"100%"}},n.children.map((function(t){return r.a.createElement(e,{key:t.uri,node:t,dispatch:a,depth:c+1,colors:o})})))}),null))))},Nt=Object(o.b)((function(e){return{library:e.library,colors:e.settings.persistant.colors}}))((function(e){var t=e.library,n=e.dispatch,a=e.colors,c=[].concat(Object(q.a)(t.mopidyLibrary),[t.playlists,t.search_results]);return t.search_history.children.length>0&&c.push(t.search_history),t.bookmarks.children.length>0&&c.push(t.bookmarks),console.log("Library:",t,n),r.a.createElement(y.a,{style:{minHeight:"100%"}},r.a.createElement(je.a,{style:{paddingLeft:"10px"}},c.map((function(e){return r.a.createElement(Rt,{node:e,dispatch:n,depth:0,key:e.uri,rootElem:!0,colors:a})}))))})),Tt=n(52),Dt=function(e){var t=e.setting,n=e.setSetting;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ie.a,{label:t.name,variant:"outlined",style:{margin:8},value:t.current,fullWidth:!0,onChange:function(e){n(Object(A.a)({},t,{current:e.target.value}))}}),r.a.createElement(Re.a,null,r.a.createElement(oe.a,{title:r.a.createElement(y.a,{style:{padding:"10px",fontSize:"small"}},r.a.createElement(et.a,null,t.help),r.a.createElement(et.a,null,"Default: ",r.a.createElement("em",null,t.default)))},r.a.createElement(ee.a,null))))},Pt=function e(t){var n=t.group,a=t.path,c=t.setInGroup;return r.a.createElement(y.a,{elevation:a.length},r.a.createElement(et.a,null,n.name),r.a.createElement(je.a,null,Object.entries(n).map((function(t){var n=Object(s.a)(t,2),i=n[0],o=n[1];return r.a.createElement(Le.a,{key:i},"group"===o.type?r.a.createElement(e,{group:o,path:[].concat(Object(q.a)(a),[i]),setInGroup:function(e,t){c(i,Object(A.a)({},o,Object(Tt.a)({},e,t)))}}):"param"===o.type?r.a.createElement(Dt,{setting:o,setSetting:function(e){return c(i,e)}}):null)}))))},Yt=Object(o.b)((function(e){return{persistant:e.settings.persistant}}))((function(e){var t=e.persistant,n=e.dispatch,c=Object(a.useState)(t),i=Object(s.a)(c,2),o=i[0],l=i[1];return r.a.createElement("div",null,r.a.createElement(Pt,{group:o,setInGroup:function(e,t){return l((function(){return Object(A.a)({},o,Object(Tt.a)({},e,t))}))},path:[]}),r.a.createElement(E.a,null,r.a.createElement(b.a,{onClick:function(){n({type:"COMMIT_SETTINGS",data:Object(A.a)({},o)}),n({type:"CONNECT",mopidy_ws:o.mopidy_ws.current,dispatch:n})}},"Commit"),r.a.createElement(b.a,{onClick:function(){n({type:"CLEAR_SETTINGS"}),n({type:"CONNECT",mopidy_ws:o.mopidy_ws.current,dispatch:n})}},"Restore defaults")))})),Bt=n(118),Mt=n.n(Bt),Kt=function(){return r.a.createElement(y.a,{style:{margin:"20px 20px auto 20px"}},r.a.createElement(et.a,{variant:"h4",style:{marginBottom:"10px"}},"Mowecl ",pe.a),r.a.createElement(et.a,null,"Made with \u2665 by Mathias Millet."),r.a.createElement("a",{href:"https://github.com/sapristi/mopidy-mowecl"},r.a.createElement(Mt.a,null)),r.a.createElement("br",null),r.a.createElement(et.a,{variant:"caption"},"Remarks, suggestions and bug reports are welcome."))},Ft=n(120),Ut=n(200),Wt=function(e){var t=e.colors,n=e.children,a=Object(Ft.a)({palette:{type:"light",background:{paper:t.background.current},primary:{main:t.primary.current},text:{primary:t.text.current,secondary:t.text.current}}});return r.a.createElement(Ut.a,{theme:a},r.a.createElement("div",{className:"App",style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",backgroundColor:t.background.current,scrollbarColor:"".concat(t.text.current," ").concat(t.background.current),scrollbarWidth:"thin",textAlign:"center"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",minHeight:"0",flex:1}},r.a.createElement(fe,null),n),r.a.createElement(U,{style:{display:"flex",flex:1}})))},zt=Object(o.b)((function(e){return{settings:e.settings,mopidy:e.mopidy}}))((function(e){var t=e.settings,n=e.mopidy,a=(e.dispatch,null);switch(t.active_panel){case"control":a=r.a.createElement(Yt,null);break;case"help":a=r.a.createElement(Kt,null);break;default:a=r.a.createElement(Nt,null)}return n.connected?r.a.createElement(Wt,{colors:t.persistant.colors},r.a.createElement("div",{style:{height:"100%",width:"100%",flexDirection:"row",display:"flex"}},r.a.createElement("div",{style:{width:"50%",height:"100%",overflow:"auto",scrollbarWidth:"thin"}},a),r.a.createElement("div",{style:{height:"100%",width:"50%",scrollbarWidth:"thin"}},r.a.createElement(Ze,null)))):r.a.createElement(Wt,{colors:t.persistant.colors},r.a.createElement("div",{style:{width:"50%",height:"100%",overflow:"auto",scrollbarWidth:"thin"}},r.a.createElement(Yt,null)),r.a.createElement(y.a,{style:{display:"flex",flexDirection:"column",width:"50%"}},r.a.createElement("div",{style:{flex:1}}),r.a.createElement("div",{style:{flex:1}},r.a.createElement(le.a,{color:"secondary",style:{margin:"auto"}})),r.a.createElement("div",{style:{flex:1}},r.a.createElement("div",null,"Trying to reach mopidy at ",t.persistant.mopidy_ws.current),r.a.createElement("div",null,n.error)),r.a.createElement("div",{style:{flex:1}})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ht=n(85),qt=n(74),Gt=n(119),Jt=n(76),Vt=n(48),Xt=n(75),Qt=n(156),$t=n(157);function Zt(e){return e.replace(/(_[a-z])/g,(function(e){return e.toUpperCase().replace("_","")}))}var en=function(e){function t(e){var n;return Object(qt.a)(this,t),(n=Object(Jt.a)(this,Object(Vt.a)(t).call(this)))._console=n._getConsole(e||{}),n._settings=n._configure(e||{}),n._backoffDelay=n._settings.backoffDelayMin,n._pendingRequests={},n._webSocket=null,n._delegateEvents(),n._settings.autoConnect&&n.connect(),n}return Object(Xt.a)(t,e),Object(Gt.a)(t,[{key:"_getConsole",value:function(e){if("undefined"!==typeof e.console)return e.console;var t="undefined"!==typeof console&&console||{};return t.log=t.log||function(){},t.warn=t.warn||function(){},t.error=t.error||function(){},t}},{key:"_configure",value:function(e){var t=Object(A.a)({},e),n="undefined"!==typeof document&&"https:"===document.location.protocol?"wss://":"ws://",a="undefined"!==typeof document&&document.location.host||"localhost";return t.webSocketUrl=e.webSocketUrl||"".concat(n).concat(a,"/mopidy/ws"),!1!==e.autoConnect&&(t.autoConnect=!0),t.backoffDelayMin=e.backoffDelayMin||1e3,t.backoffDelayMax=e.backoffDelayMax||64e3,t}},{key:"_delegateEvents",value:function(){this.removeAllListeners("websocket:close"),this.removeAllListeners("websocket:error"),this.removeAllListeners("websocket:incomingMessage"),this.removeAllListeners("websocket:open"),this.removeAllListeners("state:offline"),this.on("websocket:close",this._cleanup),this.on("websocket:error",this._handleWebSocketError),this.on("websocket:incomingMessage",this._handleMessage),this.on("websocket:open",this._resetBackoffDelay),this.on("websocket:open",this._getApiSpec),this.on("state:offline",this._reconnect)}},{key:"off",value:function(){if(0===arguments.length)this.removeAllListeners();else if(1===arguments.length){var e=arguments.length<=0?void 0:arguments[0];if("string"!==typeof e)throw Error("Expected no arguments, a string, or a string and a listener.");this.removeAllListeners(e)}else this.removeListener.apply(this,arguments)}},{key:"connect",value:function(){var e=this;if(this._webSocket){if(this._webSocket.readyState===t.WebSocket.OPEN)return;this._webSocket.close()}this._webSocket=this._settings.webSocket||new t.WebSocket(this._settings.webSocketUrl),this._webSocket.onclose=function(t){e.emit("websocket:close",t)},this._webSocket.onerror=function(t){e.emit("websocket:error",t)},this._webSocket.onopen=function(){e.emit("websocket:open")},this._webSocket.onmessage=function(t){e.emit("websocket:incomingMessage",t),e.emit("requests:count",Object.keys(e._pendingRequests).length)}}},{key:"_cleanup",value:function(e){var n=this;Object.keys(this._pendingRequests).forEach((function(a){var r=n._pendingRequests[a].reject;delete n._pendingRequests[a];var c=new t.ConnectionError("WebSocket closed");c.closeEvent=e,r(c)})),this.emit("state","state:offline"),this.emit("state:offline")}},{key:"_reconnect",value:function(){var e=this;this.emit("state","reconnectionPending",{timeToAttempt:this._backoffDelay}),this.emit("reconnectionPending",{timeToAttempt:this._backoffDelay}),setTimeout((function(){e.emit("state","reconnecting"),e.emit("reconnecting"),e.connect()}),this._backoffDelay),this._backoffDelay=2*this._backoffDelay,this._backoffDelay>this._settings.backoffDelayMax&&(this._backoffDelay=this._settings.backoffDelayMax)}},{key:"_resetBackoffDelay",value:function(){this._backoffDelay=this._settings.backoffDelayMin}},{key:"close",value:function(){this.off("state:offline",this._reconnect),this._webSocket&&this._webSocket.close()}},{key:"_handleWebSocketError",value:function(e){this._console.warn("WebSocket error:",e.stack||e)}},{key:"_send",value:function(e){var n=this;switch(this._webSocket.readyState){case t.WebSocket.CONNECTING:return Promise.reject(new t.ConnectionError("WebSocket is still connecting"));case t.WebSocket.CLOSING:return Promise.reject(new t.ConnectionError("WebSocket is closing"));case t.WebSocket.CLOSED:return Promise.reject(new t.ConnectionError("WebSocket is closed"));default:return new Promise((function(t,a){var r=Object(A.a)({},e,{jsonrpc:"2.0",id:n._nextRequestId()});n._pendingRequests[r.id]={resolve:t,reject:a},n._webSocket.send(JSON.stringify(r)),n.emit("websocket:outgoingMessage",r),n.emit("requests:count",Object.keys(n._pendingRequests).length)}))}}},{key:"_handleMessage",value:function(e){try{var t=JSON.parse(e.data);Object.hasOwnProperty.call(t,"id")?this._handleResponse(t):Object.hasOwnProperty.call(t,"event")?this._handleEvent(t):this._console.warn("Unknown message type received. Message was: ".concat(e.data))}catch(n){if(!(n instanceof SyntaxError))throw n;this._console.warn("WebSocket message parsing failed. Message was: ".concat(e.data))}}},{key:"_handleResponse",value:function(e){if(Object.hasOwnProperty.call(this._pendingRequests,e.id)){var n=this._pendingRequests[e.id],a=n.resolve,r=n.reject;if(delete this._pendingRequests[e.id],Object.hasOwnProperty.call(e,"result"))a(e.result);else if(Object.hasOwnProperty.call(e,"error")){var c=new t.ServerError(e.error.message);c.code=e.error.code,c.data=e.error.data,r(c),this._console.warn("Server returned error:",e.error)}else{var i=new Error("Response without 'result' or 'error' received");i.data={response:e},r(i),this._console.warn("Response without 'result' or 'error' received. Message was:",e)}}else this._console.warn("Unexpected response received. Message was:",e)}},{key:"_handleEvent",value:function(e){var t=Object(A.a)({},e);delete t.event;var n="event:".concat(Zt(e.event));this.emit("event",n,t),this.emit(n,t)}},{key:"_getApiSpec",value:function(){return this._send({method:"core.describe"}).then(this._createApi.bind(this)).catch(this._handleWebSocketError.bind(this))}},{key:"_createApi",value:function(e){var t=this;Object.keys(e).forEach((function(n){var a,r=function(e){var t=e.split(".");return t.length>=1&&"core"===t[0]&&(t=t.slice(1)),t}(n),c=Zt(r.slice(-1)[0]),i=function(e){var n=t;return e.forEach((function(e){var t=Zt(e);n[t]=n[t]||{},n=n[t]})),n}(r.slice(0,-1));i[c]=(a=n,function(){for(var e={method:a},n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return 0===r.length?t._send(e):r.length>1?Promise.reject(new Error("Expected zero arguments, a single array, or a single object.")):Array.isArray(r[0])||r[0]===Object(r[0])?(e.params=r[0],t._send(e)):Promise.reject(new TypeError("Expected an array or an object."))}),i[c].description=e[n].description,i[c].params=e[n].params})),this.emit("state","state:online"),this.emit("state:online")}}]),t}(Qt),tn=function(e){function t(e){var n;return Object(qt.a)(this,t),(n=Object(Jt.a)(this,Object(Vt.a)(t).call(this,e))).name="ConnectionError",n}return Object(Xt.a)(t,e),t}(Object(Ht.a)(Error));en.ConnectionError=tn;var nn=function(e){function t(e){var n;return Object(qt.a)(this,t),(n=Object(Jt.a)(this,Object(Vt.a)(t).call(this,e))).name="ServerError",n}return Object(Xt.a)(t,e),t}(Object(Ht.a)(Error));en.ServerError=nn,en.WebSocket=$t,en.prototype._nextRequestId=function(){var e=-1;return function(){return e+=1}}();var an=en,rn=function(){var e=Object(H.a)(z.a.mark((function e(t,n){var a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[{fun_path:["playback","getCurrentTlTrack"],base:{type:"PLAYBACK_INFO",target:"tltrack"}},{fun_path:["playback","getState"],base:{type:"PLAYBACK_INFO",target:"state"}},{fun_path:["playback","getTimePosition"],base:{type:"PLAYBACK_INFO",target:"time_position"}}],e.next=3,Promise.all(a.map(function(){var e=Object(H.a)(z.a.mark((function e(a){var r,c,i,o;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.fun_path,c=a.base,r.reduce((function(e,t){return e[t]}),n),i=r.reduce(p,n),e.next=5,i();case 5:o=e.sent,t(Object.assign({},c,{data:o}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),cn=function(e,t,n){t.on("requests:count",(function(e){n({type:"MOPIDY_PENDING_REQUESTS_COUNT",data:e})})),t.on("state:online",Object(H.a)(z.a.mark((function e(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"MOPIDY_CLIENT_CONNECTED"}),t.tracklist.getTlTracks().then(function(){var e=Object(H.a)(z.a.mark((function e(a){var r,c,i,o,l;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"TRACKLIST_INITIALISE",data:a}),e.next=3,t.playlists.asList();case 3:if(r=e.sent,n({type:"LIBRARY_SET_CHILDREN",target:["playlist:"],fun:function(){return r}}),c=JSON.parse(localStorage.getItem("bookmarks")),console.log("BOOKMARKS",c),c&&n({type:"LIBRARY_SET_CHILDREN",target:["bookmark:"],fun:function(){return c.children}}),i=JSON.parse(localStorage.getItem("synced"))){e.next=11;break}return e.abrupt("return");case 11:if(o=r.find((function(e){return e.uri===i.uri}))){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,t.playlists.getItems({uri:o.uri});case 16:l=e.sent,h(i.children,a.map((function(e){return e.track.uri})))&&h(i.children,l.map((function(e){return e.uri})))&&n({type:"PLAYLIST_SYNC",data:i});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.mixer.getVolume().then((function(e){return n({type:"PLAYBACK_INFO",target:"volume",data:e})})),t.library.browse({uri:null}).then((function(e){return n({type:"MOPIDY_LIBRARY_INITIALISE",data:e})})),t.getUriSchemes().then((function(e){return n({type:"URI_SCHEMES",data:e})})),rn(n,t);case 6:case"end":return e.stop()}}),e)})))),t.on("state:offline",(function(){return n({type:"MOPIDY_CLIENT_DISCONNECTED"})})),t.on("event:trackPlaybackResumed",(function(e){n({type:"PLAYBACK_INFO",target:"state",data:"playing"}),n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position})})),t.on("event:trackPlaybackPaused",(function(e){n({type:"PLAYBACK_INFO",target:"state",data:"paused"}),n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position}),n({type:"INCR_PLAYBACK_RESET"})})),t.on("event:seeked",(function(e){n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position})})),t.on("event:trackPlaybackStarted",(function(e){n({type:"PLAYBACK_INFO",target:"track",data:e.track})})),t.on("event:trackPlaybackEnded",(function(e){n({type:"CLEAR_PLAYBACK_INFO"}),n({type:"PLAYBACK_INFO",target:"state",data:"stopped"})})),t.on("event:trackPlaybackStarted",(function(e){n({type:"INCR_PLAYBACK_RESET"}),n({type:"PLAYBACK_INFO",target:"state",data:"playing"}),n({type:"PLAYBACK_INFO",target:"time_position",data:0}),n({type:"PLAYBACK_INFO",target:"tltrack",data:e.tl_track})})),t.on("event:tracklistChanged",(function(){t.tracklist.getTlTracks().then((function(e){return n({type:"TRACKLIST_INITIALISE",data:e})})),rn(n,t)})),t.on("event:volumeChanged",(function(e){n({type:"PLAYBACK_INFO",target:"volume",data:e.volume})}))},on=function(e,t,n){return function e(t,n,a,r){if(n[0]===t.uri){if(1===n.length){var c=t.children||[],i=r(c);return Array.isArray(i)&&(i=i.map((function(e){return Object(A.a)({},e,{path:[].concat(Object(q.a)(a),[e.uri])})}))),Object(A.a)({},t,{children:i})}return Object(A.a)({},t,{children:t.children.map((function(t){return e(t,n.slice(1),a,r)}))})}return t}(e,t,t,n)},ln=function e(t,n,a){return n[0]===t.uri?1===n.length?Object(A.a)({},t,{expanded:a(t.expanded)}):void 0===t.children?t:Object(A.a)({},t,{children:t.children.map((function(t){return e(t,n.slice(1),a)}))}):t},sn=function(e,t,n){return on(e,t,(function(e){return e?n.map((function(t){var n=e.find((function(e){return e.uri===t.uri}));return n?Object(A.a)({},t,{children:n.children}):t})):n}))},un=function(e,t){switch(t.type){case"LIBRARY_SET_CHILDREN":return on(e,t.target,t.fun);case"LIBRARY_UPDATE_CHILDREN":return sn(e,t.target,t.data);case"LIBRARY_TOGGLE_EXPANDED":return ln(e,t.target,(function(e){return!e}));case"LIBRARY_SET_EXPANDED":return ln(e,t.target,(function(){return t.data}));default:return e}},pn=Object(l.b)({mopidyLibrary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOPIDY_LIBRARY_INITIALISE":return t.data.map((function(e){return Object(A.a)({},e,{path:[e.uri]})}));case"LIBRARY_SET_CHILDREN":return e.map((function(e){return on(e,t.target,t.fun)}));case"LIBRARY_UPDATE_CHILDREN":return e.map((function(e){return sn(e,t.target,t.data)}));case"LIBRARY_TOGGLE_EXPANDED":return e.map((function(e){return ln(e,t.target,(function(e){return!e}))}));case"LIBRARY_SET_EXPANDED":return e.map((function(e){return ln(e,t.target,(function(){return t.data}))}));default:return e}},playlists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Playlists",uri:"playlist:",type:"playlists_root",path:["playlist:"],synced:null},t=arguments.length>1?arguments[1]:void 0;switch(e=un(e,t),t.type){case"PLAYLIST_UNSYNC":return e=Object(A.a)({},e,{synced:null}),localStorage.setItem("synced",JSON.stringify(null)),e;case"PLAYLIST_SYNC":return e=Object(A.a)({},e,{synced:t.data}),localStorage.setItem("synced",JSON.stringify(t.data)),e;case"PLAYLIST_SYNCED_UPDATE":if(!e.synced)return e;default:return e}},search_results:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Search results",uri:"search:",type:"search_results_root",path:["search:"],children:[]},t=arguments.length>1?arguments[1]:void 0;return un(e,t)},search_history:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Search history",uri:"search_history:",type:"search_history_root",path:["search_history:"],children:[]},t=arguments.length>1?arguments[1]:void 0;return un(e,t)},bookmarks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Bookmarks",uri:"bookmark:",type:"bookmarks_root",path:["bookmark:"],children:[]},t=arguments.length>1?arguments[1]:void 0;switch(e=un(e,t),t.type){case"BOOKMARK_SAVE":return localStorage.setItem("bookmarks",JSON.stringify(e)),e;case"BOOKMARK_DELETE":return e=Object(A.a)({},e,{children:e.children.filter((function(e){return e.uri!==t.target}))}),console.log("DEL",e.children,t.target),localStorage.setItem("bookmarks",JSON.stringify(e)),e;default:return e}}}),dn={tltrack:{track:null,tlid:null},state:null,time_position:null,updating:!1,time_position_updater:{pending:!1,last_update:null},volume:null},mn=JSON.parse(localStorage.getItem("settings"))||{},fn=function(e){try{return He()(e).hex()}catch(t){return!1}},hn={name:"Settings",type:"group",mopidy_ws:{type:"param",name:"Modidy WebSocker URL",default:function(){var e="https:"===window.location.protocol?"wss":"ws",t=window.location.hostname;return"".concat(e,"://").concat(t,":").concat(6680,"/mopidy/ws")}(),help:"Modidy WebSocker URL. Do not modify unless you know what you are doing.",validate:function(e){return e}},seek_update_interval:{type:"param",name:"Seek update interval",default:500,help:"Time interval (ms) at which the song progress bar will update.",validate:function(e){return parseInt(e)||500}},search_history_length:{type:"param",name:"Search history length",default:10,help:"Number of items in search history. Set 0 to disable.",validate:function(e){return parseInt(e)||10}},colors:{name:"Theme colors",type:"group",background:{type:"param",name:"Background",default:"#FFFFFF",help:"Background color, hex representation.",validate:function(e){return fn(e)?e:"#FFFFFF"}},text:{type:"param",name:"Text",default:"#000000",help:"Text color, hex representation.",validate:function(e){return fn(e)?e:"#000000"}},primary:{type:"param",name:"Primary",default:"#3F51B5",help:"Primary color, hex representation.",validate:function(e){return fn(e)?e:"#3F51B5"}}}},yn=function e(t,n){return Object.fromEntries(Object.entries(t).map((function(a){var r=Object(s.a)(a,2),c=r[0],i=r[1];if("group"===t[c].type)return[c,Object(A.a)({},i,{},e(i,n[c]||{}))];if("param"===t[c].type){var o=n[c]||i.default;return[c,Object(A.a)({},i,{current:o})]}return[c,i]})))},En=yn(hn,mn),bn=function e(t){return"group"===t.type?Object.fromEntries(Object.entries(t).map((function(t){var n=Object(s.a)(t,2),a=n[0],r=n[1];return[a,e(r)]}))):"param"===t.type?t.validate(t.current):null},gn=function e(t){return"group"===t.type?Object.fromEntries(Object.entries(t).map((function(t){var n=Object(s.a)(t,2),a=n[0],r=n[1];return[a,e(r)]}))):"param"===t.type?Object(A.a)({},t,{current:t.validate(t.current)}):t},_n={active_panel:"library",persistant:En},vn=function(e){var t=e.mopidy,n=e.settings,a=e.dispatch;return t.connected||t.connecting||t.error||a({type:"CONNECT",mopidy_ws:n.persistant.mopidy_ws.current,dispatch:a}),r.a.createElement(f.Provider,{value:{mopidy:t.mopidy,dispatch:a,colors:n.persistant.colors}},r.a.createElement(zt,null))};vn=Object(o.b)((function(e){return{mopidy:e.mopidy,settings:e.settings}}))(vn);var kn=Object(l.c)(Object(l.b)({playback_state:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLEAR_PLAYBACK_INFO":return Object(A.a)({},dn,{volume:e.volume});case"PLAYBACK_INFO":var n={};n[t.target]=t.data,"tltrack"!==t.target||t.data||(n[t.target]={track:null,tlid:null});var a=Object.assign({},e,n);return"time_position"===t.target&&(a.time_position_updater.last_update=(new Date).valueOf()),a;case"INCR_PLAYBACK_START":return Object(A.a)({},e,{time_position_updater:Object(A.a)({},e.time_position_updater,{pending:!0})});case"INCR_PLAYBACK":var r=(new Date).valueOf(),c=r-e.time_position_updater.last_update;return"playing"!==e.state?e:Object(A.a)({},e,{time_position:e.time_position+c,time_position_updater:{pending:!1,last_update:r}});case"INCR_PLAYBACK_RESET":return Object(A.a)({},e,{time_position_updater:{pending:!1,last_update:null}});case"PLAYBACK_UPDATING":return Object(A.a)({},e,{updating:t.data});default:return e}},tracklist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TRACKLIST_INITIALISE":return t.data;default:return e}},library:pn,settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_n,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ACTIVATE_PANEL":return Object(A.a)({},e,{active_panel:t.target});case"CLEAR_SETTINGS":return localStorage.removeItem("settings"),Object(A.a)({},e,{persistant:yn(hn,{})});case"COMMIT_SETTINGS":var n=gn(t.data);return localStorage.setItem("settings",JSON.stringify(bn(t.data))),Object(A.a)({},e,{persistant:n});case"SET_THEME":return Object(A.a)({},e,{theme:t.data});default:return e}},mopidy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{connected:!1,connecting:!1,mopidy:null,uri_schemes:[],pendingRequestsNb:0,error:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOPIDY_CLIENT_CONNECTED":return Object(A.a)({},e,{connected:!0,connecting:!1});case"MOPIDY_CLIENT_DISCONNECTED":return Object(A.a)({},e,{connected:!1,connecting:!0});case"MOPIDY_PENDING_REQUESTS_COUNT":return Object(A.a)({},e,{pendingRequestsNb:t.data});case"CONNECT":if(!t.dispatch||!t.mopidy_ws){var n="dispatch and mopidy_host must be passed at CONNECT";return console.log("ERROR: "+n),Object(A.a)({},e,{error:n,connecting:!0})}var a=t.mopidy_ws;console.log("webSocketUrl:",a),e.mopidy&&(e.mopidy.removeAllListeners(),e.mopidy.close(),e.mopidy.off());var r=new an({webSocketUrl:a,autoConnect:!1});try{r.connect()}catch(n){return console.log("Error when initializing mopidy",n),r.removeAllListeners(),r.close(),r.off(),cn(0,r,t.dispatch),Object(A.a)({},e,{error:n.toString(),mopidy:r,connecting:!1})}return r.on("event",console.log),window.$mopidy=r,cn(0,r,t.dispatch),Object(A.a)({},e,{connecting:!0,mopidy:r,connected:!1,error:null});case"URI_SCHEMES":return Object(A.a)({},e,{uri_schemes:t.data});default:return e}}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());window.$store=kn,i.a.render(r.a.createElement(o.a,{store:kn,style:{height:"100%"}},r.a.createElement(vn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},65:function(e){e.exports=JSON.parse('{"a":"0.3.2"}')}},[[135,1,2]]]);
//# sourceMappingURL=main.0b1ee6a9.chunk.js.map