(this.webpackJsonpmopidy_webui=this.webpackJsonpmopidy_webui||[]).push([[0],{134:function(e,t,n){e.exports=n(151)},143:function(e,t,n){},145:function(e,t,n){},151:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(11),c=n.n(i),o=n(18),l=n(34),s=(n(143),n(144),n(12)),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"??";if(void 0===e||null===e)return t;var n=Math.ceil(e/1e3),a=n%60,r=(n-a)/60,i=a<10?"0"+a:""+a;return"".concat(r,":").concat(i)},d=function(e,t){return e[t]},m={spotify:"Spotify",spotifytunigo:"Spotify browse",spotifyweb:"Spotify browse",local:"Local media",m3u:"Local playlists",podcast:"Podcasts","podcast+itunes":"iTunes Store: Podcasts",dirble:"Dirble",tunein:"TuneIn",soundcloud:"SoundCloud",gmusic:"Google Music",internetarchive:"Internet Archive",somafm:"Soma FM",youtube:"YouTube",audioaddict:"AudioAddict",subsonic:"Subsonic"},p=["file","http","https","mms","rtmp","rtmps","rtsp","yt"],f=r.a.createContext(null),h=function(e,t){return e.map((function(e,n){return[e,t[n]]})).every((function(e){var t=Object(s.a)(e,2);return t[0]===t[1]}))};n(145);var y=n(6),E=n(181),b=n(176),g=n(152),_=n(94),v=n.n(_),k=n(96),O=n.n(k),w=n(63),C=n.n(w),S=n(95),I=n.n(S),A=function(e){var t=e.state,n=r.a.useContext(f).mopidy;return r.a.createElement(b.a,null,r.a.createElement(g.a,{onClick:function(){return n.playback.previous()}},r.a.createElement(v.a,{fontSize:"large"})),"playing"===t?r.a.createElement(g.a,{onClick:function(){return n.playback.pause()}},r.a.createElement(I.a,{fontSize:"large"})):r.a.createElement(g.a,{onClick:function(){return n.playback.play()}},r.a.createElement(C.a,{fontSize:"large"})),r.a.createElement(g.a,{onClick:function(){return n.playback.next()}},r.a.createElement(O.a,{fontSize:"large"})))},x=n(200),L=n(180),j=function(e){var t=e.time_position,n=e.track_length,a=e.dispatch,i=r.a.useContext(f).mopidy,c=Math.ceil(t/n*300);return n?r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement("div",{style:{width:"40px"}},u(t)),r.a.createElement(x.a,{value:c,onChange:function(e,t){a({type:"PLAYBACK_INFO",target:"time_position",data:t*n/300})},onChangeCommitted:function(e,t){i.playback.seek({time_position:Math.ceil(t*n/300)})},max:300,valueLabelDisplay:"auto",valueLabelFormat:function(e){return u(e*n/300)},style:{flex:1,marginRight:"5%",marginLeft:"5%"}}),r.a.createElement("div",null,u(n))):r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement("div",null,u(t)),r.a.createElement(L.a,{style:{flex:1,marginRight:"5%",marginLeft:"5%"}}))},R=n(97),N=n.n(R),T=n(98),D=n.n(T),P=function(e){var t=e.volume,n=e.dispatch,a=e.style,i=r.a.useContext(f).mopidy;return r.a.createElement("div",{style:Object(y.a)({display:"flex",flexDirection:"row",alignItems:"center"},a)},r.a.createElement("div",{onClick:function(){return i.mixer.setVolume({volume:t-1})}},r.a.createElement(N.a,null)),r.a.createElement("div",{style:{flex:1,marginLeft:"5%",marginRight:"5%"}},r.a.createElement(x.a,{value:t,onChange:function(e,t){n({type:"PLAYBACK_INFO",target:"volume",data:t})},onChangeCommitted:function(e,t){i.mixer.setVolume({volume:t})},valueLabelDisplay:"auto"})),r.a.createElement("div",{onClick:function(){return i.mixer.setVolume({volume:t+1})}},r.a.createElement(D.a,null)))},Y=function(e){var t=e.track;if(!t)return"...";var n=t.name?r.a.createElement("div",null,t.name):null,a=t.album?r.a.createElement("div",null,t.album.name):null,i=t.artists?r.a.createElement("div",null,t.artists[0].name):null;return t.album,r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},n,a,i)},B=function(e){var t=e.tltrack,n=e.state,a=e.time_position,i=e.time_position_updater,c=(e.updating,e.volume),o=e.seek_update_interval,l=e.dispatch;return r.a.useEffect((function(){"playing"!==n||"number"!==typeof a||i.pending||(l({type:"INCR_PLAYBACK_START"}),setTimeout((function(){return l({type:"INCR_PLAYBACK"})}),parseInt(o)))})),r.a.createElement(E.a,{elevation:3,style:{width:"80%",margin:"auto",display:"flex",flexDirection:"row",padding:"5px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement(A,{state:n}),r.a.createElement(P,{volume:c,dispatch:l,style:{marginTop:"auto",marginBottom:"auto"}})),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1,paddingLeft:"5%",paddingRight:"5%"}},"stopped"!==n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,{track:t.track}),r.a.createElement(j,{time_position:a,track_length:t.track?t.track.length:null,dispatch:l})),r.a.createElement("div",null)))},M=B=Object(o.b)((function(e){return Object(y.a)({},e.playback_state,{seek_update_interval:e.settings.persistant.seek_update_interval.current})}))(B),K=n(15),U=n.n(K),F=n(21),H=n(30),z=n(103),W=n.n(z),q=n(102),G=n.n(q),J=n(100),V=n.n(J),X=n(68),Q=n.n(X),$=n(104),Z=n.n($),ee=n(101),te=n.n(ee),ne=n(195),ae=n(196),re=n(198),ie=n(187),ce=n(184),oe=n(194),le=n(64),se=function(e){var t=e.mopidy,n=e.searchUris,a=e.dispatch,i=e.closePopover,c=e.search_history_length,o=localStorage.getItem("searchSelectedURI")||"all",l=r.a.useState(o),u=Object(s.a)(l,2),d=u[0],m=u[1],p=r.a.useState((function(){return""})),f=Object(s.a)(p,2),h=f[0],E=f[1],b=function(e){if("Enter"===e&&0!==h.length){var n="all"===d?{}:{uris:[d+":"]};t.library.search(Object(y.a)({query:{any:[h]}},n)).then((function(e){var t=e.map((function(e){return Object(y.a)({},e,{name:e.uri,children:e.tracks,type:"search_result",expanded:!0})}));if(a({type:"LIBRARY_SET_CHILDREN",fun:function(){return t},target:["search:"]}),a({type:"LIBRARY_SET_EXPANDED",target:["search:"],data:!0}),!(c<=0)){var n=h+"/"+d;a({type:"LIBRARY_SET_CHILDREN",fun:function(e){return[{name:n,uri:n}].concat(Object(H.a)(e)).slice(0,c)},target:["search_history:"]}),a({type:"LIBRARY_SET_CHILDREN",fun:function(){return t},target:["search_history:",n]})}})),i()}};return r.a.createElement("div",null,r.a.createElement(ae.a,{id:"search-popover-textinput",variant:"outlined",value:h,onChange:function(e){return E(e.target.value)},onKeyPress:function(e){return b(e.key)},autoFocus:!0}),r.a.createElement(ce.a,{variant:"outlined"},r.a.createElement(oe.a,{native:!0,value:d,onChange:function(e){localStorage.setItem("searchSelectedURI",e.target.value),m(e.target.value)},onKeyPress:function(e){return b(e.key)}},r.a.createElement("option",{value:"all"},"All"),n.map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return r.a.createElement("option",{value:n,key:n},a)})))))},ue=function(e){var t=e.pendingRequestsNb,n={marginTop:"15px",marginBottom:"10px"};return e.connected?0===t?r.a.createElement("div",null,r.a.createElement(ie.a,{size:30,thickness:5,style:n,variant:"determinate",value:100})):r.a.createElement("div",null,r.a.createElement(ie.a,{size:30,thickness:5,style:n})):r.a.createElement("div",null,r.a.createElement(ie.a,{size:30,thickness:5,style:n,color:"secondary"}))},de=Object(o.b)((function(e){return Object(y.a)({},e.mopidy,{search_history_length:e.settings.persistant.search_history_length.current})}))((function(e){var t=e.dispatch,n=e.mopidy,a=e.uri_schemes,i=e.pendingRequestsNb,c=e.connected,o=e.search_history_length,l=r.a.useRef(null),u=r.a.useState(!1),d=Object(s.a)(u,2),f=d[0],h=d[1],y=r.a.useState((function(){return null})),_=Object(s.a)(y,2),v=_[0],k=_[1];v||fetch("https://pypi.org/pypi/Mopidy-Mowecl/json").then((function(e){return e.json().then((function(e){return k(e.info.version)}))}));var O=a.filter((function(e){return!p.includes(e)})).map((function(e){return[e,m[e]||e]})),w=function(e){return function(){return t({type:"ACTIVATE_PANEL",target:e})}},C=function(){var e=Object(F.a)(U.a.mark((function e(){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.library.refresh(),n.playlists.refresh()]);case 2:n.library.browse({uri:null}).then((function(e){return t({type:"MOPIDY_LIBRARY_INITIALISE",data:e})})),n.playlists.asList().then((function(e){return t({type:"LIBRARY_SET_CHILDREN",target:["playlist:"],fun:function(){return e}})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(E.a,{elevation:3,style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},r.a.createElement(b.a,{orientation:"vertical"},r.a.createElement(ue,{pendingRequestsNb:i,connected:c}),r.a.createElement(re.a,{title:"Quick search"},r.a.createElement(g.a,{ref:l,id:"popover-search-button",onClick:function(){return h(!0)}},r.a.createElement(V.a,null))),r.a.createElement((function(){return r.a.createElement(ne.a,{open:f,anchorEl:l.current,onClose:function(){return h(!1)},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"}},r.a.createElement(se,{searchUris:O,mopidy:n,dispatch:t,closePopover:function(){return h(!1)},search_history_length:o}))}),null),r.a.createElement(re.a,{title:"Refresh lib and playlists"},r.a.createElement(g.a,{onClick:C},r.a.createElement(te.a,null)))),r.a.createElement(b.a,{orientation:"vertical"},r.a.createElement(re.a,{title:"Library panel"},r.a.createElement(g.a,{onClick:w("library")},r.a.createElement(G.a,null))),r.a.createElement(re.a,{title:"Settings panel"},r.a.createElement(g.a,{style:{height:"auto"},onClick:w("control")},r.a.createElement(W.a,null)))),r.a.createElement(b.a,{orientation:"vertical"},le.a!=v&&r.a.createElement(re.a,{title:"Version ".concat(v," available on Pypi.")},r.a.createElement(g.a,null,r.a.createElement(Z.a,null))),r.a.createElement(g.a,{onClick:w("help")},r.a.createElement(Q.a,null))))})),me=n(51),pe=n(70),fe=n(109),he=n.n(fe),ye=n(111),Ee=n.n(ye),be=n(53),ge=n.n(be),_e=n(110),ve=n.n(_e),ke=n(112),Oe=n.n(ke),we=n(113),Ce=n.n(we),Se=n(199),Ie=n(186),Ae=n(153),xe=n(192),Le=n(191),je=n(188),Re=n(189),Ne=function(e){var t=e.label,n=e.action,a=e.icon,i=r.a.useState(""),c=Object(s.a)(i,2),o=c[0],l=c[1];return r.a.createElement(ae.a,{label:t,value:o,onChange:function(e){return l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(n(o),l(""))},autoFocus:!0,InputProps:{endAdornment:r.a.createElement(je.a,{position:"end"},r.a.createElement(Re.a,{onClick:function(){n(o),l("")}},a))}})},Te=function(e){var t=e.text,n=e.duration;return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},r.a.createElement("div",null,t),r.a.createElement("div",{style:{textAlign:"right",paddingRight:"4px"}},n))},De=n(190),Pe=n(69),Ye=n.n(Pe),Be=function(e){var t=e.dispatch,n=e.bookmarks,a=e.tracklist,i=e.menuState,c=e.setMenuState,o=e.anchorElRef,l=e.current_tlid,s=function(e){var n=a.findIndex((function(e){return e.tlid===l}));t({type:"LIBRARY_SET_CHILDREN",target:["bookmark:"],fun:function(t){return t.find((function(t){return t.name===e}))?t.map((function(t){return t.name===e?Object(y.a)({},t,{current_track_index:n}):t})):[].concat(Object(H.a)(t),[{name:e,uri:"bookmark:"+e,current_track_index:n,type:"bookmark"}])}}),t({type:"LIBRARY_SET_CHILDREN",target:["bookmark:","bookmark:"+e],fun:function(){return a.map((function(e){return e.track}))}}),t({type:"BOOKMARK_SAVE"})};return r.a.createElement(ne.a,{anchorEl:o.current,keepMounted:!0,open:"bookmark"===i,onClose:function(){return c(!1)},onKeyPress:function(){}},r.a.createElement(De.a,null,r.a.createElement(Ne,{label:"New Bookmark",icon:r.a.createElement(Ye.a,null),action:function(e){s(e),c(null)}})),n.children&&n.children.map((function(e){return r.a.createElement(De.a,{key:e.uri,onClick:function(){s(e.name,a.map((function(e){return e.track}))),c(null)}},e.name)})))};Be=Object(o.b)((function(e){return{bookmarks:e.library.bookmarks,current_tlid:e.playback_state.tltrack?e.playback_state.tltrack.tlid:null}}))(Be);var Me=function(e,t,n){e.playlists.create({name:t,uri_scheme:"m3u"}).then((function(t){t.tracks=n,e.playlists.save({playlist:t}).then()}))},Ke=function(e){var t=e.menuState,n=e.setMenuState,a=e.anchorElRef,i=e.playlists,c=e.tracklist,o=r.a.useContext(f).mopidy;return"menu"===t?r.a.createElement((function(){return r.a.createElement(ne.a,{anchorEl:a.current,keepMounted:!0,open:"menu"===t,onClose:function(){return n(!1)}},r.a.createElement(De.a,null,r.a.createElement(Ne,{icon:r.a.createElement(Ye.a,null),label:"New Playlist",action:function(e){var t;(t=e)&&0!==t.length&&(i.children.map((function(e){return e.name})).includes(t)?console.log("Playlist ",t,"already exists!"):Me(o,t,c.map((function(e){return e.track})))),n(null)}})),r.a.createElement(De.a,{onClick:function(e){return n("submenu")}},"Overwrite Playlist"))}),null):r.a.createElement((function(){return r.a.createElement(ne.a,{anchorEl:a.current,keepMounted:!0,open:"submenu"===t,onClose:function(){return n(!1)}},i.children&&i.children.map((function(e){return r.a.createElement(De.a,{key:e.uri,onClick:function(){Me(o,e.name,c.map((function(e){return e.track}))),n(null)}},e.name)})))}),null)},Ue=n(52);function Fe(){var e=Object(me.a)(["\npadding: 0;\n:hover {\n    background-color: rgba(63, 81, 181, 0.125);\n    border-radius: 5px;\n}\n"]);return Fe=function(){return e},e}var He=function(e){try{return"".concat(e.track.album.name," / ").concat(e.track.track_no,". ").concat(e.track.name)}catch(t){return e.track.name||e.track.uri}},ze=Object(Ue.a)(Ae.a)(Fe()),We=function(e){e.dispatch;var t=e.tracklist,n=e.current_tlid,a=r.a.useContext(f).mopidy;return r.a.createElement(pe.a,{list:t,setList:function(){},tag:Ie.a,style:{overflow:"auto",maxHeight:"100%",padding:0},group:{name:"tracklist",pull:!0,put:["library"]},onEnd:function(e){return function(e,t){t.tracklist.move({start:e.oldIndex,end:e.oldIndex,to_position:e.newIndex})}(e,a)},id:"tracklist"},t.map((function(e){return r.a.createElement(ze,{key:e.tlid,className:e.tlid===n?"tracklist_current":""},e.tlid===n?r.a.createElement(he.a,{fontSize:"small"}):"",r.a.createElement(Le.a,null,r.a.createElement(Te,{text:He(e),duration:u(e.track.length,"\u221e")})),r.a.createElement(xe.a,null,r.a.createElement(b.a,null,r.a.createElement(g.a,{onClick:function(){return a.playback.play({tlid:e.tlid})}},r.a.createElement(C.a,{fontSize:"small"})),r.a.createElement(g.a,{onClick:function(){return a.tracklist.remove({criteria:{tlid:[e.tlid]}})}},r.a.createElement(ge.a,{fontSize:"small"})))))})))},qe=function(e){var t=e.tracklist,n=e.playlists,a=(e.bookmarks,e.dispatch),i=r.a.useContext(f).mopidy,c=r.a.useRef(null),o=r.a.useState(null),l=Object(s.a)(o,2),u=l[0],d=l[1],m=r.a.useState(t),p=Object(s.a)(m,2),y=p[0],_=p[1];return r.a.useEffect((function(){h(t.map((function(e){return e.track.uri})),y.map((function(e){return e.track.uri})))||(n.synced&&(Me(i,n.synced.name,t.map((function(e){return e.track}))),i.playlists.getItems({uri:n.synced.uri}).then((function(e){return a({type:"LIBRARY_SET_CHILDREN",target:["playlist:",n.synced.uri],fun:function(){return e||[]}})}))),_(t))})),r.a.createElement(E.a,{style:{paddingLeft:"10px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},n.synced&&r.a.createElement(Se.a,{icon:r.a.createElement(ve.a,null),color:"primary",onDelete:function(){return a({type:"PLAYLIST_UNSYNC"})},style:{float:"left"},label:n.synced.name,variant:"outlined",size:"small"}),r.a.createElement("div",null,t.length," tracks"),r.a.createElement(b.a,null,r.a.createElement(re.a,{title:"Clear playlist"},r.a.createElement(g.a,{onClick:function(){a({type:"TRACKLIST_UNSYNC"}),i.tracklist.clear()}},r.a.createElement(Ee.a,{fontSize:"small"}))),r.a.createElement(re.a,{title:"Save as..."},r.a.createElement(g.a,{onClick:function(e){return d("menu")},ref:c},r.a.createElement(Oe.a,null))),r.a.createElement(Ke,{menuState:u,setMenuState:d,anchorElRef:c,playlists:n,tracklist:t}),r.a.createElement(re.a,{title:"Bookmark current TL and position"},r.a.createElement(g.a,{onClick:function(e){return d("bookmark")}},r.a.createElement(Ce.a,null))),r.a.createElement(Be,{menuState:u,setMenuState:d,anchorElRef:c,tracklist:t})))};qe=Object(o.b)((function(e){return{playlists:e.library.playlists}}))(qe);var Ge=function(e){var t=e.tracklist,n=e.current_tlid,a=e.dispatch,i=e.mopidy;return r.a.createElement(E.a,{style:{display:"flex",flexDirection:"column",height:"100%",paddingLeft:"5px",marginLeft:"5px"}},r.a.createElement(qe,{tracklist:t,mopidy:i}),r.a.createElement(We,{tracklist:t,current_tlid:n,dispatch:a,mopidy:i,style:{overflow:"auto",height:"100%",maxHeight:"100%"}}))},Je=Ge=Object(o.b)((function(e){return{tracklist:e.tracklist,current_tlid:e.playback_state.tltrack?e.playback_state.tltrack.tlid:null}}))(Ge),Ve=n(54),Xe=n(116),Qe=n.n(Xe),$e=n(115),Ze=n.n($e),et=function(e){return"track"===e.type||"Track"===e.__model__},tt=function(e,t,n){if(!et(e)&&(t({type:"LIBRARY_TOGGLE_EXPANDED",target:e.path}),!(e.children&&e.children.length>0)))switch(e.type){case"playlists_root":n.playlists.asList().then((function(n){return t({type:"LIBRARY_SET_CHILDREN",target:e.path,fun:function(){return n}})}));break;case"playlist":n.playlists.getItems({uri:e.uri}).then((function(n){return t({type:"LIBRARY_SET_CHILDREN",target:e.path,fun:function(){return n||[]}})}));break;case"search_results_root":case"search_result":break;default:n.library.browse({uri:e.uri}).then((function(n){return t({type:"LIBRARY_UPDATE_CHILDREN",target:e.path,fun:function(){return n},data:n})}))}},nt=function(){var e=Object(F.a)(U.a.mark((function e(t,n){var a;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Promise.all(t.map(function(){var e=Object(F.a)(U.a.mark((function e(t){var a,r;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!et(t)){e.next=4;break}return e.abrupt("return",t.uri);case 4:e.t0=t.type,e.next="playlist"===e.t0?7:"search_result"===e.t0?15:16;break;case 7:if(t.children){e.next=14;break}return e.next=10,n.playlists.getItems({uri:t.uri});case 10:return a=e.sent,e.abrupt("return",a.map((function(e){return e.uri})));case 14:case 15:return e.abrupt("return",t.children.map((function(e){return e.uri})));case 16:return e.next=18,n.library.browse({uri:t.uri});case 18:return 0===(r=e.sent).length&&t.children&&(r=t.children),e.next=22,nt(r,n);case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return a=e.sent,e.abrupt("return",a.flat());case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),at=function(){var e=Object(F.a)(U.a.mark((function e(t,n){var a,r;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!et(t)){e.next=2;break}return e.abrupt("return",[t.uri]);case 2:return e.next=4,nt([t],n);case 4:return a=e.sent,r=a.filter((function(e){return null!==e})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),rt=function(){var e=Object(F.a)(U.a.mark((function e(t,n,a){var r,i;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at(t,a);case 2:return r=e.sent,e.next=5,a.tracklist.add({uris:r,at_position:n});case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),it=n(33),ct=n(114),ot=n.n(ct),lt=n(71),st=n.n(lt),ut=(n(83),n(72)),dt=n.n(ut),mt=function(e){var t=e.node,n=Object(it.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy,c=a.dispatch;return r.a.createElement(re.a,{title:"Play now !"},r.a.createElement(g.a,Object.assign({},n,{onClick:function(){c({type:"TRACKLIST_UNSYNC"}),i.tracklist.clear(),rt(t,0,i).then((function(e){if(t.current_track_index){var n=e[t.current_track_index].tlid;console.log("CURRENT",e,t.current_track_index,n),i.playback.play({tlid:n})}else i.playback.play()}))}}),r.a.createElement(st.a,null)))},pt=function(e){var t=e.node,n=Object(it.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy;a.dispatch;return r.a.createElement(re.a,{title:"Add to tracklist"},r.a.createElement(g.a,Object.assign({},n,{onClick:Object(F.a)(U.a.mark((function e(){var n;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at(t,i);case 2:n=e.sent,console.log("Add",n),i.tracklist.add({uris:n});case 5:case"end":return e.stop()}}),e)})))}),r.a.createElement(ot.a,null)))},ft=function(e){var t=e.node,n=Object(it.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy,c=a.dispatch;return r.a.createElement(re.a,{title:"Play synced"},r.a.createElement(g.a,Object.assign({},n,{onClick:function(){i.tracklist.clear(),c({type:"TRACKLIST_SYNC",data:t.uri}),rt(t,0,i).then((function(){return i.playback.play()}))}}),r.a.createElement(st.a,null)))},ht=function(e){var t=e.node,n=Object(it.a)(e,["node"]),a=r.a.useContext(f),i=(a.mopidy,a.dispatch);return r.a.createElement(re.a,{title:"Delete tracklist "+t.name},r.a.createElement(g.a,Object.assign({onClick:function(){i({type:"TRACKLIST_DELETE",data:t.uri})}},n),r.a.createElement(dt.a,null)))},yt=function(e){var t=e.node,n=Object(it.a)(e,["node"]),a=r.a.useContext(f),i=(a.mopidy,a.dispatch);return r.a.createElement(re.a,{title:"Delete bookmark "+t.name},r.a.createElement(g.a,Object.assign({onClick:function(){i({type:"BOOKMARK_DELETE",target:t.uri})}},n),r.a.createElement(dt.a,null)))},Et=function(e){var t=e.node,n=Object(it.a)(e,["node"]),a=r.a.useContext(f),i=a.mopidy,c=a.dispatch;return r.a.createElement(re.a,{title:"Delete playlist "+t.name},r.a.createElement(g.a,Object.assign({onClick:function(){i.playlists.delete({uri:t.uri}),i.playlists.asList().then((function(e){return c({type:"LIBRARY_UPDATE_CHILDREN",target:["playlist:"],data:e})}))}},n),r.a.createElement(dt.a,null)))},bt=function(e){var t=e.node;return r.a.createElement(xe.a,null,r.a.createElement(b.a,{size:"small"},r.a.createElement(mt,{node:t}),r.a.createElement(pt,{node:t})))},gt=function(e){var t=e.node;return r.a.createElement(xe.a,null,r.a.createElement(b.a,{size:"small"},r.a.createElement(ft,{node:t}),r.a.createElement(pt,{node:t}),r.a.createElement(ht,{node:t})))},_t=function(e){var t=e.node;return r.a.createElement(xe.a,null,r.a.createElement(b.a,{size:"small"},r.a.createElement(mt,{node:t}),r.a.createElement(pt,{node:t}),r.a.createElement(yt,{node:t})))},vt=function(e){var t=e.node;return r.a.createElement(xe.a,null,r.a.createElement(b.a,{size:"small"},r.a.createElement(mt,{node:t}),r.a.createElement(pt,{node:t}),r.a.createElement(Et,{node:t})))};function kt(){var e=Object(me.a)(["\ndisplay: flex;\nflex-direction: row;\njustify-content: space-between;\npadding-left: 3px;\n :hover {\nbackground-color: rgba(63, 81, 181, 0.125);\nborder-radius: 5px;\n}\n"]);return kt=function(){return e},e}function Ot(){var e=Object(me.a)(["\n   width: 8px;\n   flex-shrink: 0;\n   opacity: 0.25;\n\n   &:hover {\n      opacity: 0.5;\n   }\n"]);return Ot=function(){return e},e}var wt=Ue.a.div(Ot()),Ct=Ue.a.div(kt()),St=function(e){var t=e.callback;return r.a.createElement(wt,{onClick:t},r.a.createElement("div",{style:{width:0,height:0,borderBottom:"8px solid rgba(63, 81, 181, 0.5)",borderLeft:"8px solid transparent"}}),r.a.createElement("div",{style:{backgroundColor:"rgba(63, 81, 181, 0.5)",height:"calc(100% - 16px)"}}),r.a.createElement("div",{style:{width:0,height:0,borderTop:"8px solid rgba(63, 81, 181, 0.5)",borderLeft:"8px solid transparent"}}))},It=function e(t){var n=t.node,a=t.dispatch,i=t.depth,c=t.rootElem,o=r.a.useContext(f).mopidy;if(!n)return null;return r.a.createElement("li",{style:{paddingTop:0,paddingBottom:0,display:"flex",flexDirection:"column",paddingLeft:"10px",marginLeft:0,marginRight:"auto",textAlign:"left"}},r.a.createElement(Ct,null,r.a.createElement(Le.a,{onClick:function(){return tt(n,a,o)}},r.a.createElement(Ve.a,{style:c?{fontWeight:500}:{}},function(e){return et(e)?e.length?r.a.createElement(Te,{text:e.name,duration:u(e.length)}):e.name:"".concat(e.name," ").concat(function(e){return et(e)?"":Array.isArray(e.children)?"(".concat(e.children.length,")"):"(?)"}(e))}(n),function(e){return et(e)?"":e.expanded?r.a.createElement(Ze.a,{style:{verticalAlign:"text-bottom"}}):r.a.createElement(Qe.a,{style:{verticalAlign:"text-bottom"}})}(n))),function(e,t){return e.path&&1===e.path.length?null:"tracklist"===e.type?r.a.createElement(gt,{node:e}):"bookmark"===e.type?r.a.createElement(_t,{node:e}):"playlist"===e.type&&e.uri.startsWith("m3u:")?r.a.createElement(vt,{node:e}):r.a.createElement(bt,{node:e})}(n)),r.a.createElement("div",null,n.expanded&&n.children&&r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(St,{callback:function(){return tt(n,a,o)}}),r.a.createElement((function(){return r.a.createElement(pe.a,{group:{name:"library",put:!1,pull:"clone"},list:n.children,setList:function(){},tag:Ie.a,onEnd:function(e){!function(e,t,n,a){"tracklist"===n.id&&rt(e,t,a)}(n.children[e.oldIndex],e.newIndex,e.to,o)},style:{width:"100%"}},n.children.map((function(t){return r.a.createElement(e,{key:t.uri,node:t,dispatch:a,depth:i+1})})))}),null))))},At=Object(o.b)((function(e){return{library:e.library}}))((function(e){var t=e.library,n=e.dispatch,a=[].concat(Object(H.a)(t.mopidyLibrary),[t.playlists,t.search_results]);return t.search_history.children.length>0&&a.push(t.search_history),t.bookmarks.children.length>0&&a.push(t.bookmarks),console.log("Library:",t,n),r.a.createElement(Ie.a,{style:{paddingLeft:"10px"}},a.map((function(e){return r.a.createElement(It,{node:e,dispatch:n,depth:0,key:e.uri,rootElem:!0})})))})),xt=n(57),Lt=Object(o.b)((function(e){return{persistant:e.settings.persistant}}))((function(e){var t=e.persistant,n=e.dispatch,i=Object(a.useState)(t),c=Object(s.a)(i,2),o=c[0],l=c[1];return r.a.createElement("div",null,r.a.createElement(Ie.a,null,Object.entries(o).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return r.a.createElement(Ae.a,{key:a.name},r.a.createElement(ae.a,{label:a.name,variant:"outlined",style:{margin:8},value:a.current,fullWidth:!0,onChange:function(e){var t=e.target.value;l((function(e){return Object(y.a)({},e,Object(xt.a)({},n,Object(y.a)({},e[n],{current:t})))}))}}),r.a.createElement(xe.a,null,r.a.createElement(re.a,{title:r.a.createElement(E.a,{style:{padding:"10px",fontSize:"small"}},r.a.createElement(Ve.a,null,a.help),r.a.createElement(Ve.a,null,"Default: ",r.a.createElement("em",null,a.default)))},r.a.createElement(Q.a,null))))}))),r.a.createElement(b.a,null,r.a.createElement(g.a,{onClick:function(){n({type:"COMMIT_SETTINGS",data:Object(y.a)({},o)}),n({type:"CONNECT",mopidy_ws:o.mopidy_ws.current,dispatch:n})}},"Commit"),r.a.createElement(g.a,{onClick:function(){n({type:"CLEAR_SETTINGS"}),n({type:"CONNECT",mopidy_ws:o.mopidy_ws.current,dispatch:n})}},"Restore defaults")))})),jt=n(117),Rt=n.n(jt),Nt=function(){return r.a.createElement(E.a,{style:{margin:"20px 20px auto 20px"}},r.a.createElement(Ve.a,{variant:"h4",style:{marginBottom:"10px"}},"Mowecl ",le.a),r.a.createElement(Ve.a,null,"Made with \u2665 by Mathias Millet."),r.a.createElement("a",{href:"https://github.com/sapristi/mopidy-mowecl"},r.a.createElement(Rt.a,null)),r.a.createElement("br",null),r.a.createElement(Ve.a,{variant:"caption"},"Remarks, suggestions and bug reports are welcome."))},Tt=n(119),Dt=n(193),Pt=function(e){var t=e.theme,n=e.children,a=Object(Tt.a)({palette:{type:t}});return r.a.createElement(Dt.a,{theme:a},r.a.createElement(E.a,{className:"App",style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",minHeight:"0",flex:1}},r.a.createElement(de,null),n),r.a.createElement(M,{style:{display:"flex",flex:1}})))},Yt=Object(o.b)((function(e){return{settings:e.settings,mopidy:e.mopidy}}))((function(e){var t=e.settings,n=e.mopidy,a=(e.dispatch,null);switch(t.active_panel){case"control":a=r.a.createElement(Lt,null);break;case"help":a=r.a.createElement(Nt,null);break;default:a=r.a.createElement(At,null)}return n.connected?r.a.createElement(Pt,{theme:t.persistant.theme.current},r.a.createElement("div",{style:{height:"100%",width:"100%",flexDirection:"row",display:"flex"}},r.a.createElement("div",{style:{width:"50%",height:"100%",overflow:"auto"}},a),r.a.createElement("div",{style:{height:"100%",width:"50%"}},r.a.createElement(Je,null)))):r.a.createElement(Pt,{theme:t.persistant.theme.current},r.a.createElement("div",{style:{width:"50%",height:"100%",overflow:"auto"}},r.a.createElement(Lt,null)),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{flex:1}}),r.a.createElement("div",{style:{flex:1}},r.a.createElement(ie.a,{color:"inherit",style:{margin:"auto"}})),r.a.createElement("div",{style:{flex:1}},r.a.createElement("div",null,"Trying to reach mopidy at ",t.persistant.mopidy_ws.current),r.a.createElement("div",null,n.error)),r.a.createElement("div",{style:{flex:1}})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Bt=n(84),Mt=n(73),Kt=n(118),Ut=n(75),Ft=n(48),Ht=n(74),zt=n(149),Wt=n(150);function qt(e){return e.replace(/(_[a-z])/g,(function(e){return e.toUpperCase().replace("_","")}))}var Gt=function(e){function t(e){var n;return Object(Mt.a)(this,t),(n=Object(Ut.a)(this,Object(Ft.a)(t).call(this)))._console=n._getConsole(e||{}),n._settings=n._configure(e||{}),n._backoffDelay=n._settings.backoffDelayMin,n._pendingRequests={},n._webSocket=null,n._delegateEvents(),n._settings.autoConnect&&n.connect(),n}return Object(Ht.a)(t,e),Object(Kt.a)(t,[{key:"_getConsole",value:function(e){if("undefined"!==typeof e.console)return e.console;var t="undefined"!==typeof console&&console||{};return t.log=t.log||function(){},t.warn=t.warn||function(){},t.error=t.error||function(){},t}},{key:"_configure",value:function(e){var t=Object(y.a)({},e),n="undefined"!==typeof document&&"https:"===document.location.protocol?"wss://":"ws://",a="undefined"!==typeof document&&document.location.host||"localhost";return t.webSocketUrl=e.webSocketUrl||"".concat(n).concat(a,"/mopidy/ws"),!1!==e.autoConnect&&(t.autoConnect=!0),t.backoffDelayMin=e.backoffDelayMin||1e3,t.backoffDelayMax=e.backoffDelayMax||64e3,t}},{key:"_delegateEvents",value:function(){this.removeAllListeners("websocket:close"),this.removeAllListeners("websocket:error"),this.removeAllListeners("websocket:incomingMessage"),this.removeAllListeners("websocket:open"),this.removeAllListeners("state:offline"),this.on("websocket:close",this._cleanup),this.on("websocket:error",this._handleWebSocketError),this.on("websocket:incomingMessage",this._handleMessage),this.on("websocket:open",this._resetBackoffDelay),this.on("websocket:open",this._getApiSpec),this.on("state:offline",this._reconnect)}},{key:"off",value:function(){if(0===arguments.length)this.removeAllListeners();else if(1===arguments.length){var e=arguments.length<=0?void 0:arguments[0];if("string"!==typeof e)throw Error("Expected no arguments, a string, or a string and a listener.");this.removeAllListeners(e)}else this.removeListener.apply(this,arguments)}},{key:"connect",value:function(){var e=this;if(this._webSocket){if(this._webSocket.readyState===t.WebSocket.OPEN)return;this._webSocket.close()}this._webSocket=this._settings.webSocket||new t.WebSocket(this._settings.webSocketUrl),this._webSocket.onclose=function(t){e.emit("websocket:close",t)},this._webSocket.onerror=function(t){e.emit("websocket:error",t)},this._webSocket.onopen=function(){e.emit("websocket:open")},this._webSocket.onmessage=function(t){e.emit("websocket:incomingMessage",t),e.emit("requests:count",Object.keys(e._pendingRequests).length)}}},{key:"_cleanup",value:function(e){var n=this;Object.keys(this._pendingRequests).forEach((function(a){var r=n._pendingRequests[a].reject;delete n._pendingRequests[a];var i=new t.ConnectionError("WebSocket closed");i.closeEvent=e,r(i)})),this.emit("state","state:offline"),this.emit("state:offline")}},{key:"_reconnect",value:function(){var e=this;this.emit("state","reconnectionPending",{timeToAttempt:this._backoffDelay}),this.emit("reconnectionPending",{timeToAttempt:this._backoffDelay}),setTimeout((function(){e.emit("state","reconnecting"),e.emit("reconnecting"),e.connect()}),this._backoffDelay),this._backoffDelay=2*this._backoffDelay,this._backoffDelay>this._settings.backoffDelayMax&&(this._backoffDelay=this._settings.backoffDelayMax)}},{key:"_resetBackoffDelay",value:function(){this._backoffDelay=this._settings.backoffDelayMin}},{key:"close",value:function(){this.off("state:offline",this._reconnect),this._webSocket&&this._webSocket.close()}},{key:"_handleWebSocketError",value:function(e){this._console.warn("WebSocket error:",e.stack||e)}},{key:"_send",value:function(e){var n=this;switch(this._webSocket.readyState){case t.WebSocket.CONNECTING:return Promise.reject(new t.ConnectionError("WebSocket is still connecting"));case t.WebSocket.CLOSING:return Promise.reject(new t.ConnectionError("WebSocket is closing"));case t.WebSocket.CLOSED:return Promise.reject(new t.ConnectionError("WebSocket is closed"));default:return new Promise((function(t,a){var r=Object(y.a)({},e,{jsonrpc:"2.0",id:n._nextRequestId()});n._pendingRequests[r.id]={resolve:t,reject:a},n._webSocket.send(JSON.stringify(r)),n.emit("websocket:outgoingMessage",r),n.emit("requests:count",Object.keys(n._pendingRequests).length)}))}}},{key:"_handleMessage",value:function(e){try{var t=JSON.parse(e.data);Object.hasOwnProperty.call(t,"id")?this._handleResponse(t):Object.hasOwnProperty.call(t,"event")?this._handleEvent(t):this._console.warn("Unknown message type received. Message was: ".concat(e.data))}catch(n){if(!(n instanceof SyntaxError))throw n;this._console.warn("WebSocket message parsing failed. Message was: ".concat(e.data))}}},{key:"_handleResponse",value:function(e){if(Object.hasOwnProperty.call(this._pendingRequests,e.id)){var n=this._pendingRequests[e.id],a=n.resolve,r=n.reject;if(delete this._pendingRequests[e.id],Object.hasOwnProperty.call(e,"result"))a(e.result);else if(Object.hasOwnProperty.call(e,"error")){var i=new t.ServerError(e.error.message);i.code=e.error.code,i.data=e.error.data,r(i),this._console.warn("Server returned error:",e.error)}else{var c=new Error("Response without 'result' or 'error' received");c.data={response:e},r(c),this._console.warn("Response without 'result' or 'error' received. Message was:",e)}}else this._console.warn("Unexpected response received. Message was:",e)}},{key:"_handleEvent",value:function(e){var t=Object(y.a)({},e);delete t.event;var n="event:".concat(qt(e.event));this.emit("event",n,t),this.emit(n,t)}},{key:"_getApiSpec",value:function(){return this._send({method:"core.describe"}).then(this._createApi.bind(this)).catch(this._handleWebSocketError.bind(this))}},{key:"_createApi",value:function(e){var t=this;Object.keys(e).forEach((function(n){var a,r=function(e){var t=e.split(".");return t.length>=1&&"core"===t[0]&&(t=t.slice(1)),t}(n),i=qt(r.slice(-1)[0]),c=function(e){var n=t;return e.forEach((function(e){var t=qt(e);n[t]=n[t]||{},n=n[t]})),n}(r.slice(0,-1));c[i]=(a=n,function(){for(var e={method:a},n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return 0===r.length?t._send(e):r.length>1?Promise.reject(new Error("Expected zero arguments, a single array, or a single object.")):Array.isArray(r[0])||r[0]===Object(r[0])?(e.params=r[0],t._send(e)):Promise.reject(new TypeError("Expected an array or an object."))}),c[i].description=e[n].description,c[i].params=e[n].params})),this.emit("state","state:online"),this.emit("state:online")}}]),t}(zt),Jt=function(e){function t(e){var n;return Object(Mt.a)(this,t),(n=Object(Ut.a)(this,Object(Ft.a)(t).call(this,e))).name="ConnectionError",n}return Object(Ht.a)(t,e),t}(Object(Bt.a)(Error));Gt.ConnectionError=Jt;var Vt=function(e){function t(e){var n;return Object(Mt.a)(this,t),(n=Object(Ut.a)(this,Object(Ft.a)(t).call(this,e))).name="ServerError",n}return Object(Ht.a)(t,e),t}(Object(Bt.a)(Error));Gt.ServerError=Vt,Gt.WebSocket=Wt,Gt.prototype._nextRequestId=function(){var e=-1;return function(){return e+=1}}();var Xt=Gt,Qt=function(){var e=Object(F.a)(U.a.mark((function e(t,n){var a;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[{fun_path:["playback","getCurrentTlTrack"],base:{type:"PLAYBACK_INFO",target:"tltrack"}},{fun_path:["playback","getState"],base:{type:"PLAYBACK_INFO",target:"state"}},{fun_path:["playback","getTimePosition"],base:{type:"PLAYBACK_INFO",target:"time_position"}}],e.next=3,Promise.all(a.map(function(){var e=Object(F.a)(U.a.mark((function e(a){var r,i,c,o;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.fun_path,i=a.base,r.reduce((function(e,t){return e[t]}),n),c=r.reduce(d,n),e.next=5,c();case 5:o=e.sent,t(Object.assign({},i,{data:o}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$t=function(e,t,n){t.on("requests:count",(function(e){n({type:"MOPIDY_PENDING_REQUESTS_COUNT",data:e})})),t.on("state:online",Object(F.a)(U.a.mark((function e(){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"MOPIDY_CLIENT_CONNECTED"}),t.tracklist.getTlTracks().then(function(){var e=Object(F.a)(U.a.mark((function e(a){var r,i,c,o,l;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"TRACKLIST_INITIALISE",data:a}),e.next=3,t.playlists.asList();case 3:if(r=e.sent,n({type:"LIBRARY_SET_CHILDREN",target:["playlist:"],fun:function(){return r}}),i=JSON.parse(localStorage.getItem("bookmarks")),console.log("BOOKMARKS",i),i&&n({type:"LIBRARY_SET_CHILDREN",target:["bookmark:"],fun:function(){return i.children}}),c=JSON.parse(localStorage.getItem("synced"))){e.next=11;break}return e.abrupt("return");case 11:if(o=r.find((function(e){return e.uri===c.uri}))){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,t.playlists.getItems({uri:o.uri});case 16:l=e.sent,h(c.children,a.map((function(e){return e.track.uri})))&&h(c.children,l.map((function(e){return e.uri})))&&n({type:"PLAYLIST_SYNC",data:c});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.mixer.getVolume().then((function(e){return n({type:"PLAYBACK_INFO",target:"volume",data:e})})),t.library.browse({uri:null}).then((function(e){return n({type:"MOPIDY_LIBRARY_INITIALISE",data:e})})),t.getUriSchemes().then((function(e){return n({type:"URI_SCHEMES",data:e})})),Qt(n,t);case 6:case"end":return e.stop()}}),e)})))),t.on("state:offline",(function(){return n({type:"MOPIDY_CLIENT_DISCONNECTED"})})),t.on("event:trackPlaybackResumed",(function(e){n({type:"PLAYBACK_INFO",target:"state",data:"playing"}),n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position})})),t.on("event:trackPlaybackPaused",(function(e){n({type:"PLAYBACK_INFO",target:"state",data:"paused"}),n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position}),n({type:"INCR_PLAYBACK_RESET"})})),t.on("event:seeked",(function(e){n({type:"PLAYBACK_INFO",target:"time_position",data:e.time_position})})),t.on("event:trackPlaybackStarted",(function(e){n({type:"PLAYBACK_INFO",target:"track",data:e.track})})),t.on("event:trackPlaybackEnded",(function(e){n({type:"CLEAR_PLAYBACK_INFO"}),n({type:"PLAYBACK_INFO",target:"state",data:"stopped"})})),t.on("event:trackPlaybackStarted",(function(e){n({type:"INCR_PLAYBACK_RESET"}),n({type:"PLAYBACK_INFO",target:"state",data:"playing"}),n({type:"PLAYBACK_INFO",target:"time_position",data:0}),n({type:"PLAYBACK_INFO",target:"tltrack",data:e.tl_track})})),t.on("event:tracklistChanged",(function(){t.tracklist.getTlTracks().then((function(e){return n({type:"TRACKLIST_INITIALISE",data:e})})),Qt(n,t)})),t.on("event:volumeChanged",(function(e){n({type:"PLAYBACK_INFO",target:"volume",data:e.volume})}))},Zt=function(e,t,n){return function e(t,n,a,r){if(n[0]===t.uri){if(1===n.length){var i=t.children||[],c=r(i);return Array.isArray(c)&&(c=c.map((function(e){return Object(y.a)({},e,{path:[].concat(Object(H.a)(a),[e.uri])})}))),Object(y.a)({},t,{children:c})}return Object(y.a)({},t,{children:t.children.map((function(t){return e(t,n.slice(1),a,r)}))})}return t}(e,t,t,n)},en=function e(t,n,a){return n[0]===t.uri?1===n.length?Object(y.a)({},t,{expanded:a(t.expanded)}):void 0===t.children?t:Object(y.a)({},t,{children:t.children.map((function(t){return e(t,n.slice(1),a)}))}):t},tn=function(e,t,n){return Zt(e,t,(function(e){return e?n.map((function(t){var n=e.find((function(e){return e.uri===t.uri}));return n?Object(y.a)({},t,{children:n.children}):t})):n}))},nn=function(e,t){switch(t.type){case"LIBRARY_SET_CHILDREN":return Zt(e,t.target,t.fun);case"LIBRARY_UPDATE_CHILDREN":return tn(e,t.target,t.data);case"LIBRARY_TOGGLE_EXPANDED":return en(e,t.target,(function(e){return!e}));case"LIBRARY_SET_EXPANDED":return en(e,t.target,(function(){return t.data}));default:return e}},an=Object(l.b)({mopidyLibrary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOPIDY_LIBRARY_INITIALISE":return t.data.map((function(e){return Object(y.a)({},e,{path:[e.uri]})}));case"LIBRARY_SET_CHILDREN":return e.map((function(e){return Zt(e,t.target,t.fun)}));case"LIBRARY_UPDATE_CHILDREN":return e.map((function(e){return tn(e,t.target,t.data)}));case"LIBRARY_TOGGLE_EXPANDED":return e.map((function(e){return en(e,t.target,(function(e){return!e}))}));case"LIBRARY_SET_EXPANDED":return e.map((function(e){return en(e,t.target,(function(){return t.data}))}));default:return e}},playlists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Playlists",uri:"playlist:",type:"playlists_root",path:["playlist:"],synced:null},t=arguments.length>1?arguments[1]:void 0;switch(e=nn(e,t),t.type){case"PLAYLIST_UNSYNC":return e=Object(y.a)({},e,{synced:null}),localStorage.setItem("synced",JSON.stringify(null)),e;case"PLAYLIST_SYNC":return e=Object(y.a)({},e,{synced:t.data}),localStorage.setItem("synced",JSON.stringify(t.data)),e;case"PLAYLIST_SYNCED_UPDATE":if(!e.synced)return e;default:return e}},search_results:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Search results",uri:"search:",type:"search_results_root",path:["search:"],children:[]},t=arguments.length>1?arguments[1]:void 0;return nn(e,t)},search_history:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Search history",uri:"search_history:",type:"search_history_root",path:["search_history:"],children:[]},t=arguments.length>1?arguments[1]:void 0;return nn(e,t)},bookmarks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"Bookmarks",uri:"bookmark:",type:"bookmarks_root",path:["bookmark:"],children:[]},t=arguments.length>1?arguments[1]:void 0;switch(e=nn(e,t),t.type){case"BOOKMARK_SAVE":return localStorage.setItem("bookmarks",JSON.stringify(e)),e;case"BOOKMARK_DELETE":return e=Object(y.a)({},e,{children:e.children.filter((function(e){return e.uri!==t.target}))}),console.log("DEL",e.children,t.target),localStorage.setItem("bookmarks",JSON.stringify(e)),e;default:return e}}}),rn={tltrack:{track:null,tlid:null},state:null,time_position:null,updating:!1,time_position_updater:{pending:!1,last_update:null},volume:null},cn=JSON.parse(localStorage.getItem("settings"))||{},on={mopidy_ws:{name:"Modidy WebSocker URL",default:function(){var e="https:"===window.location.protocol?"wss":"ws",t=window.location.hostname;return"".concat(e,"://").concat(t,":").concat(6680,"/mopidy/ws")}(),help:"Modidy WebSocker URL. Do not modify unless you know what you are doing.",validate:function(e){return e}},seek_update_interval:{name:"Seek update interval",default:500,help:"Time interval (ms) at which the song progress bar will update.",validate:function(e){return parseInt(e)||500}},search_history_length:{name:"Search history length",default:10,help:"Number of items in search history. Set 0 to disable.",validate:function(e){return parseInt(e)||10}},theme:{name:"Theme",default:"light",help:"light or dark",validate:function(e){var t=e.toLowerCase();return["light","dark"].includes(t)?t:"light"}}},ln={active_panel:"library",persistant:Object.fromEntries(Object.entries(on).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1],r=cn[n]||a.default;return[n,Object(y.a)({},a,{current:r})]})))},sn=function(e){var t=e.mopidy,n=e.settings,a=e.dispatch;return t.connected||t.connecting||t.error||a({type:"CONNECT",mopidy_ws:n.persistant.mopidy_ws.current,dispatch:a}),r.a.createElement(f.Provider,{value:{mopidy:t.mopidy,dispatch:a}},r.a.createElement(Yt,null))};sn=Object(o.b)((function(e){return{mopidy:e.mopidy,settings:e.settings}}))(sn);var un=Object(l.c)(Object(l.b)({playback_state:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLEAR_PLAYBACK_INFO":return Object(y.a)({},rn,{volume:e.volume});case"PLAYBACK_INFO":var n={};n[t.target]=t.data,"tltrack"!==t.target||t.data||(n[t.target]={track:null,tlid:null});var a=Object.assign({},e,n);return"time_position"===t.target&&(a.time_position_updater.last_update=(new Date).valueOf()),a;case"INCR_PLAYBACK_START":var r=Object.assign({},e.time_position_updater,{pending:!0});return Object.assign({},e,{time_position_updater:r});case"INCR_PLAYBACK":var i=(new Date).valueOf(),c=i-e.time_position_updater.last_update;return"playing"!==e.state?e:Object(y.a)({},e,{time_position:e.time_position+c,time_position_updater:{pending:!1,last_update:i}});case"INCR_PLAYBACK_RESET":return Object(y.a)({},e,{time_position_updater:{pending:!1,last_update:null}});case"PLAYBACK_UPDATING":return Object(y.a)({},e,{updating:t.data});default:return e}},tracklist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TRACKLIST_INITIALISE":return t.data;default:return e}},library:an,settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ACTIVATE_PANEL":return Object(y.a)({},e,{active_panel:t.target});case"CLEAR_SETTINGS":return localStorage.removeItem("settings"),Object(y.a)({},e,{persistant:Object.fromEntries(Object.entries(on).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1],r=a.default;return[n,Object(y.a)({},a,{current:r})]})))});case"COMMIT_SETTINGS":return localStorage.setItem("settings",JSON.stringify(Object.fromEntries(Object.entries(t.data).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return[n,a.validate(a.current)]}))))),Object(y.a)({},e,{persistant:Object.fromEntries(Object.entries(t.data).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return[n,Object(y.a)({},a,{current:a.validate(a.current)})]})))});case"SET_THEME":return Object(y.a)({},e,{theme:t.data});default:return e}},mopidy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{connected:!1,connecting:!1,mopidy:null,uri_schemes:[],pendingRequestsNb:0,error:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOPIDY_CLIENT_CONNECTED":return Object(y.a)({},e,{connected:!0,connecting:!1});case"MOPIDY_CLIENT_DISCONNECTED":return Object(y.a)({},e,{connected:!1,connecting:!0});case"MOPIDY_PENDING_REQUESTS_COUNT":return Object(y.a)({},e,{pendingRequestsNb:t.data});case"CONNECT":if(!t.dispatch||!t.mopidy_ws){var n="dispatch and mopidy_host must be passed at CONNECT";return console.log("ERROR: "+n),Object(y.a)({},e,{error:n,connecting:!0})}var a=t.mopidy_ws;console.log("webSocketUrl:",a),e.mopidy&&(e.mopidy.removeAllListeners(),e.mopidy.close(),e.mopidy.off());var r=new Xt({webSocketUrl:a,autoConnect:!1});try{r.connect()}catch(n){return console.log("Error when initializing mopidy",n),r.removeAllListeners(),r.close(),r.off(),$t(0,r,t.dispatch),Object(y.a)({},e,{error:n.toString(),mopidy:r,connecting:!1})}return r.on("event",console.log),window.$mopidy=r,$t(0,r,t.dispatch),Object(y.a)({},e,{connecting:!0,mopidy:r,connected:!1,error:null});case"URI_SCHEMES":return Object(y.a)({},e,{uri_schemes:t.data});default:return e}}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());window.$store=un,c.a.render(r.a.createElement(o.a,{store:un,style:{height:"100%"}},r.a.createElement(sn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},64:function(e){e.exports=JSON.parse('{"a":"0.3.2"}')}},[[134,1,2]]]);
//# sourceMappingURL=main.339e4748.chunk.js.map